/*!CK:700038750!*//*1410890076,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["aI1XN"]); }

__d("BlackbirdUpsellConstants",[],function(a,b,c,d,e,f){e.exports={ACTION_EDUCATE:"educate",ACTION_UPSELL:"upsell",CLICK_TYPE_DISMISS_PROMO:"dismiss_promo",CLICK_TYPE_ENABLE_CHAT:"enable_chat",CLICK_TYPE_OPEN_SETTINGS:"open_settings"};},null);
__d("ChatSidebarSections",[],function(a,b,c,d,e,f){e.exports={MORE_ONLINE_FRIENDS:"more_online_friends",MORE_ONLINE_COWORKERS:"more_online_coworkers",OFFLINE_USERS:"offline_users",ORDERED_LIST:"ordered_list",ORDERED_COWORKERS:"ordered_coworkers",TYPEAHEAD:"typeahead"};},null);
__d("ComposedBlockType",[],function(a,b,c,d,e,f){e.exports={UNSTYLED:0,PARAGRAPH:1,UNORDERED_LIST_ITEM:2,ORDERED_LIST_ITEM:3,BLOCKQUOTE:4,HEADER_ONE:5,HEADER_TWO:6,CODE:7,MEDIA:8};},null);
__d("ComposedEntityMutability",[],function(a,b,c,d,e,f){e.exports={MUTABLE:0,IMMUTABLE:1,SEGMENTED:2};},null);
__d("ComposedEntityType",[],function(a,b,c,d,e,f){e.exports={MENTION:0,LINK:1,IMAGE:2,VIDEO:3};},null);
__d("ComposedInlineStyle",[],function(a,b,c,d,e,f){e.exports={NONE:0,BOLD:1,ITALIC:2,UNDERLINE:4,CODE:8};},null);
__d("GenderConst",[],function(a,b,c,d,e,f){e.exports={NOT_A_PERSON:0,FEMALE_SINGULAR:1,MALE_SINGULAR:2,FEMALE_SINGULAR_GUESS:3,MALE_SINGULAR_GUESS:4,MIXED_SINGULAR:5,MIXED_PLURAL:5,NEUTER_SINGULAR:6,UNKNOWN_SINGULAR:7,FEMALE_PLURAL:8,MALE_PLURAL:9,NEUTER_PLURAL:10,UNKNOWN_PLURAL:11,UNKNOWN:0};},null);
__d("AsyncLoader",["copyProperties","AsyncRequest","BaseAsyncLoader"],function(a,b,c,d,e,f,g,h,i){function j(k,l){this._endpoint=k;this._type=l;}g(j.prototype,i.prototype);j.prototype.send=function(k,l,m,n,o){new h(k).setData({ids:l}).setHandler(n).setErrorHandler(o).setAllowCrossPageTransition(true).setMethod('GET').setReadOnly(true).send();};e.exports=j;},null);
__d("BlackbirdUpsell",["Event","Arbiter","AsyncRequest","LegacyContextualDialog","DOM","LayerDestroyOnHide","LayerHideOnTransition","PresencePrivacy","copyProperties","BlackbirdUpsellConfig","BlackbirdUpsellConstants","BlackbirdUpsellTemplates"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){var s='/ajax/chat/blackbird/update_clicks.php',t='/ajax/chat/blackbird/update_impressions.php',u='/ajax/chat/blackbird/dismiss.php',v=235,w=null,x=null,y=false,z=false;function aa(){}o(aa,{shouldShow:function(){if(this._dialogDismissed)return false;if(this.isEducation()){return !p.EducationDismissed&&p.EducationImpressions<p.EducationImpressionLimit;}else return !!p.UpsellGK&&!p.UpsellDismissed&&p.UpsellImpressions<p.UpsellImpressionLimit&&p.FriendCount>=p.UpsellMinFriendCount;},isEducation:function(){return p.TimeOffline<=p.EducationTimeOfflineThresdhold;},getOfflineContent:function(){if(this.isEducation()){return this._getEducationContent();}else return this._getUpsellContent();},_getEducationContent:function(){ga();var ka=r[':fb:chat:blackbird:offline-educate'].build(),la=ka.getNode('chatSettingsButton');g.listen(la,'click',function(){h.inform('chat/advanced-settings-dialog-opened');ja(q.CLICK_TYPE_OPEN_SETTINGS);da();});return ka.getRoot();},_getUpsellContent:function(){fa();var ka=r[':fb:chat:blackbird:upsell'].build(),la=ka.getNode('chatSettingsButton');g.listen(la,'click',function(){h.inform('chat/advanced-settings-dialog-opened');ia(q.CLICK_TYPE_OPEN_SETTINGS);ca();});var ma=ka.getNode('enableChatButton');g.listen(ma,'click',function(){ia(q.CLICK_TYPE_ENABLE_CHAT);ca();});return ka.getRoot();},getBlackbirdContent:function(ka){ga();switch(ka){case n.ONLINE:return r[':fb:chat:blackbird:most-friends-educate'].build().getRoot();case n.OFFLINE:return r[':fb:chat:blackbird:some-friends-educate'].build().getRoot();}},showOfflineDialog:function(ka){this.showDialog(ka,this.getOfflineContent.bind(this));},showBlackbirdDialog:function(ka,la){this.showDialog(ka,this.getBlackbirdContent.bind(null,la));},showDialog:function(ka,la){!w&&this._constructDialog();k.setContent(x,la());w.setContext(ka);w.show();},hide:function(){if(w&&w.isShown())w.hide();},dismiss:function(){this.hide();if(this.isEducation()){da();}else ca();},registerDismissClick:function(){if(this.isEducation()){ja(q.CLICK_TYPE_DISMISS_PROMO);}else ia(q.CLICK_TYPE_DISMISS_PROMO);},isVisible:function(){return z&&!y;},_constructDialog:function(){var ka=r[':fb:chat:blackbird:dialog-frame'].build();x=ka.getNode('dialogContent');w=new j();w.init(ka.getRoot());w.setPosition('above').setWidth(v).setFixed(true).disableBehavior(l).disableBehavior(m);g.listen(ka.getNode('dialogCloseButton'),'click',this.dismiss.bind(this));g.listen(ka.getNode('dialogCloseButton'),'click',this.registerDismissClick.bind(this));}});function ba(ka,la){if(!y&&z){y=true;n.inform('privacy-user-presence-changed');var ma=new i(u);ma.setData({source:ka,impressions:la,time_offline:p.TimeOffline});ma.setErrorHandler(function(){y=false;});ma.send();}}function ca(){ba(q.ACTION_UPSELL,p.UpsellImpressions);}function da(){ba(q.ACTION_EDUCATE,p.EducationImpressions);}function ea(ka,la){if(!z){z=true;var ma=new i(t);ma.setData({action:ka,impressions:la,time_offline:p.TimeOffline});ma.setErrorHandler(function(){z=false;});ma.send();}}function fa(){ea(q.ACTION_UPSELL,p.UpsellImpressions);}function ga(){ea(q.ACTION_EDUCATE,p.EducationImpressions);}function ha(ka,la,ma,na){var oa=new i(s);oa.setData({action:ka,impressions:ma,source:la,time_offline:na});oa.send();}function ia(ka){ha(ka,q.ACTION_UPSELL,p.UpsellImpressions,p.TimeOffline);}function ja(ka){ha(ka,q.ACTION_EDUCATE,p.EducateImpressions,p.TimeOffline);}h.subscribe('chat/advanced-settings-dialog-opened',aa.dismiss.bind(aa));h.subscribe('chat-visibility/go-online',aa.dismiss.bind(aa));h.subscribe('chat-visibility/go-offline',aa.dismiss.bind(aa));e.exports=aa;},null);
__d("Chat",["Arbiter"],function(a,b,c,d,e,f,g){var h={buddyListNub:'buddylist-nub/initialized',sidebar:'sidebar/initialized'};function i(k,l){g.subscribe(h[k],function(event,m){l(m);});}var j={openBuddyList:function(){i('buddyListNub',function(k){k.show();i('sidebar',function(l){l.enable();});});},closeBuddyList:function(){i('buddyListNub',function(k){k.hide();});},toggleSidebar:function(){i('sidebar',function(k){k.toggle();});}};a.Chat=e.exports=j;},3);
__d("ChatHovercard",["Arbiter","AsyncLoader","Hovercard","JSLogger","debounce"],function(a,b,c,d,e,f,g,h,i,j,k){var l=5,m=new h('/ajax/chat/hovercard/sidebar.php','hover'),n=j.create('chat_hovercard');g.subscribe('Hovercard/dirty',m.reset.bind(m));function o(s,t){m.get(s,function(u){setTimeout(function(){if(!u){n.error('fetch_failure',{id:s});return;}var v=i.getDialog(u);if(!v){n.error('no_hovercard',{id:s,endpoint:u});return;}if(s==t.getActiveID())t.showHovercard(s,v);},0);});}function p(s,t){var u=[];function v(y){if(y>=0&&y<s.length)u.push(s[y]);}var w=s.indexOf(t);if(w>-1){v(w);for(var x=1;x<l;x++){v(w+x);v(w-x);}}return u.filter(function(y){return y;});}function q(s,t){var u=t.getActiveID();if(u){var v=s.getShowingUsers(),w=p(v,u);m.get(w,function(){});}}function r(s){var t=s.getHoverController();t.registerDefault(o);t.subscribe('hover',k(q.bind(null,s,t),100));}e.exports=r;},null);
__d("ChatOrderedListHover",["ArbiterMixin","CSS","ErrorUtils","Event","LayerHideOnBlur","Parent","copyProperties","cx","mixin","setTimeoutAcrossTransitions","shield"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){function r(x){h.addClass(x,'fetching');}function s(x){h.removeClass(x,'fetching');}var t=o(g);for(var u in t)if(t.hasOwnProperty(u))w[u]=t[u];var v=t===null?null:t.prototype;w.prototype=Object.create(v);w.prototype.constructor=w;w.__superConstructor__=t;function w(x){"use strict";this._orderedList=x;this._root=x.getRoot();j.listen(this._root,'mouseover',this._mouseOver.bind(this));j.listen(this._root,'mouseleave',this._mouseLeave.bind(this));x.subscribe('click',q(this._hide,this));}w.prototype._mouseOver=function(event){"use strict";if(this._paused)return;var x=event.getTarget(),y=l.byClass(x,"_42fz")||l.byClass(x,"_5a58");y&&this._setActiveItem(y);};w.prototype._mouseLeave=function(event){"use strict";this._setActiveItem(null);};w.prototype._clearTimeouts=function(){"use strict";this._showTimeout&&clearTimeout(this._showTimeout);this._showTimeout=null;this._hideTimeout&&clearTimeout(this._hideTimeout);this._hideTimeout=null;};w.prototype._hide=function(){"use strict";if(this._showingDialog){this._showingDialog.hide();this._showingDialog=null;this._showingID=null;}};w.prototype._show=function(){"use strict";var x=this.getActiveID(),y=false;if(this._defaultHandler){y=true;i.applyWithGuard(this._defaultHandler,{},[x,this]);}if(y&&this._showingID!=this.getActiveID())r(this._activeItem);};w.prototype._setActiveItem=function(x){"use strict";if(x!=this._activeItem){this._clearTimeouts();this._activeItem&&s(this._activeItem);this._activeItem=null;var y=x?0:100;this._hideTimeout=p(function(){if(this.getActiveID()!=this._showingID)this._hide();}.bind(this),y);if(x){this._activeItem=x;var z=y+500;this._showTimeout=p(function(){this._show();}.bind(this),z);this.inform('hover');}else this.inform('leave');}};w.prototype.registerDefault=function(x){"use strict";this._defaultHandler=x;};w.prototype.getActiveID=function(){"use strict";var x=this._activeItem&&this._orderedList.getUserForNode(this._activeItem);return x||null;};w.prototype.showHovercard=function(x,y){"use strict";if(x==this.getActiveID()&&x!=this._showingID){this._clearTimeouts();s(this._activeItem);this._hide();this._showingDialog=y;this._showingID=x;var z=y.subscribe('mouseenter',this._setActiveItem.bind(this,this._activeItem)),aa=y.subscribe('mouseleave',function(){z.unsubscribe();this._setActiveItem(null);}.bind(this)),ba=y.subscribe('hide',function(){this.inform('hovercard_hide');z.unsubscribe();aa.unsubscribe();ba.unsubscribe();}.bind(this));y.enableBehavior(k).setContext(this._activeItem).setPosition('left').show();this.inform('hovercard_show');}};m(w.prototype,{_root:null,_activeItem:null,_hideTimeout:null,_showTimeout:null,_showingDialog:null,_showingID:null,_defaultHandler:null});e.exports=w;},null);
__d("ChatSidebarConstants",["mergeInto"],function(a,b,c,d,e,f,g){var h={LITESTAND_CLASSIC_SIZE:32,IMAGE_SIZE:28};g(h,{getImageSize:function(i){if(i===false)return h.IMAGE_SIZE;return h.LITESTAND_CLASSIC_SIZE;},getItemHeight:function(i){if(i===false)return h.IMAGE_SIZE+4;return h.LITESTAND_CLASSIC_SIZE+4;}});e.exports=h;},null);
__d("ChatQuietLinks",["Event","DOM","UserAgent_DEPRECATED","DataStore","Parent"],function(a,b,c,d,e,f,g,h,i,j,k){var l={},m={silenceLinks:function(q){n(q,this.removeEmptyHrefs.bind(this));},nukeLinks:function(q){n(q,this.removeAllHrefs.bind(this));},removeEmptyHrefs:function(q){o(q,function(r){return !r||r==='#';});},removeAllHrefs:function(q){o(q);}};function n(q,r){var s=!!i.chrome(),t=!!i.chrome()||i.ie()>=9||i.firefox()>=4;if(l[h.getID(q)])return;l[h.getID(q)]=true;if(!t)return;if(!s){r&&r(q);return;}g.listen(q,'mouseover',function u(v){var w=k.byTag(v.getTarget(),'a');if(w){var x=w.getAttribute('href');if(p(x)){j.set(w,'stashedHref',w.getAttribute('href'));w.removeAttribute('href');}}});g.listen(q,'mouseout',function u(v){var w=k.byTag(v.getTarget(),'a'),x=w&&j.remove(w,'stashedHref');if(p(x))w.setAttribute('href',x);});g.listen(q,'mousedown',function(u){if(!u.isDefaultRequested())return true;var v=k.byTag(u.getTarget(),'a'),w=v&&j.get(v,'stashedHref');if(p(w))v.setAttribute('href',w);});}function o(q,r){var s=h.scry(q,'a');if(r)s=s.filter(function(t){return r(t.getAttribute('href'));});s.forEach(function(t){t.removeAttribute('href');t.setAttribute('tabindex',0);});}function p(q){return q&&q!=='#';}e.exports=m;},null);
__d("ChatSidebarItem.react",["AvailableListConstants","ChatConfig","ChatSidebarConstants","Image.react","Link.react","React","SplitImage.react","cx","ix"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){var p=9,q=l.createClass({displayName:'ChatSidebarItem',propTypes:{birthday:l.PropTypes.bool,context:l.PropTypes.string,detailedStatus:l.PropTypes.string,href:l.PropTypes.object,imageSize:l.PropTypes.number,name:l.PropTypes.string,onClick:l.PropTypes.func,status:l.PropTypes.number,statusTime:l.PropTypes.string,unreadCount:l.PropTypes.number},render:function(){var r=(("_55ln")+(this.props.context?' '+"_55lo":'')+(this.props.unreadCount?' '+"_5bom":''));return (l.createElement(k,{className:r,href:this.props.href,onClick:this.props.onClick,rel:"ignore"},l.createElement(l.DOM.div,{className:"_55lp"},l.createElement(l.DOM.div,{className:"_56p9"},this.renderImage(),l.createElement(l.DOM.div,{className:"_568w"})),l.createElement(l.DOM.div,{className:"_5bon"},this.renderBirthday(),this.renderUnreadCount(),this.renderStatus()),l.createElement(l.DOM.div,{className:"_55lr"},this.props.name),l.createElement(l.DOM.div,{className:"_55ls"},this.props.context))));},renderImage:function(){var r=this.props.imageSize||i.IMAGE_SIZE;return l.createElement(m,{size:r,srcs:this.props.images});},renderUnreadCount:function(){var r=this.props.unreadCount;if(!r)return null;var s=(("_5boo")+(r>p?' '+"_5bop":''));if(r>p)r=p+'+';return (l.createElement(l.DOM.div,{className:s},r));},renderStatus:function(){var r=this.getStatusSrc();if(!r&&!this.props.statusTime)return null;var s=r?l.createElement(j,{className:"_568_",src:r}):null;return (l.createElement(l.DOM.div,{className:"_568z"},l.createElement(l.DOM.div,{className:"_568-"},this.props.statusTime),this.renderDetailedPresence(),s));},renderDetailedPresence:function(){if(this.props.unreadCount)return null;return (l.createElement(l.DOM.div,{className:"_5t35"},this.props.detailedStatus));},renderBirthday:function(){if(!this.props.birthday)return null;var r=o('/images/gifts/icons/cake_icon.png');if(h.get('gray_cake'))r=o('/images/chat/sidebar/livebar/divebar_cake.png');return (l.createElement(j,{className:"_5dv3",src:r}));},getStatusSrc:function(){switch(this.props.status){case g.ACTIVE:return o('/images/litestand_classic/sidebar/online.png');case g.MOBILE:return o('/images/litestand_classic/sidebar/pushable.png');}return null;}});e.exports=q;},null);
__d("ChatSidebarUser.react",["ChatOpenTab","ChatSidebarItem.react","WebMessengerPermalinkConstants","React"],function(a,b,c,d,e,f,g,h,i,j){var k=j.createClass({displayName:'ChatSidebarUser',propTypes:{birthday:j.PropTypes.bool,detailedStatus:j.PropTypes.string,image:j.PropTypes.string,imageSize:j.PropTypes.number,name:j.PropTypes.string,sectionName:j.PropTypes.string.isRequired,slot:j.PropTypes.number,status:j.PropTypes.number,statusTime:j.PropTypes.string,unreadCount:j.PropTypes.number,userID:j.PropTypes.string.isRequired},_openTab:function(event){g.openUserTab(this.props.userID,this.props.sectionName,{global_slot:this.props.slot});return event.preventDefault();},render:function(){var l=i.getURIPathForIDOrVanity(this.props.userID);return (j.createElement(h,{onClick:this._openTab,href:{url:l},imageSize:this.props.imageSize,images:this.props.image,name:this.props.name,status:this.props.status,birthday:this.props.birthday,statusTime:this.props.statusTime,detailedStatus:this.props.detailedStatus,context:this.props.context,unreadCount:this.props.unreadCount}));}});e.exports=k;},null);
__d("ChatUnreadCount",["ArbiterMixin","copyProperties","MercuryThreadInformer","MercuryThreads"],function(a,b,c,d,e,f,g,h){var i=b('MercuryThreadInformer').get(),j=b('MercuryThreads').get(),k={};i.subscribe('threads-updated',function(l,m){for(var n in m){var o=j.getCanonicalUserInThread(n);k.inform('unread-changed',o);}});h(k,g,{getUnreadCountForUID:function(l,m){j.getThreadMeta(j.getThreadIDForUser(l),function(n){m(n.unread_count);});}});e.exports=k;},null);
__d("ChatSidebarUserGroup.react",["AvailableList","AvailableListConstants","ChannelConnection","ChatContexts","ChatSidebarSections","ChatSidebarUser.react","ChatUnreadCount","LastMobileActiveTimes","PresencePrivacy","PresenceStatus","React","ShortProfiles","SubscriptionsHandler","cx","shield"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){var v=Object.keys(k).map(function(x){return k[x];}),w=q.createClass({displayName:'ChatSidebarUserGroup',propTypes:{ids:q.PropTypes.array.isRequired,sectionName:q.PropTypes.oneOf(v).isRequired},getInitialState:function(){return {userData:[],unreadCounts:{}};},_updateUnreadCount:function(x){m.getUnreadCountForUID(x,function(y){this.state.unreadCounts[x]=y;this.setState({unreadCounts:this.state.unreadCounts});}.bind(this));},componentWillMount:function(){this.componentWillReceiveProps(this.props);this._subscriptions=new s();this._subscriptions.addSubscriptions(g.subscribe(h.ON_AVAILABILITY_CHANGED,u(this.forceUpdate,this)),o.subscribe('privacy-changed',u(this.forceUpdate,this)),i.subscribe([i.CONNECTED,i.RECONNECTING,i.SHUTDOWN,i.MUTE_WARNING,i.UNMUTE_WARNING],u(this.forceUpdate,this)));},componentWillUnmount:function(){this._subscriptions.release();},componentWillReceiveProps:function(x){r.getMulti(x.ids,function(y){var z=x.ids.map(function(aa){return y[aa];});this.setState({userData:z});}.bind(this));},_renderProfile:function(x,y){if(x.id===0)return null;var z=p.get(x.id),aa=(z!==h.ACTIVE)?n.getShortDisplay(x.id):null,ba=(z===h.ACTIVE)?p.getDetailedActivePresence(x.id):null,ca=i.disconnected()||!o.allows(x.id),da=j.getShortDisplay(x.id);return (q.createElement(q.DOM.li,{className:(("_42fz")+(da?' '+"_52zj":'')+(ca?' '+"_570-":'')),'data-id':x.id,key:x.id},q.createElement(l,{birthday:p.isBirthday(x.id),context:da,detailedStatus:ba,image:x.thumbSrc,imageSize:this.props.imageSize,name:x.name,sectionName:this.props.sectionName,slot:y,status:z,statusTime:aa,unreadCount:this.state.unreadCounts[x.id],userID:x.id})));},render:function(){return (q.createElement(q.DOM.ul,Object.assign({},this.props),this.state.userData.map(this._renderProfile)));}});e.exports=w;},null);
__d("ChatSidebarOrderedList.react",["Animation","AsyncDialog","AsyncRequest","ChatQuietLinks","ChatSidebarConstants","ChatSidebarSections","ChatSidebarUserGroup.react","PresencePrivacy","React","URI","cx","shield","tx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){var t=o.createClass({displayName:'ChatSidebarOrderedList',propTypes:{topUsers:o.PropTypes.array.isRequired,availableUsers:o.PropTypes.array.isRequired,isSidebar:o.PropTypes.bool.isRequired,scrollContainer:o.PropTypes.object},getInitialState:function(){return {mouseOver:true,pauseRendering:false};},shouldComponentUpdate:function(u,v){return !v.mouseOver&&!v.pauseRendering;},componentDidMount:function(){j.nukeLinks(this.getDOMNode());},_scrollToSeparator:function(){if(!this.props.scrollContainer)return;var u=this.refs.usersSeparator.getDOMNode(),v=this.props.scrollContainer.scrollHeight,w=this.props.scrollContainer.clientHeight,x=this.props.scrollContainer.scrollTop,y=Math.min(u.offsetTop,v-w);if(x!==y){var z=Math.abs(y-x)/this.props.scrollContainer.clientHeight*500;new g(this.props.scrollContainer).to('scrollTop',y).ease(g.ease.end).duration(z).go();}},_openBlackbirdSettings:function(){var u=new p('/ajax/chat/privacy/settings_dialog.php').addQueryData({ref:'whitelist_separator'});h.send(new i(u));},_renderOfflineSection:function(){var u=k.getImageSize(this.props.isSidebar),v=this.props.topUsers.filter(function(x){return !n.allows(x);});v.splice(-2);var w=(o.createElement(o.DOM.a,{href:"#",onClick:this._openBlackbirdSettings},"Edit"));return [o.createElement(o.DOM.div,{key:"users_separator1",className:"_554m"},o.createElement(o.DOM.div,{className:"_554o"},o.createElement(o.DOM.div,{className:"_554n"},o.createElement(o.DOM.span,{className:"_554p"},"MORE FRIENDS"),o.createElement(o.DOM.div,{className:"_554q"},o.createElement(o.DOM.span,{className:"_554r"}))))),o.createElement(o.DOM.div,{key:"users_separator2",className:"_554m blackbirdWhitelist"},o.createElement(o.DOM.div,{className:"_554o"},o.createElement(o.DOM.div,{className:"_554n"},o.createElement(o.DOM.div,{className:"_5v-d"},o.createElement(o.DOM.span,{className:"_554t"},s._("These friends can't see you on chat. {=link}",{'=link':w})))))),o.createElement(m,{key:l.OFFLINE_USERS,sectionName:l.OFFLINE_USERS,ids:v,imageSize:u})];},_renderOnlineSection:function(){if(this.props.availableUsers.length===0)return null;var u=k.getImageSize(this.props.isSidebar);return [o.createElement(o.DOM.div,{key:"users_separator",ref:"usersSeparator",onClick:this._scrollToSeparator,className:"_554m moreOnlineFriends"},o.createElement(o.DOM.div,{className:"_554o"},o.createElement(o.DOM.div,{className:"_554n"},o.createElement(o.DOM.span,{className:"_554p"},s._("{MORE ONLINE FRIENDS} ({=count})",{'MORE ONLINE FRIENDS':"MORE FRIENDS",'=count':this.props.availableUsers.length})),o.createElement(o.DOM.div,{className:"_554q"},o.createElement(o.DOM.span,{className:"_554r"}))))),o.createElement(m,{key:l.MORE_ONLINE_FRIENDS,sectionName:l.MORE_ONLINE_FRIENDS,ids:this.props.availableUsers,imageSize:u})];},render:function(){var u=k.getImageSize(this.props.isSidebar),v=this.props.topUsers;if(n.getVisibility()==n.ONLINE)v=this.props.topUsers.filter(function(x){return n.allows(x);});var w=(n.getOnlinePolicy()==n.ONLINE_TO_WHITELIST&&n.getVisibility())?this._renderOfflineSection():this._renderOnlineSection();return (o.createElement(o.DOM.li,Object.assign({},this.props,{onMouseEnter:r(this.setState,this,{mouseOver:true}),onMouseLeave:r(this.setState,this,{mouseOver:false})}),o.createElement(m,{key:l.ORDERED_LIST,sectionName:l.ORDERED_LIST,ids:v,imageSize:u}),w));}});e.exports=t;},null);
__d("OrderedFriendsList",["AvailableList","createArrayFrom","ShortProfiles","WorkModeConfig","InitialChatFriendsList"],function(a,b,c,d,e,f,g,h,i,j){var k=[],l={},m=[],n={contains:function(o){return o in l;},getList:function(){if(j.is_work_user)return h(k);n.reRank();var o=h(k);o=o.filter(function(p){var q=i.getNowUnsafe(p);return !q||q.type=="friend";});return o;},getRank:function(o){return o in l?l[o]:k.length;},reRank:function(){var o={},p={};m.forEach(function(r,s){var t=r.substr(0,r.length-2),u=r.substring(r.length-1);if(typeof(p.uid)=='undefined'){if(typeof(o.uid)=='undefined')o[t]=g.get(t);var v=o[t];if(v==u)p[s]=t;}});k=[];for(var q in p)k.push(p[q]);k.forEach(function(r,s){l[r]=s;});}};(function(){var o=b('InitialChatFriendsList');k=o.list.length?o.list:[];if(!j.is_work_user){m=k.slice();n.reRank();}k.forEach(function(p,q){l[p]=q;});})();e.exports=a.OrderedFriendsList||n;},null);
__d("ChatSortUsers",["AvailableListConstants","OrderedFriendsList","PresencePrivacy","PresenceStatus","ShortProfiles","TokenizeUtil"],function(a,b,c,d,e,f,g,h,i,j,k,l){function m(q,r){var s=i.allows(q),t=i.allows(r);if(s!==t)return s?-1:1;return 0;}var n={};function o(q){if(n[q])return n[q];var r=(k.getNowUnsafe(q)||{}).name;if(r)return n[q]=l.flatten(r);return '~';}var p={sortAlphabetical:function(q,r){var s=o(q),t=o(r);if(s!==t)return s<t?-1:1;return 0;},sortMobile:function(q,r){var s=j.get(q)===g.MOBILE,t=j.get(r)===g.MOBILE;if(s!==t)return t?-1:1;return p.sortAlphabetical(q,r);},sortCoefficient:function(q,r){var s=h.getRank(q),t=h.getRank(r);if(s!==t)return s-t;return p.sortAlphabetical(q,r);},sort:function(q,r){var s=m(q,r);if(s!==0)return s;return p.sortCoefficient(q,r);}};e.exports=p;},null);
__d("ChatOrderedList",["Arbiter","ArbiterMixin","AvailableList","AvailableListConstants","CSS","ChatConfig","ChatHovercard","ChatOrderedListHover","ChatSidebarConstants","ChatSidebarOrderedList.react","ChatSortUsers","ChatVisibility","DOM","DataStore","Event","JSLogger","OrderedFriendsList","Parent","PresencePrivacy","PresenceStatus","React","createObjectFrom","csx","debounceAcrossTransitions","mixin","shield"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa){var ga=null,ha,ia=ea(h);for(var ja in ia)if(ia.hasOwnProperty(ja))la[ja]=ia[ja];var ka=ia===null?null:ia.prototype;la.prototype=Object.create(ka);la.prototype.constructor=la;la.__superConstructor__=ia;function la(ma,na,oa){"use strict";this._isSidebar=ma;this._root=na;this._isVisible=false;this._excludedIds={};this._numTopFriends=5;this._hoverController=null;this._contextualDialog=oa;this._orderedList=s.find(this._root,'.fbChatOrderedList');this._scrollableOrderedList=x.byClass(this._root,'scrollableOrderedList');this._scrollableArea=x.byClass(this._root,'scrollable');if(this._isSidebar)new m(this);g.subscribe(v.DUMP_EVENT,function(pa,qa){qa.chat_lists=qa.chat_lists||{sorted_list:this.getCachedSortedList(),ordered_list:w.getList(),available_list:la.getAvailableList(this._excludedIds),excluded_list:this._excludedIds};}.bind(this));y.subscribe('privacy-user-presence-changed',fa(this._render,this));i.subscribe(j.ON_AVAILABILITY_CHANGED,fa(this._render,this));}la.prototype.getShowingUsers=function(){"use strict";return s.scry(this._root,"li._42fz,li._5a58").map(this.getUserForNode);};la.prototype.getUserForNode=function(ma){"use strict";return t.get(ma,'id')||t.get(ma,'serverthreadid');};la.prototype.getHoverController=function(){"use strict";if(!this._hoverController)this._hoverController=new n(this,this._contextualDialog);return this._hoverController;};la.prototype.getItemHeight=function(){"use strict";return o.getItemHeight(this._isSidebar);};la.prototype.getRoot=function(){"use strict";return this._root;};la.prototype.getSortedList=function(ma){"use strict";return la.getSortedList(ma||this._excludedIds,this._numTopFriends);};la.prototype.getCachedSortedList=function(ma){"use strict";if(ga==null)ga=this.getSortedList(ma);return ga;};la.prototype.hide=function(){"use strict";if(!this._isVisible)return;this._isVisible=false;k.hide(this._scrollableOrderedList||this._root);this.inform('hide');};la.prototype.setNumTopFriends=function(ma){"use strict";if(ma!==this._numTopFriends){this._numTopFriends=ma;this._render();}};la.prototype._renderOrderedList=function(){"use strict";if(!this._isVisible||ha)return;var ma=la.getSortedList({},this._numTopFriends),na=la.getAvailableList(ba(ma));na.sort(q.sortMobile);aa.renderComponent(aa.createElement(p,{availableUsers:na,isSidebar:this._isSidebar,scrollContainer:this._scrollContainer,topUsers:ma}),this._orderedList);this.inform('render');};la.prototype._render=function(){"use strict";this._render=da(this._renderOrderedList.bind(this),300);this._render();};la.prototype.show=function(){"use strict";if(this._isVisible)return;this._isVisible=true;k.show(this._scrollableOrderedList||this._root);this._render();this.inform('show');};la.prototype.isVisible=function(){"use strict";return this._isVisible;};la.prototype.setScrollContainer=function(ma){"use strict";if(s.contains(ma,this._root))this._scrollContainer=ma;};la.getSortedList=function(ma,na){"use strict";var oa=w.getList().filter(function(ra){return !(ra in ma)&&y.getFriendVisibility(ra)!==y.BLACKLISTED;}),pa=[];if(!r.isOnline()){Array.prototype.push.apply(pa,oa);}else{if(y.getOnlinePolicy()===y.ONLINE_TO_WHITELIST)oa=this._filterByWhitelist(oa);Array.prototype.push.apply(pa,oa);}pa=pa.slice(0,na);if(pa.length===na){var qa=la.getAvailableList(pa.concat(ma)).length;qa&&pa.splice(-1);}ga=pa.slice();return pa;};la._filterByWhitelist=function(ma){"use strict";var na=ma,oa={},pa,qa;ma=[];for(pa=0;pa<na.length;++pa){qa=na[pa];if(y.allows(qa)){oa[qa]=true;ma.push(qa);}}var ra=y.getWhitelist();for(pa=0;pa<ra.length;++pa){qa=ra[pa];if(!(qa in oa))ma.push(qa);}for(pa=0;pa<na.length;++pa){qa=na[pa];if(!y.allows(qa))ma.push(qa);}return ma;};la.getAvailableList=function(ma){"use strict";var na;if(!na)na=z.getOnlineIDs();return na.filter(function(oa){return !(oa in ma);});};la._pause=function(){"use strict";ha=true;};la._unpause=function(){"use strict";ha=false;};la._registerToggleRenderItem=function(ma){"use strict";u.listen(ma,'click',function(){ha=!ha;k.conditionClass(ma,'checked',ha);});};e.exports=la;},null);
__d("ChatMiniSidebarUser.react",["AvailableListConstants","ChatOpenTab","ChatSidebarSections","Image.react","Link.react","WebMessengerPermalinkConstants","PresenceStatus","React","cx","ix"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){'use strict';var q=n.createClass({displayName:'ChatMiniSidebarUser',propTypes:{user:n.PropTypes.object.isRequired},_openTab:function(r){h.openUserTab(this.props.user.id,i.ORDERED_LIST);r.preventDefault();},_renderImage:function(){return n.createElement(j,{src:this.props.user.thumbSrc});},_renderStatus:function(){var r=m.get(this.props.user.id),s=null;if(r==g.ACTIVE){s=p('/images/litestand_classic/sidebar/online.png');}else if(r==g.MOBILE)s=p('/images/litestand_classic/sidebar/pushable.png');return s?n.createElement(j,{src:s}):null;},_getHref:function(){return l.getURIPathForIDOrVanity(this.props.user.id);},render:function(){return (n.createElement(n.DOM.li,{className:"_2sb2"},n.createElement(n.DOM.div,{'aria-label':this.props.user.name,className:"_2sb3",'data-hover':"tooltip",'data-tooltip-position':"left"},n.createElement(k,{href:{url:this._getHref()},onClick:this._openTab,rel:"ignore"},n.createElement(n.DOM.div,{className:"_2sb4"},n.createElement(n.DOM.div,{className:"_2sb5"},this._renderImage()),n.createElement(n.DOM.div,{className:"_2sb6"},this._renderStatus()))))));}});e.exports=q;},null);
__d("ChatMiniSidebarBody.react",["ChatMiniSidebarUser.react","LegacyScrollableArea.react","React","ShortProfiles"],function(a,b,c,d,e,f,g,h,i,j){'use strict';var k=56,l=i.createClass({displayName:'ChatMiniSidebarBody',propTypes:{height:i.PropTypes.number.isRequired,users:i.PropTypes.array.isRequired},getInitialState:function(){return {userData:[]};},componentDidMount:function(){this._populateUserData(this.props.users);},componentWillReceiveProps:function(m){this._populateUserData(m.users);},_populateUserData:function(m){j.getMulti(m,function(n){var o=m.map(function(p){return n[p];});this.setState({userData:o});}.bind(this));},_renderUser:function(m){if(m.id===0)return null;return i.createElement(g,{key:m.id,user:m});},render:function(){return (i.createElement(h,{height:this.props.height,width:k,fade:true},i.createElement(i.DOM.ul,null,this.state.userData.map(function(m){return this._renderUser(m);}.bind(this)))));}});e.exports=l;},null);
__d("ChatMiniSidebarFooter.react",["React","cx"],function(a,b,c,d,e,f,g,h){'use strict';var i=g.createClass({displayName:'ChatMiniSidebarFooter',render:function(){return g.createElement(g.DOM.div,{className:"_iup"});}});e.exports=i;},null);
__d("ChatMiniSidebar.react",["AvailableList","AvailableListConstants","ChannelConnection","ChatOrderedList","ChatSidebarConstants","ChatSortUsers","ChatMiniSidebarBody.react","ChatMiniSidebarFooter.react","PresencePrivacy","React","SubscriptionsHandler","createObjectFrom","cx","shield"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){'use strict';var u=6,v=27,w=p.createClass({displayName:'ChatMiniSidebar',propTypes:{height:p.PropTypes.number.isRequired,shown:p.PropTypes.bool.isRequired},getInitialState:function(){return {users:[]};},componentWillMount:function(){this._subscriptions=new q();this._subscriptions.addSubscriptions(g.subscribe(h.ON_AVAILABILITY_CHANGED,this._updateUsers),i.subscribe([i.CONNECTED,i.RECONNECTING,i.SHUTDOWN,i.MUTE_WARNING,i.UNMUTE_WARNING],t(this.forceUpdate,this)),o.subscribe('privacy-changed',t(this.forceUpdate,this)),o.subscribe('privacy-user-presence-changed',this._updateUsers));},componentWillUnmount:function(){this._subscriptions&&this._subscriptions.release();},_getScrollableAreaHeight:function(){return Math.max(this.props.height-u-v,0);},_updateUsers:function(){if(!this.props.shown)return;var x=this._getScrollableAreaHeight(),y=x/k.getItemHeight(true),z=j.getSortedList({},y),aa=j.getAvailableList(r(z));aa.sort(l.sortMobile);this.setState({users:z.concat(aa)});},render:function(){if(!this.props.shown)return null;var x=this._getScrollableAreaHeight();return (p.createElement(p.DOM.div,{className:"_269v"},p.createElement(p.DOM.div,{className:"_269w"}),p.createElement(m,{className:"_269x",height:x,users:this.state.users}),p.createElement(n,null)));}});e.exports=w;},null);
__d("ChatMiniSidebarController",["ChatMiniSidebar.react","React"],function(a,b,c,d,e,f,g,h){'use strict';var i=0,j=null,k=null,l={init:function(m){if(k)return;k=m;},setHeight:function(m){i=m;},show:function(){if(!j){j=h.renderComponent(h.createElement(g,{height:i,shown:true}),k);}else j.setProps({height:i,shown:true});},hide:function(){j&&j.setProps({height:i,shown:false});}};e.exports=l;},null);
__d("ChatSidebarSheet",["ArbiterMixin","BlackbirdUpsell","ChannelConnection","ChannelConstants","ChatBehavior","ChatConfig","ChatVisibility","CSS","DOM","Event","JSLogger","PresencePrivacy","copyProperties","mixin","setTimeoutAcrossTransitions","tx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){var w=q.create('sidebar_sheet');function x(da){switch(da){case j.HINT_AUTH:return "Your session has timed out. Please log in.";case j.HINT_CONN:return v._("Facebook {Chat} is currently unavailable.",{Chat:"Chat"});case j.HINT_MAINT:return v._("Facebook {Chat} is currently down for maintenance.",{Chat:"Chat"});default:return v._("Facebook {Chat} is currently unavailable.",{Chat:"Chat"});}}function y(da){var ea;if(da===null||false===navigator.onLine){ea="Unable to connect to chat. Check your Internet connection.";}else if(da>l.get('warning_countdown_threshold_msec')){var fa=o.create('a',{href:'#',className:'fbChatReconnectLink'},"Try again");ea=o.tx._("Unable to connect to chat. {try-again-link}",{'try-again-link':fa});}else if(da>1000){ea=v._("Unable to connect to chat. Reconnecting in {seconds}...",{seconds:Math.floor(da/1000)});}else ea="Unable to connect to chat. Reconnecting...";return ea;}var z=t(g);for(var aa in z)if(z.hasOwnProperty(aa))ca[aa]=z[aa];var ba=z===null?null:z.prototype;ca.prototype=Object.create(ba);ca.prototype.constructor=ca;ca.__superConstructor__=z;function ca(da){"use strict";this._root=da;this._message=o.find(da,'div.fbChatSidebarMessage div.message');i.subscribe([i.CONNECTED,i.SHUTDOWN,i.RECONNECTING],this._handleConnectionChange.bind(this));i.subscribe([i.MUTE_WARNING,i.UNMUTE_WARNING],this._render.bind(this));r.subscribe('privacy-user-presence-changed',this._render.bind(this));k.subscribe(k.ON_CHANGED,this._render.bind(this));this._render();}ca.prototype._handleConnectionChange=function(da,ea){"use strict";this._channelStatus=da;this._channelData=ea;this._render();};ca.prototype._renderChannelDisconnect=function(){"use strict";if(this._channelStatus===i.SHUTDOWN){return o.setContent(this._message,x(this._channelData));}else if(this._channelStatus===i.RECONNECTING){var da=this._channelData;o.setContent(this._message,y(da));if(da>1000){if(da>l.get('warning_countdown_threshold_msec'))this._warningMsgEventListener=p.listen(this._message,'click',function(event){if(n.hasClass(event.getTarget(),'fbChatReconnectLink')){i.reconnect();return false;}});this._showWarningTimeout=u(this._handleConnectionChange.bind(this,i.RECONNECTING,da-1000),1000);}}};ca.prototype._renderOffline=function(){"use strict";var da='fbChatGoOnlineLink',ea="Turn on chat",fa=o.create('a',{href:'#',className:da},ea),ga=o.tx._("{=Go online} to see who's available.",{'=Go online':fa});o.setContent(this._message,ga);this._goOnlineEventListener=p.listen(this._message,'click',function(event){if(n.hasClass(event.getTarget(),da)){w.log('sidebar_go_online');m.goOnline();return false;}});};ca.prototype._renderBlackbirdUpsell=function(){"use strict";o.setContent(this._message,h.getOfflineContent());};ca.prototype._renderBlackbird=function(da){"use strict";o.setContent(this._message,h.getBlackbirdContent(da));};ca.prototype._clear=function(){"use strict";if(this._showWarningTimeout){clearTimeout(this._showWarningTimeout);this._showWarningTimeout=null;}if(this._warningMsgEventListener){this._warningMsgEventListener.remove();this._warningMsgEventListener=null;}if(this._goOnlineEventListener){this._goOnlineEventListener.remove();this._goOnlineEventListener=null;}n.removeClass(this._root,'upsell');n.removeClass(this._root,'offline');n.removeClass(this._root,'blackbird');n.removeClass(this._root,'error');n.removeClass(this._root,'notice');o.empty(this._message);};ca.prototype._render=function(){"use strict";this._clear();if(h.shouldShow()){if(m.hasBlackbirdEnabled()){var da=m.isOnline()?'blackbird':'upsell';n.addClass(this._root,da);this._renderBlackbird(r.getVisibility());}else if(!m.isOnline()){n.addClass(this._root,'upsell');this._renderBlackbirdUpsell();}}else if(!m.isOnline()){n.addClass(this._root,'offline');this._renderOffline();}else if(i.disconnected()){n.addClass(this._root,'error');this._renderChannelDisconnect();}else if(!k.notifiesUserMessages()){n.addClass(this._root,'notice');var ea="Alerts are off while you use another client to chat.";o.setContent(this._message,ea);}this.inform('updated');};s(ca.prototype,{_channelStatus:null,_channelData:null,_showWarningTimeout:null,_warningMsgEventListener:null,_goOnlineEventListener:null});e.exports=ca;},null);
__d("SidebarFitWindowHeight",["Arbiter","ArbiterMixin","Event","Style","SubscriptionsHandler","TinyViewport","Vector","mixin","queryThenMutateDOM"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){var p=n(h);for(var q in p)if(p.hasOwnProperty(q))s[q]=p[q];var r=p===null?null:p.prototype;s.prototype=Object.create(r);s.prototype.constructor=s;s.__superConstructor__=p;function s(t){"use strict";this.$SidebarFitWindowHeight0=t;this.onViewportUpdate();l.subscribe('change',this.onViewportUpdate.bind(this));}s.prototype.onViewportUpdate=function(){"use strict";if(l.isTiny()){this.onScroll();var t=this.onScroll.bind(this);this.$SidebarFitWindowHeight1=new k();this.$SidebarFitWindowHeight1.addSubscriptions(i.listen(window,'scroll',t),g.subscribe('dom-scroll',t));}else{if(this.$SidebarFitWindowHeight2!==0){j.set(this.$SidebarFitWindowHeight0,'margin-top','0');this.$SidebarFitWindowHeight2=0;}this.$SidebarFitWindowHeight1&&this.$SidebarFitWindowHeight1.release();}};s.prototype.onScroll=function(){"use strict";o(this.updateScrollPosition.bind(this),this.resizeSidebar.bind(this),'SidebarFitWindowHeight/scroll');};s.prototype.updateScrollPosition=function(){"use strict";this.$SidebarFitWindowHeight3=m.getScrollPosition().y;this.$SidebarFitWindowHeight4||(this.$SidebarFitWindowHeight4=this.$SidebarFitWindowHeight0.offsetHeight);};s.prototype.resizeSidebar=function(){"use strict";var t=-Math.max(Math.min(this.$SidebarFitWindowHeight3,this.$SidebarFitWindowHeight4),0);j.set(this.$SidebarFitWindowHeight0,'margin-top',t+'px');if(t!=this.$SidebarFitWindowHeight2){this.$SidebarFitWindowHeight2=t;this.inform('resized',t);}};s.prototype.getOffset=function(){"use strict";return this.$SidebarFitWindowHeight2;};e.exports=s;},null);
__d("ChatSidebar",["Arbiter","ArbiterMixin","AsyncRequest","Banzai","BanzaiLogger","BootloaderConfig","ChatConfig","ChatImpressionLogger","ChatOptions","ChatMiniSidebarController","ChatSidebarSheet","CSS","DOM","DOMDimensions","Event","JSLogger","JSXDOM","KeyEventController","LitestandClassicPlaceHolders","ModalLayer","OrderedFriendsList","Parent","PresencePrivacy","ScrollableArea","SidebarFitWindowHeight","Style","ViewportBounds","copyProperties","createArrayFrom","csx","cx","debounce","emptyFunction","ge"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na){var oa,pa=null,qa=false,ra=false,sa=false,ta=false,ua=false,va,wa=false,xa,ya,za,ab,bb,cb,db,eb=null,fb,gb=v.create('chat_sidebar'),hb='succeeded',ib=k.create(ha({retry:true},j.VITAL));function jb(){r.removeClass(document.documentElement,'sidebarMode');if(!ta||!ub.isVisible()){g.inform('reflow');return;}sa=false;eb=null;ab.hide();cb.getCore().reset();r.hide(ya);if(wa){r.hide(va);r.hide(xa);r.removeClass(document.documentElement,'miniSidebar');r.removeClass(ya,"_51xq");p.hide();gb.log('minisidebar_hide');}else gb.log('sidebar_hide');g.inform('sidebar/hide',ub);g.inform('reflow');}function kb(){var vb=ub.shouldShowSidebar(),wb=ub.shouldShowMiniSidebar();if(ub.isEnabled()&&(vb||wb)){if(vb){nb();ob();}else pb();}else jb();if(!ta){sb();ta=true;}eb=null;}function lb(){if(cb&&ub.isVisible())cb.getCore().getElement().focus();}function mb(vb){var wb=db.height;vb.forEach(function(xb){if(xb&&xb!==oa)wb-=t.getElementDimensions(xb).height;});if(fb)wb-=fb.getOffset();if(bb)wb-=t.getElementDimensions(bb).height;return Math.max(0,wb);}function nb(){if(ub.isVisible())return;if(wa){r.hide(va);r.show(xa);r.removeClass(document.documentElement,'miniSidebar');r.removeClass(ya,"_51xq");p.hide();}sa=true;eb=null;r.show(ya);r.addClass(document.documentElement,'sidebarMode');ab.show();gb.log('sidebar_show');g.inform('sidebar/show',ub);y.destroy('sidebar');}function ob(){var vb=mb(ia(xa.childNodes)),wb=ab.getItemHeight(),xb=8,yb=Math.floor((vb-xb)/wb);fa.set(oa,'height',vb+'px');ab.setNumTopFriends(yb);var zb=Math.floor((vb-xb)/wb);zb=(zb-2)>0?zb-2:0;cb.getData().setMaxResults(zb);g.inform('sidebar/resized',ub);g.inform('reflow');}function pb(){r.hide(xa);r.show(va);r.show(ya);r.addClass(document.documentElement,'sidebarMode');r.addClass(document.documentElement,'miniSidebar');r.addClass(ya,"_51xq");var vb=mb([]);p.setHeight(vb);p.show();sa=false;y.destroy('sidebar');gb.log('minisidebar_show');g.inform('minisidebar/show',ub);g.inform('reflow');}function qb(){o.setSetting('sidebar_mode',ub.isEnabled(),'sidebar');new i('/ajax/chat/settings.php').setHandler(ma).setErrorHandler(ma).setData({sidebar_mode:ub.isEnabled()}).setAllowCrossPageTransition(true).send();}function rb(){return aa.getList().length<=m.get('sidebar.min_friends');}function sb(){var vb=true;if(!ub.isEnabled()){gb.log('state_not_enabled');vb=false;}if(!ub.isViewportCapable())if(!wa){gb.log('state_not_shown_viewport');vb=false;}else if(!ub.isViewportCapableForMiniSidebar()){gb.log('state_not_shown_viewport_mini');vb=false;}if(ra){gb.log('state_not_shown_hidden');vb=false;}if(rb()){gb.log('state_not_shown_num_friends');vb=false;}gb.log(vb?'state_shown':'state_not_shown');}function tb(event,vb){if(!ub.isVisible())return;if(vb){fa.set(ya,'right',vb+'px');}else fa.set(ya,'right','');}var ub={init:function(vb,wb,xb,yb){ub.init=ma;ua=true;ya=vb;ab=wb;cb=xb;za=yb;oa=s.find(vb,'div.fbChatSidebarBody');va=s.find(vb,"._51x-");xa=s.find(vb,"._51x_");bb=s.find(vb,"._5qqe");wa=m.get('mini_sidebar',false);p.init(va);u.listen(window,'resize',kb);x.registerKey('q',function(event){if(sa){if(!pa)pa=s.scry(vb,'.inputsearch')[0];if(pa){pa.focus();event.prevent();}}});var zb=new q(vb);zb.subscribe('updated',kb);ab.setScrollContainer(ba.byClass(ab.getRoot(),'uiScrollableAreaWrap'));ab.subscribe(['render','show','hide'],la(function(bc){var cc=da.getInstance(ab.getRoot());cc&&cc.adjustGripper();}));g.subscribe('chat/option-changed',function(bc,cc){if(cc.name=="sidebar_mode"){qa=!!o.getSetting('sidebar_mode');kb();}});xb.getCore().subscribe('sidebar/typeahead/active',ub.updateOnActiveTypeahead);xb.subscribe('reset',function(){if(!xb.getCore().getValue()&&!ab.isVisible())ub.updateOnActiveTypeahead(null,false);});g.subscribe('buddylist-nub/initialized',function(bc,cc){u.listen(cc.getButton(),'click',function(event){var dc=ra;ra=false;ub.enable();var ec=ub.shouldShowSidebar();ra=dc&&!ec;return !ec;});});qa=!!o.getSetting('sidebar_mode');ca.subscribe('privacy-user-presence-changed',kb);kb();n.init(ab);ga.addPersistentRight(ub.getVisibleWidth);ub.inform('sidebar/initialized',ub,g.BEHAVIOR_PERSISTENT);g.inform('sidebar/initialized',ub,g.BEHAVIOR_PERSISTENT);fb=new ea(bb);fb.subscribe('resized',kb);if(m.get('chat_sidebar_load_log')){var ac={event:hb,session_token:yb.session_token,country_code:yb.viewer_country_code,buddylist_short:m.get('buddylist_short_group'),bootloader_retry:l.retry_on_timeout};ib.log('MessagesSidebarLoadLoggerConfig',ac);}z.subscribe('CompensateForScrollbar',tb);},updateOnActiveTypeahead:function(vb,wb){if(!sa)return;if(wb){ab.hide();}else{ab.show();kb();}},isInitialized:function(){return ta;},disable:function(){if(!ub.isEnabled())return;qa=false;qb();jb();},enable:function(){if(ub.isEnabled())return;qa=true;qb();kb();setTimeout(lb,0);},ensureLoaded:function(){if(!qa)return;if(ua)return;if(na('pagelet_sidebar'))return;d(['UIPagelet'],function(vb){var wb=w.div({id:"pagelet_sidebar"});s.appendContent(document.body,wb);vb.loadFromEndpoint('SidebarPagelet','pagelet_sidebar');});ua=true;},hide:function(){if(ra)return;ra=true;jb();},unhide:function(){if(!ra)return;ra=false;kb();},getBody:function(){return oa;},getRoot:function(){return ya;},getVisibleWidth:function(){if(!sa||!ya)return 0;if(eb===null)eb=ya.offsetWidth;return eb;},isEnabled:function(){return qa;},isViewportCapable:function(){db=t.getViewportWithoutScrollbarDimensions();var vb=m.get('sidebar.minimum_width');return db.width>vb;},shouldShowSidebar:function(){var vb=ub.isViewportCapable();return vb&&!ra&&!rb();},isViewportCapableForMiniSidebar:function(){db=t.getViewportWithoutScrollbarDimensions();var vb=m.get('sidebar.minimum_width'),wb=m.get('minisidebar.minimum_width');return db.width>wb&&db.width<=vb;},shouldShowMiniSidebar:function(){if(!wa)return false;var vb=ub.isViewportCapableForMiniSidebar();return vb&&!ra&&!rb();},isVisible:function(){return sa;},resize:kb,toggle:function(){ub.isEnabled()?ub.disable():ub.enable();}};ha(ub,h);e.exports=ub;},null);
__d("VideoCallingTour",["Arbiter","ArbiterMixin","Chat","ChatSidebar","ChatVisibility","CSS","DOM","PresencePrivacy","Run","Toggler","Vector","copyProperties"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){var s,t,u,v,w=[],x=function(){};function y(){if(j.isVisible()){z();}else if(u)aa();}function z(){s.setContext(t.getBody());ba();s.show();ca();}function aa(){if(!v)v=p.createInstance(u.getRoot());var fa=m.scry(u.getRoot(),'div.fbNubFlyout')[0];if(fa){s.setContext(fa);ba();s.show();ca();}}function ba(){var fa=q.getElementDimensions(s.getContext()).y;s.setOffsetY(fa*.6);s.updatePosition();}function ca(){if(u)w.push(u.subscribe('hide',function(){da();if(!j.isVisible())s.hide();}),u.subscribe('show',function(){s.show();}),u.subscribe('resize',function(){ba();s.updatePosition();}));w.push(g.subscribe('sidebar/show',z),g.subscribe('sidebar/hide',aa),g.subscribe('sidebar/resized',ba));}function da(){if(v){v.setSticky(false);v=null;}}function ea(){while(w.length)w.pop().unsubscribe();if(u)da();s.hide();l.show('fbVideoCallingGetStarted');}r(x,h,{start:function(fa){s=fa;l.hide('fbVideoCallingGetStarted');k.goOnline(function(){w.push(n.subscribe('privacy-user-presence-changed',ea));o.onLeave(ea);i.openBuddyList();var ga=null;w.push(j.subscribe('sidebar/initialized',function(ha,ia){t=ia;clearTimeout(ga);ga=setTimeout(y,0);}),x.subscribe('videocallingtour/end',ea));w.push(g.subscribe('buddylist-nub/initialized',function(ha,ia){u=ia;clearTimeout(ga);ga=setTimeout(y,0);}));});x.inform('videocallingtour/start');}});e.exports=x;},null);
__d("ChatTypeaheadBehavior",["ChatOpenTab","CSS","MercuryConfig","Parent","Rect","copyProperties","cx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(p,q){var r=j.byClass(p,"_4oes");if(r)h.conditionClass(r,"_5q83",q);}function o(p){"use strict";this._typeahead=p;}o.prototype.enable=function(){"use strict";var p=this._typeahead;this._subscriptions=[p.subscribe('focus',function(){p.getData().refreshData();n(p.getElement(),true);}),p.subscribe('blur',function(q){p.getCore().reset();n(p.getElement(),false);}),p.subscribe('respond',function(q,r){if(r.value&&r.value===p.getCore().getValue()){if(!r.results.length){var s=r.value.toLowerCase(),t=p.getData().getQueryCache();if(!r.isAsync&&!t.hasOwnProperty(s))return;p.getView().showNoResults();}h.addClass(p.getElement(),'hasValue');}}),p.subscribe('reset',function(){h.removeClass(p.getElement(),'hasValue');}),p.subscribe('select',function(q,r){var s=r.selected.uid;if(i.MercuryFBIDGK&&r.selected.mercury_thread&&!r.selected.mercury_thread.is_canonical)s=r.selected.mercury_thread.thread_fbid;p.getView().hide();g.openTabByType(s,r.selected.type,'typeahead');}),p.subscribe('highlight',function(q,r){if(r.index>=0){var s=p.getView().getItems()[r.index];if(s){var t=new k(s),u=s.offsetParent,v=t.boundWithin(new k(u)).getPositionVector();t.getPositionVector().sub(v).scrollElementBy(u);}}})];};o.prototype.disable=function(){"use strict";this._subscriptions.forEach(function(p){this._typeahead.unsubscribe(p);},this);this._subscriptions=null;};l(o.prototype,{_subscriptions:null});e.exports=o;},null);
__d("ContextualLayer.react",["ContextualLayer","React","ReactLayer","Style"],function(a,b,c,d,e,f,g,h,i,j){var k=h.PropTypes,l=i.createClass({propTypes:{contextRef:k.string,context:function(m,n,o){if((m.context==null)==(m.contextRef==null))return new Error(("Exactly one of `context` or `contextRef` must be set on `")+(o+"`."));var p=m[n];if(p!=null){if(typeof p!=='object')return new Error(("Invalid `"+n+"` supplied to `"+o+"`, ")+("expected a React component."));if(h.isValidComponent(p))return new Error(("Invalid `"+n+"` supplied to `"+o+"`, ")+("expected a React component instance. You're passing a React ")+("descriptor."));}}},immutableProps:{modal:null},createLayer:function(m){var n=this._getContextNode(),o={context:n,contextBounds:this.props.contextBounds,position:this.props.position,alignment:this.props.alignment,offsetX:this.props.offsetX,offsetY:this.props.offsetY,addedBehaviors:this.enumerateBehaviors(this.props.behaviors),shouldSetARIAProperties:this.props.shouldSetARIAProperties},p=new g(o,m);this._node=m;this._matchContextSize(this.props);if(this.props.contextBounds)p.setContextWithBounds(n,this.props.contextBounds);p.conditionShow(this.props.shown);return p;},receiveProps:function(m){this.updateBehaviors(m.behaviors);var n=this._getContextNode();if(m.contextBounds){this.layer.setContextWithBounds(n,m.contextBounds);}else this.layer.setContext(n);this._matchContextSize(m);this.layer.setPosition(m.position);this.layer.setAlignment(m.alignment);this.layer.setOffsetX(m.offsetX);this.layer.setOffsetY(m.offsetY);this.layer.conditionShow(m.shown);},_getContextNode:function(){var m;if(this.props.context){m=this.props.context.getDOMNode();}else if(this.props.contextRef)m=this.getNodeForOwnerRef(this.props.contextRef);return m;},_matchContextSize:function(m){var n=this._node,o=this._getContextNode();if(m.containerWidthMatchContext)j.set(n,'width',o.offsetWidth+'px');if(m.containerHeightMatchContext)j.set(n,'height',o.offsetHeight+'px');}});e.exports=l;},null);
__d("SearchableTextInput.react",["EventListener","React","AbstractTextFieldMixin.react","AbstractTextInput.react","getActiveElement","merge"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m=h.createClass({displayName:'SearchableTextInput',propTypes:l(i.propTypes,{queryString:h.PropTypes.string,searchSource:h.PropTypes.object,searchSourceOptions:h.PropTypes.object,onEntriesFound:h.PropTypes.func.isRequired,searchOnFocus:h.PropTypes.bool,searchOnUpdate:h.PropTypes.bool,onPaste:h.PropTypes.func,onFocus:h.PropTypes.func,onChange:h.PropTypes.func}),componentDidMount:function(){if(this.props.onPaste)this._listener=g.listen(this.refs.input.getTextFieldDOM(),'paste',this.props.onPaste);},componentDidUpdate:function(n){if(this.props.searchOnUpdate)if(n.queryString!==this.props.queryString)this.search(this.props.queryString);},componentWillUnmount:function(){if(this._listener){this._listener.remove();this._listener=null;}},_onInputFocus:function(){this.props.searchSource.bootstrap(function(){if(this.props.searchOnFocus)this.search(this.props.queryString);}.bind(this));this.props.onFocus&&this.props.onFocus();},_onSearchCallback:function(n,o){if(this.props.queryString===o)this.props.onEntriesFound(n);},_onChange:function(event){this.props.onChange&&this.props.onChange(event);var n=event.target.value;setTimeout(function(){this.search(n);}.bind(this));},search:function(n){this.props.searchSource.search(n,this._onSearchCallback,this.props.searchSourceOptions);},focusInput:function(){var n=this.getTextFieldDOM();if(k()===n){this._onInputFocus();}else n.offsetHeight&&n.focus();},blurInput:function(){var n=this.getTextFieldDOM();n.offsetHeight&&n.blur();},getTextFieldDOM:function(){return this.refs.input.getTextFieldDOM();},render:function(){return (h.createElement(j,Object.assign({},this.props,{ref:"input",value:this.props.queryString||'',onFocus:this._onInputFocus,onChange:this._onChange})));}});e.exports=m;},null);
__d("TypeaheadNavigation",[],function(a,b,c,d,e,f){var g={moveUp:function(h,i,j){var k=h.indexOf(i),l=k==-1?h.length-1:k-1;j(l==-1?null:h[l]);},moveDown:function(h,i,j){var k=h.indexOf(i)+1;j(k==h.length?null:h[k]);}};e.exports=g;},null);
__d("TypeaheadView.react",["React","cx","merge"],function(a,b,c,d,e,f,g,h,i){var j=g.createClass({displayName:'TypeaheadView',propTypes:{entries:g.PropTypes.array.isRequired,extraRendererProps:g.PropTypes.object,highlightedEntry:g.PropTypes.object,isVisible:g.PropTypes.bool,queryString:g.PropTypes.string,Renderer:g.PropTypes.func.isRequired,selectedEntry:g.PropTypes.object},_onSelect:function(k,l){if(this.props.onSelect)this.props.onSelect(k,l);},_onHighlight:function(k){this.props.onHighlight(k);},render:function(){var k=((!this.props.isVisible?"hidden_elem":'')),l=i({highlightedEntry:this.props.highlightedEntry,selectedEntry:this.props.selectedEntry,entries:this.props.entries,onSelect:this._onSelect,onHighlight:this._onHighlight,onRenderHighlight:this.props.onRenderHighlight,queryString:this.props.queryString},this.props.extraRendererProps),m=this.props.Renderer;return (g.createElement(g.DOM.div,{className:k},g.createElement(m,Object.assign({},l))));}});e.exports=j;},null);
__d("AbstractTypeahead.react",["AbstractTextFieldMixin.react","ContextualLayer.react","InputSelection","React","ReactLayeredComponentMixin","SearchableTextInput.react","TypeaheadNavigation","TypeaheadView.react","cx","getOrCreateDOMID","merge","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){var s=10,t=j.createClass({displayName:'AbstractTypeahead',mixins:[k],propTypes:q(g.propTypes,{inputClassName:j.PropTypes.string,inputID:j.PropTypes.string,placeholder:j.PropTypes.string,autoCapitalize:j.PropTypes.string,queryString:j.PropTypes.string,searchSource:j.PropTypes.object.isRequired,searchSourceOptions:j.PropTypes.object,excludedEntries:j.PropTypes.object,presenter:j.PropTypes.object.isRequired,onSelectAttempt:j.PropTypes.func,onEnterWithoutSelection:j.PropTypes.func,autoHighlight:j.PropTypes.bool,showEntriesOnFocus:j.PropTypes.bool,selectOnBlur:j.PropTypes.bool,selectOnTab:j.PropTypes.bool,focusedOnInit:j.PropTypes.bool,hideViewWithEntries:j.PropTypes.bool,disabled:j.PropTypes.bool,entriesWidthMatchContext:j.PropTypes.bool,selectedEntry:j.PropTypes.object,onTypeaheadVisibilityChanged:j.PropTypes.func,onPaste:j.PropTypes.func}),getDefaultProps:function(){return {selectOnBlur:false,selectOnTab:true,hideViewWithEntries:true,entriesWidthMatchContext:true};},getInitialState:function(){return {highlightedEntry:null,isAutoHighlight:this.props.autoHighlight,activeDescendant:null,activeEntries:[],focused:!!this.props.focusedOnInit,viewIsVisible:!!this.props.focusedOnInit};},_onRenderHighlight:function(u){var v=p(u);this.setState({activeDescendant:v});},_onEntriesFound:function(u){if(!this.isMounted())return;if(this.props.excludedEntries){var v=this.props.excludedEntries;u=u.filter(function(da){return !v.hasOwnProperty(da.getUniqueID());});}var w=this.props.presenter,x=typeof w.sortEntries=='function'?w.sortEntries(u):u,y=x.slice(0,w.maxEntries||s);if(!y.length){this.setState({activeDescendant:null,activeEntries:y,highlightedEntry:null,isAutoHighlight:this.props.autoHighlight});this._setViewIsVisible(false);return;}var z=this.state.highlightedEntry,aa=z&&y.indexOf(z)!==-1,ba=(this.state.focused&&(this.props.showEntriesOnFocus||this.props.queryString.length>0));if(!this.props.autoHighlight){this.setState({activeEntries:y,highlightedEntry:aa?z:null});if(ba)this._setViewIsVisible(true);return;}var ca=this.state.isAutoHighlight;if(ca){z=y[0];}else{z=aa?z:y[0];ca=!aa;}this.setState({activeEntries:y,highlightedEntry:z,isAutoHighlight:ca});if(ba)this._setViewIsVisible(true);},_onInputFocus:function(){if((this.state.activeEntries.length&&this.state.queryString)||this.props.showEntriesOnFocus)this._setViewIsVisible(true);this.setState({focused:true});this.props.onFocus&&this.props.onFocus();},_onInputBlur:function(){if(this.props.hideViewWithEntries){this._setViewIsVisible(false);this.clearActiveEntries();}if(this.props.selectOnBlur&&this.state.highlightedEntry)this.props.onSelectAttempt(this.state.highlightedEntry);this.setState({focused:false});this.props.onBlur&&this.props.onBlur();},_onInputClick:function(){var u=this.getTextFieldDOM(),v=i.get(u);if(v&&v.start==v.end)u.select();this.props.onClick&&this.props.onClick();},_onEnter:function(event){if(this.props.onEnterWithoutSelection&&(!this.state.viewIsVisible||!this.state.highlightedEntry)){this.props.onEnterWithoutSelection(event);return;}if(!this.state.viewIsVisible)return;if(!this.state.highlightedEntry){event.preventDefault();return;}if(this.props.hideViewWithEntries)this._setViewIsVisible(false);if(this.props.onSelectAttempt)this.props.onSelectAttempt(this.state.highlightedEntry);event.preventDefault();},_onTab:function(event){if(this.props.selectOnTab&&this.state.viewIsVisible&&this.props.onSelectAttempt&&this.state.highlightedEntry){if(this.props.hideViewWithEntries){this._setViewIsVisible(false);event.preventDefault();}this.props.onSelectAttempt(this.state.highlightedEntry);}},_onDownArrow:function(event){event.preventDefault();m.moveDown(this.state.activeEntries,this.state.highlightedEntry,this._setHighlight);},_onUpArrow:function(event){event.preventDefault();m.moveUp(this.state.activeEntries,this.state.highlightedEntry,this._setHighlight);},_setHighlight:function(u){this.setState({highlightedEntry:u,isAutoHighlight:!u});},_onInputChange:function(event){if(this.props.onChange)this.props.onChange(event);this._setViewIsVisible(this.state.focused&&(this.props.showEntriesOnFocus||event.target.value.length>0)&&this.state.activeEntries.length>0);},_onViewHighlight:function(u){this.setState({highlightedEntry:u,isAutoHighlight:false});},_getView:function(){return (j.createElement(n,{Renderer:this.props.presenter.ViewRenderer,extraRendererProps:this.props.presenter.extraRendererProps,highlightedEntry:this.state.highlightedEntry,selectedEntry:this.props.selectedEntry,isVisible:this.state.viewIsVisible,onHighlight:this._onViewHighlight,onRenderHighlight:this._onRenderHighlight,onSelect:this.props.onSelectAttempt,entries:this.state.activeEntries,queryString:this.props.queryString}));},_setViewIsVisible:function(u){if(u!==this.state.viewIsVisible){this.props.onTypeaheadVisibilityChanged&&this.props.onTypeaheadVisibilityChanged(u);this.setState({viewIsVisible:u});}},componentWillReceiveProps:function(u){if(!u.queryString&&!this.props.showEntriesOnFocus)this.clearActiveEntries();},renderLayers:function(){if(!this.props.presenter.useLayer)return {};var u=null,v=null;if(this.props.context){u=this.props.context;}else v='input';return {typeaheadView:j.createElement(h,{behaviors:this.props.presenter.layerBehaviors,containerWidthMatchContext:this.props.entriesWidthMatchContext,contextRef:v,context:u,position:"below",shown:this.state.viewIsVisible,shouldSetARIAProperties:false},this._getView())};},render:function(){var u=j.createElement(l,{'aria-activedescendant':this.state.activeDescendant,'aria-autocomplete':"list",ref:"input",autoCapitalize:this.props.autoCapitalize,className:this.props.inputClassName,id:this.props.inputID,queryString:this.props.queryString,placeholder:this.props.placeholder,searchSource:this.props.searchSource,searchSourceOptions:this.props.searchSourceOptions,searchOnFocus:!!this.props.showEntriesOnFocus,disabled:this.props.disabled,onEntriesFound:this._onEntriesFound,onEscape:this.props.onEscape,onBlur:this._onInputBlur,onFocus:this._onInputFocus,onChange:this._onInputChange,onDownArrow:this._onDownArrow,onUpArrow:this._onUpArrow,onTab:this._onTab,onEnter:this._onEnter,onBackspace:this.props.onBackspace,onPaste:this.props.onPaste,onClick:this._onInputClick}),v=null;if(!this.props.presenter.useLayer)v=this._getView();return (j.createElement(j.DOM.span,Object.assign({},this.props,{className:r(this.props.className,"_58ah"),onBlur:null,onClick:null,onFocus:null}),{searchableInput:u,view:v}));},componentDidMount:function(){if(this.props.focusedOnInit)this.refs.input.focusInput();},clearActiveEntries:function(){this.setState({activeDescendant:null,activeEntries:[],highlightedEntry:null});},focusInput:function(){this.refs.input.focusInput();},blurInput:function(){if(this.refs.input.blur){this.refs.input.blur();}else if(this.refs.input.blurInput)this.refs.input.blurInput();},hideView:function(){this._setViewIsVisible(false);},getTextFieldDOM:function(){return this.refs.input.getTextFieldDOM();}});e.exports=t;},null);
__d("AbstractSearchSource",["Deferred","emptyFunction","mixInto"],function(a,b,c,d,e,f,g,h,i){function j(){}var k={bootstrap:function(l){l=l||h;if(this._bootstrapped){l();return;}if(this._bootstrapDeferred)return this._bootstrapDeferred.addCallback(l);this._bootstrapDeferred=new g();this._bootstrapDeferred.addCallback(l);this.bootstrapImpl(function(){this._bootstrapped=true;this._bootstrapDeferred.succeed();this._bootstrapDeferred=null;}.bind(this));return this._bootstrapDeferred;},search:function(l,m,n){this.searchImpl(l,m,n);},bootstrapImpl:function(l){l();},searchImpl:function(l,m,n){throw new Error('Abstract method #searchImpl is not implemented.');}};i(j,k);j.Mixin=k;e.exports=j;},null);
__d("SearchSourceCallbackManager",["createObjectFrom","invariant"],function(a,b,c,d,e,f,g,h){function i(k){"use strict";this.$SearchSourceCallbackManager0=k.parseFn;h(typeof this.$SearchSourceCallbackManager0==='function');this.$SearchSourceCallbackManager1=k.matchFn;h(typeof this.$SearchSourceCallbackManager1==='function');this.$SearchSourceCallbackManager2=k.alwaysPrefixMatch||false;this.$SearchSourceCallbackManager3=k.indexFn||j;this.reset();}i.prototype.search=function(k,l,m){"use strict";var n=this.$SearchSourceCallbackManager4(k,l,m);if(n)return 0;this.$SearchSourceCallbackManager5.push({queryString:k,callback:l,options:m});var o=this.$SearchSourceCallbackManager5.length-1;this.$SearchSourceCallbackManager6.push(o);return o;};i.prototype.$SearchSourceCallbackManager4=function(k,l,m){"use strict";var n=this.$SearchSourceCallbackManager7(k),o=!!this.$SearchSourceCallbackManager8[k];if(!n.length){l([],k);return o;}var p=n.map(function(q){return this.$SearchSourceCallbackManager9[q];},this);l(p,k);return o;};i.prototype.$SearchSourceCallbackManagera=function(){"use strict";var k=this.$SearchSourceCallbackManager6;this.$SearchSourceCallbackManager6=[];k.forEach(this.$SearchSourceCallbackManagerb,this);};i.prototype.$SearchSourceCallbackManagerb=function(k){"use strict";var l=this.$SearchSourceCallbackManager5[k];if(!l)return;var m=this.$SearchSourceCallbackManager4(l.queryString,l.callback,l.options);if(m){delete this.$SearchSourceCallbackManager5[k];return;}this.$SearchSourceCallbackManager6.push(k);};i.prototype.reset=function(){"use strict";this.$SearchSourceCallbackManager9={};this.$SearchSourceCallbackManagerc={};this.$SearchSourceCallbackManagerd={};this.$SearchSourceCallbackManagere={};this.$SearchSourceCallbackManager8={};this.$SearchSourceCallbackManager6=[];this.$SearchSourceCallbackManager5=[undefined];};i.prototype.addLocalEntries=function(k){"use strict";k.forEach(function(l){var m=l.getUniqueID(),n=this.$SearchSourceCallbackManager3(l);this.$SearchSourceCallbackManager9[m]=l;this.$SearchSourceCallbackManagerc[m]=n;var o=this.$SearchSourceCallbackManager0(n);o.tokens.forEach(function(p){if(!this.$SearchSourceCallbackManagerd.hasOwnProperty(p))this.$SearchSourceCallbackManagerd[p]={};this.$SearchSourceCallbackManagerd[p][m]=true;},this);},this);this.$SearchSourceCallbackManagera();};i.prototype.addQueryEntries=function(k,l){"use strict";var m=this.$SearchSourceCallbackManager7(l),n=this.$SearchSourceCallbackManager0(l).flatValue;this.$SearchSourceCallbackManagere[n]=g(m,true);k.forEach(function(o){var p=o.getUniqueID();this.$SearchSourceCallbackManager9[p]=o;this.$SearchSourceCallbackManagerc[p]=this.$SearchSourceCallbackManager3(o);this.$SearchSourceCallbackManagere[n][p]=true;},this);this.$SearchSourceCallbackManagera();};i.prototype.unsubscribe=function(k){"use strict";delete this.$SearchSourceCallbackManager5[k];};i.prototype.removeEntry=function(k){"use strict";delete this.$SearchSourceCallbackManager9[k];};i.prototype.getAllEntriesMap=function(){"use strict";return this.$SearchSourceCallbackManager9;};i.prototype.setQueryStringAsExhausted=function(k){"use strict";this.$SearchSourceCallbackManager8[k]=true;};i.prototype.unsetQueryStringAsExhausted=function(k){"use strict";delete this.$SearchSourceCallbackManager8[k];};i.prototype.$SearchSourceCallbackManager7=function(k){"use strict";var l=this.$SearchSourceCallbackManagerf(k,this.$SearchSourceCallbackManagerg(k)),m=this.$SearchSourceCallbackManagerf(k,this.$SearchSourceCallbackManagerh(k)),n=l.concat(m),o={},p=[];n.forEach(function(q){if(!o[q]&&this.$SearchSourceCallbackManager9[q]!==undefined){p.push(q);o[q]=true;}},this);return p;};i.prototype.$SearchSourceCallbackManagerf=function(k,l){"use strict";var m=this.$SearchSourceCallbackManageri(k,l),n=this.$SearchSourceCallbackManager9;function o(p,q){if(m[p]!==m[q])return m[p]?-1:1;var r=n[p],s=n[q];if(r.getOrder()!==s.getOrder())return r.getOrder()-s.getOrder();var t=r.getTitle().length,u=s.getTitle().length;if(t!==u)return t-u;return r.getUniqueID()-s.getUniqueID();}return l.sort(o).slice();};i.prototype.$SearchSourceCallbackManageri=function(k,l){"use strict";var m={};l.forEach(function(n){m[n]=this.$SearchSourceCallbackManager1(k,this.$SearchSourceCallbackManagerc[n]);},this);return m;};i.prototype.$SearchSourceCallbackManagerg=function(k){"use strict";var l=this.$SearchSourceCallbackManager0(k,this.$SearchSourceCallbackManager2),m=this.$SearchSourceCallbackManager2?l.sortedTokens:l.tokens,n=m.length,o=l.isPrefixQuery?n-1:null,p={},q={},r={},s=false,t={},u=0;m.forEach(function(w,x){if(t.hasOwnProperty(w))return;u++;t[w]=true;for(var y in this.$SearchSourceCallbackManagerd){var z=(y===w&&!p.hasOwnProperty(y)),aa=false;if(!z)aa=((this.$SearchSourceCallbackManager2||o===x)&&y.indexOf(w)===0);if(!z&&!aa)continue;if(y===w){if(q.hasOwnProperty(y))s=true;p[y]=true;}else{if(p.hasOwnProperty(y)||q.hasOwnProperty(y))s=true;q[y]=true;}for(var ba in this.$SearchSourceCallbackManagerd[y])if(x===0||(r.hasOwnProperty(ba)&&r[ba]==u-1))r[ba]=u;}},this);var v=Object.keys(r).filter(function(w){return r[w]==u;});if(s||u<n)v=this.$SearchSourceCallbackManagerj(k,v);return v;};i.prototype.$SearchSourceCallbackManagerh=function(k){"use strict";var l=this.$SearchSourceCallbackManager0(k).flatValue,m=this.$SearchSourceCallbackManagerk(l);if(this.$SearchSourceCallbackManagere.hasOwnProperty(l))return m;return this.$SearchSourceCallbackManagerj(k,m);};i.prototype.$SearchSourceCallbackManagerk=function(k){"use strict";var l=0,m=null,n=this.$SearchSourceCallbackManagere;Object.keys(n).forEach(function(o){if(k.indexOf(o)===0&&o.length>l){l=o.length;m=o;}});return (n.hasOwnProperty(m)?Object.keys(n[m]):[]);};i.prototype.$SearchSourceCallbackManagerj=function(k,l){"use strict";return l.filter(function(m){return this.$SearchSourceCallbackManager1(k,this.$SearchSourceCallbackManagerc[m]);},this);};function j(k){return [k.getTitle(),k.getKeywordString()].join(' ');}e.exports=i;},null);
__d("isValidUniqueID",[],function(a,b,c,d,e,f){function g(h){return (h!==null&&h!==undefined&&h!==''&&(typeof h==='string'||typeof h==='number'));}e.exports=g;},null);
__d("SearchableEntry",["HTML","isValidUniqueID","invariant"],function(a,b,c,d,e,f,g,h,i){function j(l){switch(typeof l){case 'string':return l;case 'object':var m=g.replaceJSONWrapper(l);if(g.isHTML(m)){var n=m.getRootNode();return n.textContent||n.innerText||'';}else return '';default:return '';}}function k(l){"use strict";i(h(l.uniqueID));i(!!l.title&&typeof l.title==='string');this.$SearchableEntry0=l.uniqueID+'';this.$SearchableEntry1=l.title;this.$SearchableEntry2=l.order||0;this.$SearchableEntry3=j(l.subtitle);this.$SearchableEntry4=l.keywordString||'';this.$SearchableEntry5=l.photo||'';this.$SearchableEntry6=l.uri||'';this.$SearchableEntry7=l.type||'';this.$SearchableEntry8=l.auxiliaryData||null;}k.prototype.getUniqueID=function(){"use strict";return this.$SearchableEntry0;};k.prototype.getOrder=function(){"use strict";return this.$SearchableEntry2;};k.prototype.getTitle=function(){"use strict";return this.$SearchableEntry1;};k.prototype.getSubtitle=function(){"use strict";return this.$SearchableEntry3;};k.prototype.getKeywordString=function(){"use strict";return this.$SearchableEntry4;};k.prototype.getPhoto=function(){"use strict";return this.$SearchableEntry5;};k.prototype.getURI=function(){"use strict";return this.$SearchableEntry6;};k.prototype.getType=function(){"use strict";return this.$SearchableEntry7;};k.prototype.getAuxiliaryData=function(){"use strict";return this.$SearchableEntry8;};e.exports=k;},null);
__d("AbstractAsyncSearchSource",["AbstractSearchSource","SearchSourceCallbackManager","SearchableEntry","TokenizeUtil","copyProperties","emptyFunction","isValidUniqueID"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){for(var n in g)if(g.hasOwnProperty(n))p[n]=g[n];var o=g===null?null:g.prototype;p.prototype=Object.create(o);p.prototype.constructor=p;p.__superConstructor__=g;function p(q,r,s){"use strict";this.$AbstractAsyncSearchSource0=q.bootstrapRequests;this.$AbstractAsyncSearchSource1=q.queryRequests;this.$AbstractAsyncSearchSource2=q.auxiliaryFields;this.$AbstractAsyncSearchSource3=q.asyncErrorHandler||l;this.$AbstractAsyncSearchSource4=q.packageFn||this.$AbstractAsyncSearchSource5;this.$AbstractAsyncSearchSource6=q.getAllForEmptyQuery;this.$AbstractAsyncSearchSource7=[];this.$AbstractAsyncSearchSource8=new h({parseFn:j.parse,matchFn:j.isQueryMatch,indexFn:q.indexFn});this.$AbstractAsyncSearchSource9=r;this.$AbstractAsyncSearchSourcea=s;}p.prototype.bootstrapImpl=function(q){"use strict";if(!this.$AbstractAsyncSearchSource0||!this.$AbstractAsyncSearchSource0.length){q();return;}var r=this.$AbstractAsyncSearchSource0.length,s=0;this.$AbstractAsyncSearchSource0.forEach(function(t){this.$AbstractAsyncSearchSourceb({},t,function(u){this.$AbstractAsyncSearchSource8.addLocalEntries(u);this.$AbstractAsyncSearchSource7=this.$AbstractAsyncSearchSource7.concat(u);s++;if(s===r){q();q=null;}}.bind(this));}.bind(this));};p.prototype.searchImpl=function(q,r,s){"use strict";if(this.$AbstractAsyncSearchSource6&&q===''){this.getBootstrappedEntries(function(y){r(y,q);});return;}var t=null,u={},v=this.$AbstractAsyncSearchSource8.search(q,function(y){if(!t){t=y;t.forEach(function(z){u[z.getUniqueID()]=true;});}else y.forEach(function(z){var aa=z.getUniqueID();if(!u[aa]){t.push(z);u[aa]=true;}});r(t,q);},s);if(!v||!this.$AbstractAsyncSearchSource1||!this.$AbstractAsyncSearchSource1.length)return;var w={value:q,existing_ids:t&&t.map(function(y){return y.getUniqueID();}).join(',')},x=this.$AbstractAsyncSearchSource1.length;this.$AbstractAsyncSearchSource1.forEach(function(y){this.$AbstractAsyncSearchSourceb(w,y,function(z){this.$AbstractAsyncSearchSourcec(z,q);x--;if(!x)this.$AbstractAsyncSearchSource8.setQueryStringAsExhausted(q);}.bind(this));},this);};p.prototype.getBootstrappedEntries=function(q){"use strict";return this.bootstrap(function(){return q(this.$AbstractAsyncSearchSource7||[]);}.bind(this));};p.prototype.getAllEntriesMap=function(){"use strict";return this.$AbstractAsyncSearchSource8.getAllEntriesMap();};p.prototype.$AbstractAsyncSearchSourceb=function(q,r,s){"use strict";this.$AbstractAsyncSearchSource9(q,r,function(t){return s(this.$AbstractAsyncSearchSourcea(t,this.$AbstractAsyncSearchSource4).filter(function(u){return !!u;}));}.bind(this),this.$AbstractAsyncSearchSource3);};p.prototype.$AbstractAsyncSearchSourced=function(q){"use strict";this.$AbstractAsyncSearchSource8.addLocalEntries(q);};p.prototype.$AbstractAsyncSearchSourcec=function(q,r){"use strict";if(q.length)this.$AbstractAsyncSearchSource8.addQueryEntries(q,r);};p.prototype.$AbstractAsyncSearchSource5=function(q,r){"use strict";var s=q.title||q.text,t=q.uniqueID||q.uid;if(!s||!m(t))return null;return new i({uniqueID:t,order:q.order||q.index||r,title:s,subtitle:q.subtitle||q.category||q.subtext,keywordString:q.keywordString||q.tokens,type:q.type,photo:q.photo,uri:q.uri||q.path,auxiliaryData:this.$AbstractAsyncSearchSourcee(q)});};p.prototype.$AbstractAsyncSearchSourcee=function(q){"use strict";var r;if(this.$AbstractAsyncSearchSource2){r={};for(var s in this.$AbstractAsyncSearchSource2){var t=this.$AbstractAsyncSearchSource2[s];r[s]=q[t];}}if(q.aux_data){r=r||{};k(r,q.aux_data);}return r;};e.exports=p;},null);
__d("WebAsyncSearchSource",["AbstractAsyncSearchSource","AbstractSearchSource","AsyncRequest","copyProperties"],function(a,b,c,d,e,f,g,h,i,j){for(var k in h)if(h.hasOwnProperty(k))m[k]=h[k];var l=h===null?null:h.prototype;m.prototype=Object.create(l);m.prototype.constructor=m;m.__superConstructor__=h;function m(n){"use strict";this.$WebAsyncSearchSource0=new g(n,this.$WebAsyncSearchSource1,this.$WebAsyncSearchSource2);}m.prototype.bootstrapImpl=function(n){"use strict";this.$WebAsyncSearchSource0.bootstrap(n);};m.prototype.searchImpl=function(n,o,p){"use strict";this.$WebAsyncSearchSource0.search(n,o,p);};m.prototype.getBootstrappedEntries=function(n){"use strict";return this.$WebAsyncSearchSource0.getBootstrappedEntries(n);};m.prototype.getAllEntriesMap=function(){"use strict";return this.$WebAsyncSearchSource0.getAllEntriesMap();};m.prototype.$WebAsyncSearchSource1=function(n,o,p,q){"use strict";new i(o.uri).setData(j({},n,o.data)).setMethod('GET').setReadOnly(true).setHandler(p).setErrorHandler(q).send();};m.prototype.$WebAsyncSearchSource2=function(n,o){"use strict";var p=n.getPayload(),q;if(Array.isArray(p)){q=p;}else if(p&&p.entries){q=p.entries;}else q=[];return q.map(o,this);};e.exports=m;},null);
__d("getDOMImageSize",["URI"],function(a,b,c,d,e,f,g){function h(m){m.onload=null;m.onerror=null;m.onreadystatechange=null;m._callback=null;m._thisObj=null;m._srcStr=null;m.parentNode&&m.parentNode.removeChild(m);}function i(){var m=this;if(m._callback)m._callback.call(m._thisObj,m.naturalWidth||m.width,m.naturalHeight||m.height,m._srcStr);h(m);}function j(){var m=this;if(m.readyState==='complete')i.call(m);}function k(){var m=this;if(m._callback)m._callback.call(m._thisObj,0,0,m._srcStr);h(m);}function l(m,n,o){o=o||null;if(!m){n.call(o,0,0,'');return;}var p=document.body;if(!p){setTimeout(l.bind(this,m,n,o),500);return;}var q;if(typeof m==='string'){q=m;}else if(typeof m==='object')if(typeof m.width==='number'&&typeof m.height==='number'){if(typeof m.src==='string'){q=m.src;if(m.naturalWidth&&m.naturalHeight){n.call(o,m.naturalWidth,m.naturalHeight,q);return;}}if(typeof m.uri==='string'){q=m.uri;if(m.width&&m.height){n.call(o,m.width,m.height,q);return;}}}else if(m instanceof g)q=m.toString();if(!q){n(0,0,m);return;}var r=document.createElement('img');r.onreadystatechange=j;r.onload=i;r.onerror=k;r._callback=n;r._thisObj=o;r._srcStr=q;r.src=q;r.style.cssText='position:absolute;left:0;top:0;width:auto;height:auto;clip:rect(0 0 0 0);';p.insertBefore(r,p.firstChild);}e.exports=l;},null);
__d("CachedDOMImageSizePool",["debounce","getDOMImageSize"],function(a,b,c,d,e,f,g,h){function i(j,k){"use strict";this.$CachedDOMImageSizePool0={};this.$CachedDOMImageSizePool1=k;this.$CachedDOMImageSizePool2=0;this.$CachedDOMImageSizePool3=j;this.$CachedDOMImageSizePool4=g(this.$CachedDOMImageSizePool5,5000,this);this.$CachedDOMImageSizePool6={};this.$CachedDOMImageSizePool7={};}i.prototype.get=function(j,k,l){"use strict";if(!j){k.call(l,0,0,j);return;}var m=this.$CachedDOMImageSizePool0[j];if(m){m.lastAccessTime=Date.now();k.call(l,m.width,m.height,m.src);}else if(this.$CachedDOMImageSizePool6[j]){this.$CachedDOMImageSizePool6[j].push(k);this.$CachedDOMImageSizePool7[j].push(l);}else{this.$CachedDOMImageSizePool6[j]=[k];this.$CachedDOMImageSizePool7[j]=[l];h(j,this.$CachedDOMImageSizePool8,this);}};i.prototype.set=function(j,k,l){"use strict";if(this.$CachedDOMImageSizePool2>this.$CachedDOMImageSizePool3)this.$CachedDOMImageSizePool4();var m=this.$CachedDOMImageSizePool0;if(j&&!m[j]){var n={width:k,height:l,src:j,lastAccessTime:Date.now()};m[j]=n;this.$CachedDOMImageSizePool2++;}};i.prototype.$CachedDOMImageSizePool8=function(j,k,l){"use strict";this.set(l,j,k);var m=this.$CachedDOMImageSizePool6[l],n=this.$CachedDOMImageSizePool7[l];for(var o=0,p=m.length;o<p;o++)m[o].call(n[o],j,k,l);delete this.$CachedDOMImageSizePool6[l];delete this.$CachedDOMImageSizePool7[l];};i.prototype.$CachedDOMImageSizePool5=function(){"use strict";var j=Date.now(),k=this.$CachedDOMImageSizePool0,l=this.$CachedDOMImageSizePool2,m=this.$CachedDOMImageSizePool1;for(var n in k){var o=k[n];if((j-o.lastAccessTime)>m){delete k[n];l--;}}this.$CachedDOMImageSizePool2=l;};e.exports=i;},null);
__d("BackgroundImage.react",["CachedDOMImageSizePool","React","ReactPropTypes","XUISpinner.react","cx","invariant","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n='(-?(\\d+\\.)?\\d+(px|\\%))',o=new RegExp('^'+n+'?(\\s'+n+')?$','g'),p=new g(50,10*60*1000),q=h.createClass({displayName:'BackgroundImage',propTypes:{src:i.string,width:i.number.isRequired,height:i.number.isRequired,backgroundSize:i.oneOf(['contain','cover','containinside','coverinside']),loadingIndicatorStyle:i.oneOf(['none','large','small']),backgroundPosition:function(r,s,t){var u=r[s];if(u){l(typeof u==='string');l(u.match(o));}},onImageLoad:i.func,optimizeResizeSpeed:i.bool,onContextMenu:i.func},getInitialState:function(){return {imageWidth:null,imageHeight:null,imageSrc:this.props.src,loading:true};},getDefaultProps:function(){return {optimizeResizeSpeed:false,loadingIndicatorStyle:'none'};},componentDidMount:function(){this._resolveImageSize();},componentDidUpdate:function(r){if(this.props.src!==this.state.imageSrc)this.setState({imageWidth:0,imageHeight:0,imageSrc:this.props.src,loading:true},this._resolveImageSize);},_resolveImageSize:function(){var r=this.state.imageSrc;if(r)p.get(r,this._onImageSizeResolved,this);},render:function(){var r={width:this.props.width+'px',height:this.props.height+'px'},s=m(this.props.className,"_5f0d");return (h.createElement(h.DOM.div,Object.assign({},this.props,{className:m(this.props.className,s),style:Object.assign({},(this.props.style||{}),r),onContextMenu:this.props.onContextMenu}),this._renderImage(),this._renderContent(),this._renderLoadingIndicator()));},_renderLoadingIndicator:function(){if(!this.state.loading||this.props.loadingIndicatorStyle==='none')return null;return (h.createElement(h.DOM.div,{className:"_5laq _5lar"},h.createElement(h.DOM.div,{className:"_5las"},h.createElement(h.DOM.div,{className:"_5lat"},h.createElement(j,{size:this.props.loadingIndicatorStyle})))));},_renderContent:function(){if(this.props.children)return (h.createElement(h.DOM.div,{className:"_5laq"},h.createElement(h.DOM.div,{className:"_5las"},h.createElement(h.DOM.div,{className:"_5lat"},this.props.children))));},_renderImage:function(){if(!this.state.imageWidth||!this.state.imageHeight)return;var r=this.props.width,s=this.props.height,t,u;switch(this.props.backgroundSize){case 'cover':t='cover';u=false;break;case 'coverinside':t='cover';u=true;break;case 'contain':t='contain';u=false;break;case 'containinside':t='contain';u=true;}var v=this.state.imageWidth,w=this.state.imageHeight,x=r/s,y=v/w;if(t==='contain')if((v>r||!u)&&y>=x){v=r;w=v/y;}else if(w>s||!u){w=s;v=w*y;}if(t==='cover')if((v>r||!u)&&y>=x){w=s;v=w*y;}else if(w>s||!u){v=r;w=v/y;}var z=this._getImageStyle(v,w);return (h.createElement(h.DOM.img,{alt:"",className:(("_5i4g")+(this.props.optimizeResizeSpeed?' '+"_5sjv":'')),style:z,src:this.state.imageSrc}));},_getImageStyle:function(r,s){var t;if(this.props.backgroundPosition){t=this.props.backgroundPosition.split(' ');}else t=['50%','50%'];return {width:Math.round(r)+'px',height:Math.round(s)+'px',left:this._getBackgroundPositionPxValue('left',t[0],r,s),top:this._getBackgroundPositionPxValue('top',t[1]||t[0],r,s)};},_getBackgroundPositionPxValue:function(r,s,t,u){var v=parseFloat(s),w=s.substr(v.toString().length);if(w==='px')return s;if(r==='left'){return Math.round((this.props.width-t)*(v/100))+'px';}else return Math.round((this.props.height-u)*(v/100))+'px';},_onImageSizeResolved:function(r,s,t){if(!this.isMounted()||this.state.imageSrc!==t)return;var u=this.props.onImageLoad?this.props.onImageLoad.bind(null,r,s):null;this.setState({imageWidth:r,imageHeight:s,loading:false},u);}});e.exports=q;},null);
__d("TypeaheadViewItem",["React","SearchableEntry"],function(a,b,c,d,e,f,g,h){var i={entry:g.PropTypes.instanceOf(h).isRequired,highlighted:g.PropTypes.bool,selected:g.PropTypes.bool,onSelect:g.PropTypes.func.isRequired,onHighlight:g.PropTypes.func,onRenderHighlight:g.PropTypes.func},j={_onSelect:function(k){this.props.onSelect(this.props.entry,k);},_onHighlight:function(k){if(this.props.onHighlight)this.props.onHighlight(this.props.entry,k);},shouldComponentUpdate:function(k){return (this.props.entry.getUniqueID()!==k.entry.getUniqueID()||this.props.highlighted!==k.highlighted||this.props.selected!==k.selected);},componentDidMount:function(){if(this.props.highlighted&&this.props.onRenderHighlight)this.props.onRenderHighlight(this.getDOMNode());},componentDidUpdate:function(){if(this.props.highlighted&&this.props.onRenderHighlight)this.props.onRenderHighlight(this.getDOMNode());}};e.exports={propTypes:i,Mixin:j};},null);
__d("ContentRollTypeaheadView.react",["BackgroundImage.react","ImageBlock.react","LegacyScrollableArea.react","React","TypeaheadViewItem","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n=j.createClass({displayName:'ContentRollTypeaheadViewItem',mixins:[k.Mixin],propTypes:k.propTypes,render:function(){var p=this.props.entry,q=p.getSubtitle()?j.createElement(j.DOM.div,{className:"_599q"},p.getSubtitle()):null;if(q&&p.getAuxiliaryData()&&p.getAuxiliaryData().icon)q=j.createElement(h,{spacing:"small"},j.createElement(g,{width:16,height:16,src:p.getAuxiliaryData().icon}),q);var r=p.getPhoto()?j.createElement(g,{width:32,height:32,backgroundSize:"cover",src:p.getPhoto()}):j.createElement(j.DOM.span,null),s=(("_5yww")+(!q?' '+"_5mne":'')+(this.props.highlighted?' '+"_599n":''));return (j.createElement(j.DOM.li,{className:s,onMouseDown:this._onSelect,onMouseEnter:this._onHighlight},j.createElement(h,{spacing:"medium"},r,j.createElement(j.DOM.div,null,j.createElement(j.DOM.div,{className:"_599p"},p.getTitle()),q))));}}),o=j.createClass({displayName:'ContentRollTypeaheadView',propTypes:{highlightedEntry:j.PropTypes.object,entries:j.PropTypes.array.isRequired,onSelect:j.PropTypes.func.isRequired,onHighlight:j.PropTypes.func,onRenderHighlight:j.PropTypes.func,scrollableAreaHeight:j.PropTypes.number.isRequired,scrollableAreaWidth:j.PropTypes.number.isRequired},_renderItem:function(p){var q=p===this.props.highlightedEntry;return (j.createElement(n,{key:p.getUniqueID(),entry:p,highlighted:q,onSelect:this.props.onSelect,onHighlight:this.props.onHighlight,onRenderHighlight:this.props.onRenderHighlight}));},render:function(){var p=(("_2072")+(!this.props.entries.length?' '+"_599s":'')),q=this.props.entries,r={};q.forEach(function(v){r[v.getType()]=r[v.getType()]||[];r[v.getType()].push(v);});var s=[];for(var t in r){var u=null;switch(t){case 'recent':u="Recently Viewed Links";break;case 'saved':u="Saved Links";break;case 'bing':u="Bing Results";break;}if(u)s.push(j.createElement(j.DOM.div,{className:"_1opo"},u));r[t].forEach(function(v){s.push(this._renderItem(v));},this);}return (j.createElement(j.DOM.div,{className:p},j.createElement(i,{height:this.props.scrollableAreaHeight,width:this.props.scrollableAreaWidth},j.createElement(j.DOM.ul,null,s))));}});e.exports=o;},null);
__d("ContentRollTypeahead.react",["AbstractTypeahead.react","React","ReactPropTypes","WebAsyncSearchSource","ContentRollTypeaheadView.react","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n=20,o='/ajax/metacomposer/attachment/og/typeahead/content_roll',p=h.createClass({displayName:'ContentRollTypeahead',propTypes:{className:i.string,onSelection:i.func.isRequired,scrollableAreaHeight:h.PropTypes.number.isRequired,scrollableAreaWidth:h.PropTypes.number.isRequired,userID:i.string.isRequired,useLayer:i.bool},getInitialState:function(){return {query:''};},_handleChange:function(event){this.setState({query:event.target.value});},_handleSelectAttempt:function(q){this.setState({query:''});var r={object_id:q.getUniqueID(),url:q.getURI(),source:q.getType(),query:q.getAuxiliaryData().query,subindex:q.getAuxiliaryData().subindex,subtotal:q.getAuxiliaryData().subtotal,index:q.getAuxiliaryData().index,total:q.getAuxiliaryData().total};this.props.onSelection(r);},_getSearchSource:function(){if(!this._searchSource)this._searchSource=new j({bootstrapRequests:[{uri:o,data:{viewer:this.props.userID}}],queryRequests:[{uri:o,data:{viewer:this.props.userID}}],getAllForEmptyQuery:true});return this._searchSource;},_getPlaceholder:function(){if(!this._placeholder)this._placeholder="Search for articles, videos, music, and more";return this._placeholder;},focusInput:function(){this.refs.typeahead.focusInput();},render:function(){var q={ViewRenderer:k,maxEntries:n,useLayer:this.props.useLayer,extraRendererProps:{scrollableAreaHeight:this.props.scrollableAreaHeight,scrollableAreaWidth:this.props.scrollableAreaWidth}};return (h.createElement(g,{autoHighlight:true,className:this.props.className,focusedOnInit:true,inputClassName:"_55r1",onChange:this._handleChange,onSelectAttempt:this._handleSelectAttempt,placeholder:this._getPlaceholder(),presenter:q,queryString:this.state.query,ref:"typeahead",searchSource:this._getSearchSource(),showEntriesOnFocus:true}));}});e.exports=p;},null);
__d("ContentRollFlyout.react",["ContentRollTypeahead.react","Parent","React","ReactPropTypes","Toggler","cx"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m=i.createClass({displayName:'ContentRollFlyout',propTypes:{onSelection:j.func.isRequired,userID:j.string.isRequired},getInitialState:function(){return {showFlyout:false};},componentDidMount:function(){var n=this._getParentToggler();if(n)k.listen('show',n,function(){this.setState({showFlyout:true});}.bind(this));},_getParentToggler:function(){return h.byClass(this.getDOMNode(),'uiToggle');},_hideParentToggler:function(){var n=this._getParentToggler();if(n)k.hide(n);},_handleSelection:function(n){this._hideParentToggler();this.props.onSelection(n);},render:function(){if(!this.state.showFlyout)return i.createElement(i.DOM.div,null);return (i.createElement(g,{className:"_5j11",onSelection:this._handleSelection,scrollableAreaHeight:288,scrollableAreaWidth:256,userID:this.props.userID,useLayer:false}));}});e.exports=m;},null);
__d("MenuSeparator.react",["MenuSeparator"],function(a,b,c,d,e,f,g){function h(j){j.isReactLegacyFactory={};j.type=j;}var i=g;h(i);e.exports=i;},null);
__d("XUIAmbientNUXTheme",["cx"],function(a,b,c,d,e,f,g){var h={wrapperClassName:"_2x6q",arrowDimensions:{offset:14,length:18}};e.exports=h;},null);
__d("XUIAmbientNUX.react",["HasLayerContextMixin","React","ReactLayer","ReactAbstractContextualDialog","XUIAmbientNUXTheme","XUICloseButton.react","XUIContextualDialogBody.react","cx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o=h.PropTypes,p=300,q=380,r=i.createClass(j.createSpec({displayName:'XUIAmbientNUX',theme:k})),s=h.createClass({displayName:'XUIAmbientNUX',mixins:[g],propTypes:{context:o.object,contextRef:o.string,position:o.oneOf(['above','below','left','right']),alignment:o.oneOf(['left','center','right']),offsetX:o.number,offsetY:o.number,width:o.oneOf(['wide','normal','auto','custom']),customwidth:o.number,shown:o.bool,onCloseButtonClick:o.func},_getWidth:function(){switch(this.props.width){case 'wide':return q;case 'custom':return this.props.customwidth;case 'auto':return null;default:return p;}},render:function(){return (h.createElement(r,{alignment:this.props.alignment,autoFocus:false,context:this.getContextNode(),focusContextOnHide:false,offsetX:this.props.offsetX,offsetY:this.props.offsetY,position:this.props.position,shown:this.props.shown,width:this._getWidth(this.props)},h.createElement(h.DOM.div,{className:"_53iv"},h.createElement(m,null,h.createElement(l,{shade:"light",className:"_36gl",onClick:this.props.onCloseButtonClick}),h.createElement(h.DOM.div,{className:"_36gn"},this.props.children)))));}});e.exports=s;},null);
__d("Dock",["Event","shield","Arbiter","ArbiterMixin","ChatQuietLinks","CSS","DataStore","DOM","Parent","Style","Toggler","Vector","copyProperties","csx","emptyFunction","WebMessengerWidthControl"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){b('WebMessengerWidthControl');function v(){}s(v,j,{MIN_HEIGHT:140,INITIAL_FLYOUT_HEIGHT_OFFSET:10,init:function(w){this.init=u;this.rootEl=w;this.calculateViewportDimensions();this.calculateFlyoutHeightOffset();k.removeEmptyHrefs(this.rootEl);g.listen(w,'click',this._onClick.bind(this));g.listen(window,'resize',this._onWindowResize.bind(this));q.subscribe(['show','hide'],function(x,y){var z=y.getActive();if(!n.contains(w,z))return;if(l.hasClass(z,'fbNub')){this.notifyNub(z,x);if(x==='show')this._resizeNubFlyout(z);}else{var aa=o.byClass(z,'fbNubFlyout');if(aa)l.conditionClass(aa,'menuOpened',x==='show');}}.bind(this));this.inform('init',{},i.BEHAVIOR_PERSISTENT);},calculateViewportDimensions:function(){return (this.viewportDimensions=r.getViewportDimensions());},calculateFlyoutHeightOffset:function(){this.flyoutHeightOffset=this.INITIAL_FLYOUT_HEIGHT_OFFSET+r.getElementDimensions(this.rootEl).y;var w=n.scry(document,"div._4f7n")[0];if(w){var x=p.isFixed(w)?'viewport':'document';this.flyoutHeightOffset+=r.getElementPosition(w,x).y+r.getElementDimensions(w).y;}},toggle:function(w){var x=this._findFlyout(w);if(!x)return;this.subscribe('init',function(){q.toggle(w);});},show:function(w){this.subscribe('init',function(){q.show(w);});},showNub:function(w){l.show(w);},hide:function(w){this.subscribe('init',function(){var x=q.getInstance(w);n.contains(w,x.getActive())&&x.hide();});},hideNub:function(w){l.hide(w);this.hide(w);},setUseMaxHeight:function(w,x){l.conditionClass(w,'maxHeight',x!==false);this._resizeNubFlyout(w);},_resizeNubFlyout:function(w){var x=this._findFlyout(w);if(!x||!(l.hasClass(w,'openToggler')||l.hasClass(w,'opened')))return;var y=n.find(x,'div.fbNubFlyoutOuter'),z=n.find(y,'div.fbNubFlyoutInner'),aa=n.find(z,'div.fbNubFlyoutBody'),ba=aa.scrollTop,ca=aa.offsetHeight;p.set(aa,'height','auto');var da=r.getElementDimensions(x),ea=r.getElementDimensions(aa),fa=this.getMaxFlyoutHeight(w);p.set(x,'max-height',fa+'px');p.set(y,'max-height',fa+'px');da=r.getElementDimensions(x);var ga=r.getElementDimensions(z),ha=ga.y-ea.y,ia=da.y-ha,ja=parseInt(aa.style.height||aa.clientHeight,10),ka=ia!==ja;if(da.y>ha&&ka)p.set(aa,'height',ia+'px');l.removeClass(x,'swapDirection');var la=r.getElementPosition(x).x;l.conditionClass(x,'swapDirection',function(){if(la<0)return true;return (la+da.x>this.viewportDimensions.x);}.bind(this)());if(ka&&ba+ca>=ea.y){aa.scrollTop=aa.scrollHeight;}else aa.scrollTop=ba;this.notifyNub(w,'resize');},getMaxFlyoutHeight:function(w){var x=this._findFlyout(w),y=r.getElementPosition(x,'viewport'),z=r.getElementDimensions(x),aa=Math.max(this.MIN_HEIGHT,this.viewportDimensions.y-this.flyoutHeightOffset)-(this.viewportDimensions.y-y.y-z.y);return Math.max(aa,0);},resizeAllFlyouts:function(){var w=this._getAllNubs(),x=w.length;while(x--)this._resizeNubFlyout(w[x]);},hideAllFlyouts:function(){var w=this._getAllNubs(),x=w.length;while(x--)this.hide(w[x]);},_getAllNubs:function(){var w=n.scry(this.rootEl,"div._50-v.openToggler");return w.concat(n.scry(this.rootEl,"div._50-v.opened"));},_onClick:function(event){var w=event.getTarget(),x=o.byClass(w,'fbNub');if(x){if(o.byClass(w,'fbNubFlyoutTitlebar')){var y=o.byTag(w,'a'),z=w.nodeName=='INPUT'&&w.getAttribute('type')=='submit';if(!y&&!z){this.hide(x);return false;}}this.notifyNub(x,'click');}},_onWindowResize:function(event){this.calculateViewportDimensions();this.resizeAllFlyouts();},_findFlyout:function(w){return l.hasClass(w,'fbNubFlyout')?w:n.scry(w,'div.fbNubFlyout')[0]||null;},registerNubController:function(w,x){m.set(w,'dock:nub:controller',x);x.subscribe('nub/button/content-changed',h(this.inform,this,'resize',w));x.subscribe('nub/flyout/content-changed',h(this._resizeNubFlyout,this,w));},unregisterNubController:function(w){m.remove(w,'dock:nub:controller');},notifyNub:function(w,x,y){var z=m.get(w,'dock:nub:controller');z&&z.inform(x,y);}});e.exports=a.Dock||v;},null);
__d("NubController",["ArbiterMixin","Dock","copyProperties"],function(a,b,c,d,e,f,g,h,i){function j(){}i(j.prototype,g,{init:function(k){this.el=k;h.registerNubController(k,this);return this;},buttonContentChanged:function(){this.inform('nub/button/content-changed');},flyoutContentChanged:function(){this.inform('nub/flyout/content-changed');},hide:function(){h.hide(this.el);},show:function(){h.show(this.el);}});e.exports=j;},null);
__d("arraySort",["invariant"],function(a,b,c,d,e,f,g){function h(i,j){g(Array.isArray(i));var k=i.slice();if(j)return k.sort(j);return k.sort();}e.exports=h;},null);
__d("checkRangeOverlap",["invariant"],function(a,b,c,d,e,f,g){function h(i,j,k,l){g(i<=j&&k<=l);return (i<l&&j>k);}e.exports=h;},null);
__d("fillArray",[],function(a,b,c,d,e,f){function g(h,i){var j=new Array(h);for(var k=0;k<h;k++)j[k]=i;return j;}e.exports=g;},null);
__d("DataViewPolyfill",["copyProperties"],function(a,b,c,d,e,f,g){"use strict";function h(i,j,k){if(j===undefined){this._ba=new Uint8Array(i);}else if(k===undefined){this._ba=new Uint8Array(i,j);}else this._ba=new Uint8Array(i,j,k);this.byteLength=this._ba.byteLength;}g(h,{isSupported:function(){return !!a.Uint8Array;}});g(h.prototype,{getUint8:function(i){if(i>=this._ba.length)throw new Error('Trying to read beyond bounds of DataViewPolyfill');return this._ba[i];},getUint16:function(i,j){var k=this.getUint8(i),l=this.getUint8(i+1);return j?(l*256)+k:(k*256)+l;},getUint32:function(i,j){var k=this.getUint8(i),l=this.getUint8(i+1),m=this.getUint8(i+2),n=this.getUint8(i+3);return j?(((n*256+m)*256+l)*256)+k:(((k*256+l)*256+m)*256)+n;}});e.exports=h;},null);
__d("DocumentCommands",["keyMirror"],function(a,b,c,d,e,f,g){var h=g({UNDO:true,REDO:true,DELETE:true,DELETE_WORD:true,DELETE_TO_END_OF_BLOCK:true,BACKSPACE:true,BACKSPACE_WORD:true,BACKSPACE_TO_END_OF_BLOCK:true,BOLD:true,ITALIC:true,UNDERLINE:true,CODE:true,INSERT_BLOCK_DELIMITER:true,TRANSPOSE_CHARACTERS:true,MOVE_SELECTION_TO_START_OF_BLOCK:true,MOVE_SELECTION_TO_END_OF_BLOCK:true});e.exports=h;},null);
__d("DocumentCharacters",[],function(a,b,c,d,e,f){var g={BLOCK_DELIMITER:'\u000D',SOFT_NEWLINE:'\u000A',PHOTO:'\ud83d\udcf7',VIDEO:'\ud83d\udcf9'};e.exports=g;},null);
__d("DocumentRemovalDirection",[],function(a,b,c,d,e,f){var g={BACKWARD:0,FORWARD:1};e.exports=g;},null);
__d("DocumentCompositeDecorator.Experimental",["fillArray"],function(a,b,c,d,e,f,g){function h(k){"use strict";this.$DocumentCompositeDecorator0=k.slice();}h.prototype.getDecorations=function(k){"use strict";var l=g(k.getText().length,null);this.$DocumentCompositeDecorator0.forEach(function(m,n){var o=m.getStrategy();o(k,function(p,q){if(i(l,p,q))j(l,p,q,n);});});return l;};h.prototype.getComponentForKey=function(k){"use strict";return this.$DocumentCompositeDecorator0[k].getComponent();};h.prototype.getPropsForKey=function(k){"use strict";return this.$DocumentCompositeDecorator0[k].getProps();};function i(k,l,m){for(var n=l;n<m;n++)if(k[n]!=null)return false;return true;}function j(k,l,m,n){for(var o=l;o<m;o++)k[o]=n;}e.exports=h;},null);
__d("DocumentDecorator",[],function(a,b,c,d,e,f){function g(h,i,j){"use strict";this.$DocumentDecorator0=h;this.$DocumentDecorator1=i;this.$DocumentDecorator2=j||{};}g.prototype.getStrategy=function(){"use strict";return this.$DocumentDecorator0;};g.prototype.getComponent=function(){"use strict";return this.$DocumentDecorator1;};g.prototype.getProps=function(){"use strict";return this.$DocumentDecorator2;};e.exports=g;},null);
__d("DocumentEntityInstance",["ComposedEntityMutability","ComposedEntityType","arrayContains","getObjectValues","invariant"],function(a,b,c,d,e,f,g,h,i,j,k){var l=j(h),m=j(g);function n(o,p,q){"use strict";k(i(l,o));k(i(m,p));this.$DocumentEntityInstance0=o;this.$DocumentEntityInstance1=p;this.$DocumentEntityInstance2=q;}n.prototype.getType=function(){"use strict";return this.$DocumentEntityInstance0;};n.prototype.getMutability=function(){"use strict";return this.$DocumentEntityInstance1;};n.prototype.getData=function(){"use strict";return this.$DocumentEntityInstance2;};n.prototype.replaceData=function(o){"use strict";this.$DocumentEntityInstance2=o;};e.exports=n;},null);
__d("DocumentEntity",["DocumentEntityInstance","invariant"],function(a,b,c,d,e,f,g,h){var i={},j=0,k={create:function(l,m,n){return k.add(new g(l,m,n));},add:function(l){i[++j]=l;return j.toString();},get:function(l){var m=i[l];h(!!m);return m;}};e.exports=k;},null);
__d("DocumentEntitySegmentsExperimental",["DocumentRemovalDirection"],function(a,b,c,d,e,f,g){var h=g.FORWARD,i={getRemovalRange:function(j,k,l,m,n){var o=l.split(' ');o=o.map(function(y,z){if(n===h){if(z>0)return ' '+y;}else if(z<o.length-1)return y+' ';return y;});var p=m,q,r,s=null,t=null;for(var u=0;u<o.length;u++){r=o[u];q=p+r.length;if(j<q&&p<k){if(s!==null){t=q;}else{s=p;t=q;}}else if(s!==null)break;p=q;}var v=m+l.length,w=s===m,x=t===v;if((!w&&x)||(w&&!x))if(n===h){if(t!==v)t++;}else if(s!==m)s--;return {start:s,end:t};}};e.exports=i;},null);
__d("ContentBlock",["ImmutableObject","invariant","keyMirror"],function(a,b,c,d,e,f,g,h,i){"use strict";var j=i({KEY:true,TYPE:true,TEXT:true,INLINE_STYLES:true,ENTITIES:true});k.create=function(m){return new k(new g(l(m)));};k.set=function(m,n){return new k(g.set(m.getImmutable(),l(n)));};k.prototype.getKey=function(){return this.$ContentBlock0[j.KEY];};k.prototype.getType=function(){return this.$ContentBlock0[j.TYPE];};k.prototype.getText=function(){return this.$ContentBlock0[j.TEXT];};k.prototype.getLength=function(){return this.getText().length;};k.prototype.getInlineStyles=function(){return this.$ContentBlock0[j.INLINE_STYLES];};k.prototype.getEntities=function(){return this.$ContentBlock0[j.ENTITIES];};function k(m){this.$ContentBlock0=m;}k.prototype.getImmutable=function(){return this.$ContentBlock0;};function l(m){var n=m,o=n.key,p=n.type,q=n.text,r=n.inlineStyles,s=n.entities,t={};if(o!==undefined){h(typeof o==='string');t[j.KEY]=o;}if(p!==undefined){h(typeof p==='number');t[j.TYPE]=p;}if(q!==undefined){h(typeof q==='string');t[j.TEXT]=q;}if(r!==undefined){h(Array.isArray(r));t[j.INLINE_STYLES]=r;}if(s!==undefined){h(Array.isArray(s));t[j.ENTITIES]=s;}return t;}e.exports=k;},null);
__d("ImmutableMap",["Immutable","emptyFunction","invariant","keyOf"],function(a,b,c,d,e,f,g,h,i,j){"use strict";var k=j({_DONT_EVER_TYPE_THIS_SECRET_KEY:null}),l='__size_DoNotEverTouchThis',m='__keyByIndexDoNotEverTouchThis',n='__indexByKeyDoNotEverTouchThis';function o(v){var w=isNaN(+v)||(v.substring&&v.substring(0,1)==='.'),x=v===m||v===n||v===l;return !x&&typeof v==='string'&&v!==''&&w;}function p(v,w,x){i(typeof v==='number'&&typeof w==='number'&&w>=0&&v>=0&&v+w<=x);}function q(v){return v instanceof g&&v.hasOwnProperty(l);}function r(v){i(q(v));}function s(v){return v===l||v===m||v===n;}function t(v,w,x,y){var z={enumerable:false,configurable:true,writable:true,value:w},aa={enumerable:false,configurable:true,writable:true,value:x},ba={enumerable:false,configurable:true,writable:true,value:y};Object.defineProperty(v,l,z);Object.defineProperty(v,m,aa);Object.defineProperty(v,n,ba);}var u={create:function(){var v=new g(g[k]),w=u.mergeAndValidateAllPropertiesInto(v,arguments);t(v,w,[],{});v[m].areComputed=false;return v;},mergeAndValidateAllPropertiesInto:function(v,w){var x=w.length,y=0;for(var z=0;z<x;z++){var aa=w[z];for(var ba in aa){if(!aa.hasOwnProperty(ba)||q(aa)&&s(ba))continue;if(!v.hasOwnProperty(ba)){i(o(ba));y++;}var ca=aa[ba];i(ca!==undefined);v[ba]=ca;}}return y;},customDeepFreezeRootNode:function(v){r(v);Object.freeze(v);for(var w in v){if(!v.hasOwnProperty(w)||s(w))continue;g.recurseDeepFreeze(v[w]);}Object.seal(v);},set:function(v,w){r(v);i(w instanceof g||(typeof w==='object'&&w!==undefined&&!Array.isArray(w)));return u.create(v,w);},fromArray:function(v,w){var x=Array.isArray(v),y=typeof w==='function';i(x);i(y);var z=new g(g[k]),aa=[],ba={};t(z,v.length,aa,ba);for(var ca=0;ca<v.length;ca++){var da=v[ca],ea=w(da,ca);i(!z.hasOwnProperty(ea));i(o(ea));z[ea]=da;aa[ca]=''+ea;ba[ea]=ca;}aa.areComputed=true;return z;},size:function(v){r(v);u._computePositionsIfNeeded(v);return v[l];},has:function(v,w){i(o(w));r(v);return v.hasOwnProperty(w);},get:function(v,w){i(o(w));return v.hasOwnProperty(w)?v[w]:undefined;},map:function(v,w,x){r(v);u._computePositionsIfNeeded(v);return u.mapRange(v,w,0,u.size(v),x);},mapRange:function(v,w,x,y,z){r(v);u._computePositionsIfNeeded(v);var aa={},ba=0;p(x,y,u.size(v));var ca=x+y-1;for(var da in v)if(v.hasOwnProperty(da)){if(ba>=x){if(ba>ca)break;aa[da]=w.call(z,v[da],da,ba);}ba++;}return u.create(aa);},filter:function(v,w,x){return u.filterRange(v,w,0,u.size(v),x);},filterRange:function(v,w,x,y,z){var aa={};u.forEachRange(v,function(ba,ca,da){if(w.call(z,ba,ca,da))aa[ca]=ba;},x,y);return u.create(aa);},forEach:function(v,w,x){u.forEachRange(v,w,0,u.size(v),x);},forEachRange:function(v,w,x,y,z){r(v);p(x,y,u.size(v));var aa=0,ba=x+y-1;for(var ca in v)if(v.hasOwnProperty(ca)){if(aa>=x){if(aa>ba)break;w.call(z,v[ca],ca,aa);}aa++;}},mapKeyRange:function(v,w,x,y,z){var aa=u.indexOfKey(v,x),ba=u.indexOfKey(v,y);i(aa!=null&&ba!=null);i(ba>=aa);var ca=(ba-aa)+1;return u.mapRange(v,w,aa,ca,z);},forEachKeyRange:function(v,w,x,y,z){var aa=u.indexOfKey(v,x),ba=u.indexOfKey(v,y);i(aa!=null&&ba!=null);i(ba>=aa);var ca=(ba-aa)+1;u.forEachRange(v,w,aa,ca,z);},keyAtIndex:function(v,w){u._computePositionsIfNeeded(v);var x=v[m][w];return x?x:undefined;},valueAtIndex:function(v,w){var x=u.keyAtIndex(v,w);return x!==undefined?v[x]:undefined;},keyAfter:function(v,w){return u.nthKeyAfter(v,w,1);},keyBefore:function(v,w){return u.nthKeyBefore(v,w,1);},nthKeyAfter:function(v,w,x){var y=u.indexOfKey(v,w);i(y!==undefined);return u.keyAtIndex(v,y+x);},nthKeyBefore:function(v,w,x){return u.nthKeyAfter(v,w,-x);},indexOfKey:function(v,w){i(o(w));u._computePositionsIfNeeded(v);var x=v[n][w];return x===undefined?undefined:x;},slice:function(v,w,x){return u.mapRange(v,h.thatReturnsArgument,w,x);},sliceByKey:function(v,w,x){var y=u.indexOfKey(v,w),z=u.indexOfKey(v,x);i(y!=null&&z!=null);i(z>=y);var aa=(z-y)+1;return u.slice(v,y,aa);},toArray:function(v){var w=0,x=u.size(v),y=[];for(var z in v)if(v.hasOwnProperty(z)){if(w>x)break;y.push(v[z]);w++;}return y;},_computePositionsIfNeeded:function(v){if(v[m].areComputed===false)u._computePositionsFromDictionary(v);},_computePositionsFromDictionary:function(v){var w=v[m],x=v[n],y=0;for(var z in v)if(v.hasOwnProperty(z)){w[y]=z;x[z]=y;y++;}v[m].areComputed=true;}};e.exports=u;},null);
__d("SelectionState",["ImmutableObject","invariant","keyMirror"],function(a,b,c,d,e,f,g,h,i){"use strict";var j=i({ANCHOR_KEY:true,ANCHOR_OFFSET:true,FOCUS_KEY:true,FOCUS_OFFSET:true,IS_BACKWARD:true,HAS_FOCUS:true});k.create=function(m){return new k(new g(l(m)));};k.set=function(m,n){return new k(g.set(m.getImmutable(),l(n)));};k.prototype.getAnchorKey=function(){return this.$SelectionState0[j.ANCHOR_KEY];};k.prototype.getAnchorOffset=function(){return this.$SelectionState0[j.ANCHOR_OFFSET];};k.prototype.getFocusKey=function(){return this.$SelectionState0[j.FOCUS_KEY];};k.prototype.getFocusOffset=function(){return this.$SelectionState0[j.FOCUS_OFFSET];};k.prototype.isBackward=function(){return this.$SelectionState0[j.IS_BACKWARD];};k.prototype.hasFocus=function(){return this.$SelectionState0[j.HAS_FOCUS];};k.prototype.hasEdgeWithin=function(m,n,o){var p=this.getAnchorKey(),q=this.getFocusKey();if(p===q&&p===m){var r=this.getStartOffset(),s=this.getEndOffset();return n<=s&&r<=o;}var t;if(m===p){t=this.getAnchorOffset();}else if(m===q){t=this.getFocusOffset();}else return false;return n<=t&&o>=t;};k.prototype.isCollapsed=function(){return (this.getAnchorKey()===this.getFocusKey()&&this.getAnchorOffset()===this.getFocusOffset());};k.prototype.getStartKey=function(){return this.isBackward()?this.getFocusKey():this.getAnchorKey();};k.prototype.getStartOffset=function(){return this.isBackward()?this.getFocusOffset():this.getAnchorOffset();};k.prototype.getEndKey=function(){return this.isBackward()?this.getAnchorKey():this.getFocusKey();};k.prototype.getEndOffset=function(){return this.isBackward()?this.getAnchorOffset():this.getFocusOffset();};function k(m){this.$SelectionState0=m;}k.prototype.getImmutable=function(){return this.$SelectionState0;};function l(m){var n=m,o=n.anchorKey,p=n.anchorOffset,q=n.focusKey,r=n.focusOffset,s=n.isBackward,t=n.hasFocus,u={};if(o!==undefined){h(typeof o==='string');u[j.ANCHOR_KEY]=o;}if(p!==undefined){h(typeof p==='number');u[j.ANCHOR_OFFSET]=p;}if(q!==undefined){h(typeof q==='string');u[j.FOCUS_KEY]=q;}if(r!==undefined){h(typeof r==='number');u[j.FOCUS_OFFSET]=r;}if(s!==undefined){h(typeof s==='boolean');u[j.IS_BACKWARD]=s;}if(t!==undefined){h(typeof t==='boolean');u[j.HAS_FOCUS]=t;}return u;}e.exports=k;},null);
__d("ContentState",["DocumentCharacters","Immutable","ImmutableMap","ImmutableObject","SelectionState","invariant","keyMirror"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){"use strict";var n=g.SOFT_NEWLINE,o=m({BLOCK_MAP:true,TREE_MAP:true,SELECTION_BEFORE:true,SELECTION_AFTER:true});p.create=function(r){return new p(new j(q(r)));};p.set=function(r,s){return new p(j.set(r.getImmutable(),q(s)));};p.prototype.getBlockMap=function(){return this.$ContentState0[o.BLOCK_MAP];};p.prototype.getSelectionBefore=function(){return this.$ContentState0[o.SELECTION_BEFORE];};p.prototype.getSelectionAfter=function(){return this.$ContentState0[o.SELECTION_AFTER];};p.prototype.getBlockForKey=function(r){return i.get(this.getBlockMap(),r)||null;};p.prototype.getKeyBefore=function(r){return i.keyBefore(this.getBlockMap(),r)||null;};p.prototype.getKeyAfter=function(r){return i.keyAfter(this.getBlockMap(),r)||null;};p.prototype.getBlockAfter=function(r){var s=this.getKeyAfter(r);return s?i.get(this.getBlockMap(),s):null;};p.prototype.getBlockBefore=function(r){var s=this.getKeyBefore(r);return s?i.get(this.getBlockMap(),s):null;};p.prototype.getBlocksAsArray=function(){return i.toArray(this.getBlockMap());};p.prototype.getLastBlock=function(){var r=this.getBlockMap(),s=i.size(r);return i.valueAtIndex(r,s-1);};p.prototype.getPlainText=function(r){return i.toArray(i.map(this.getBlockMap(),function(s,t){return s.getText();})).join(r||n);};p.prototype.hasText=function(){var r=this.getBlockMap(),s=i.valueAtIndex(r,0);return !(i.size(r)===1&&s.getText().length===0);};function p(r){this.$ContentState0=r;}p.prototype.getImmutable=function(){return this.$ContentState0;};function q(r){var s=r,t=s.blockMap,u=s.selectionBefore,v=s.selectionAfter,w={};if(t!==undefined){l(t instanceof h);w[o.BLOCK_MAP]=t;}if(u!==undefined){l(u instanceof k);w[o.SELECTION_BEFORE]=u;}if(v!==undefined){l(v instanceof k);w[o.SELECTION_AFTER]=v;}return w;}e.exports=p;},null);
__d("ContentStateInlineStyle",["ContentBlock","ContentState","ImmutableMap","areEqual"],function(a,b,c,d,e,f,g,h,i,j){"use strict";var k={add:function(m,n,o){return l(m,n,o,true);},remove:function(m,n,o){return l(m,n,o,false);}};function l(m,n,o,p){var q=m.getBlockMap(),r=n.getStartKey(),s=n.getStartOffset(),t=n.getEndKey(),u=n.getEndOffset(),v=i.mapKeyRange(q,function(w,x){var y,z;if(r===t){y=s;z=u;}else{y=x===r?s:0;z=x===t?u:w.getLength();}var aa=w.getInlineStyles(),ba=aa.slice(y,z),ca=ba.map(function(ea){return (p?ea|o:ea&(~o));});if(j(ca,ba))return w;var da=aa.slice(0,y).concat(ca,aa.slice(z,w.getLength()));return g.set(w,{inlineStyles:da});},r,t);return h.set(m,{blockMap:i.set(q,v),selectionBefore:n,selectionAfter:n});}e.exports=k;},null);
__d("applyEntityToContentBlock",["ContentBlock","fillArray"],function(a,b,c,d,e,f,g,h){function i(j,k,l,m){var n=j.getEntities(),o=n.slice(0,k).concat(h(l-k,m),n.slice(l));return g.set(j,{entities:o});}e.exports=i;},null);
__d("applyEntityToContentState",["ContentState","ImmutableMap","applyEntityToContentBlock"],function(a,b,c,d,e,f,g,h,i){function j(k,l,m){var n=k.getBlockMap(),o=l.getStartKey(),p=l.getStartOffset(),q=l.getEndKey(),r=l.getEndOffset(),s=h.mapKeyRange(n,function(t,u){var v,w;if(o===q){v=p;w=r;}else{v=u===o?p:0;w=u===q?0:t.getLength();}return i(t,v,w,m);},o,q);return g.set(k,{blockMap:h.set(n,s),selectionBefore:l,selectionAfter:l});}e.exports=j;},null);
__d("findRanges",[],function(a,b,c,d,e,f){function g(h,i,j){var k=0,l=0,m;for(var n=0;n<h.length;n++){l++;m=h[n];if(m!==h[n+1]){if(i(m))j(k,l);k=l;}}}e.exports=g;},null);
__d("getRangesForDocumentEntityExperimental",["findRanges","invariant"],function(a,b,c,d,e,f,g,h){function i(j,k){var l=[];g(j,function(m){return m===k;},function(m,n){l.push({start:m,end:n});});h(!!l.length);return l;}e.exports=i;},null);
__d("getCharacterRemovalRangeExperimental",["ComposedEntityMutability","DocumentEntity","DocumentEntitySegmentsExperimental","SelectionState","checkRangeOverlap","getRangesForDocumentEntityExperimental","invariant"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n=g.MUTABLE,o=g.IMMUTABLE;function p(q,r,s){var t=r.getStartOffset(),u=r.getEndOffset(),v=q.getEntities(),w=v[t];if(!w)return r;var x=h.get(w),y=x.getMutability();if(y===n)return r;var z=l(v,w).filter(function(ca){return k(t,u,ca.start,ca.end);});m(z.length==1);var aa=z[0];if(y===o)return j.set(r,{anchorOffset:aa.start,focusOffset:aa.end,isBackward:false});var ba=i.getRemovalRange(t,u,q.getText().slice(aa.start,aa.end),aa.start,s);return j.set(r,{anchorOffset:ba.start,focusOffset:ba.end,isBackward:false});}e.exports=p;},null);
__d("generateBlockKey",[],function(a,b,c,d,e,f){var g={},h=Math.pow(2,24);function i(){var j;while(j===undefined||g.hasOwnProperty(j)||!isNaN(+j))j=Math.floor(Math.random()*h).toString(32);g[j]=true;return j;}e.exports=i;},null);
__d("insertFragmentIntoContentState",["ContentBlock","ContentState","ImmutableMap","SelectionState","generateBlockKey","invariant"],function(a,b,c,d,e,f,g,h,i,j,k,l){"use strict";function m(n,o,p){l(o.isCollapsed());var q=o.getStartKey(),r=o.getStartOffset(),s=n.getBlockMap(),t=i.size(p),u,v;if(t===1){var w=i.get(s,q),x=i.valueAtIndex(p,0),y=w.getText(),z=w.getInlineStyles(),aa=w.getEntities(),ba=g.set(w,{text:(y.slice(0,r)+x.getText()+y.slice(r)),inlineStyles:(z.slice(0,r).concat(x.getInlineStyles(),z.slice(r))),entities:(aa.slice(0,r).concat(x.getEntities(),aa.slice(r)))}),ca={};ca[q]=ba;u=q;v=r+x.getText().length;return h.set(n,{blockMap:i.set(s,ca),selectionBefore:o,selectionAfter:j.set(o,{anchorKey:u,anchorOffset:v,focusKey:u,focusOffset:v,isBackward:false})});}var da=[];i.forEach(n.getBlockMap(),function(fa,ga){if(ga!==q){da.push(fa);return;}var ha=fa.getText(),ia=fa.getInlineStyles(),ja=fa.getEntities(),ka=ha.length,la=ha.slice(0,r),ma=ia.slice(0,r),na=ja.slice(0,r),oa=i.valueAtIndex(p,0),pa=g.set(fa,{text:la+oa.getText(),inlineStyles:ma.concat(oa.getInlineStyles()),entities:na.concat(oa.getEntities())});da.push(pa);i.forEach(i.slice(p,1,t-2),function(va){da.push(g.set(va,{key:k()}));});var qa=ha.slice(r,ka),ra=ia.slice(r,ka),sa=ja.slice(r,ka),ta=i.valueAtIndex(p,t-1);u=k();var ua=g.set(ta,{key:u,text:ta.getText()+qa,inlineStyles:ta.getInlineStyles().concat(ra),entities:ta.getEntities().concat(sa)});da.push(ua);});var ea=i.valueAtIndex(p,t-1);v=ea.getText().length;return h.set(n,{blockMap:i.fromArray(da,function(fa){return fa.getKey();}),selectionBefore:o,selectionAfter:j.set(o,{anchorKey:u,anchorOffset:v,focusKey:u,focusOffset:v,isBackward:false})});}e.exports=m;},null);
__d("insertTextIntoContentState",["ContentBlock","ContentState","ImmutableMap","SelectionState","invariant"],function(a,b,c,d,e,f,g,h,i,j,k){"use strict";function l(m,n,o,p,q){k(n.isCollapsed());var r=o.length;k(r===p.length&&r===q.length);if(!o.length)return m;var s=m.getBlockMap(),t=n.getStartKey(),u=n.getStartOffset(),v=i.get(s,t),w=v.getText(),x=v.getInlineStyles(),y=v.getEntities(),z=w.length,aa=g.set(v,{text:(w.slice(0,u)+o+w.slice(u,z)),inlineStyles:x.slice(0,u).concat(p,x.slice(u,z)),entities:y.slice(0,u).concat(q,y.slice(u,z))}),ba={};ba[t]=aa;var ca=u+r;return h.set(m,{blockMap:i.set(s,ba),selectionAfter:j.set(n,{anchorOffset:ca,focusOffset:ca})});}e.exports=l;},null);
__d("removeEntitiesAtEdges",["ContentBlock","ContentState","ComposedEntityMutability","DocumentEntity","ImmutableMap","fillArray","findRanges","isEmpty"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o=i.MUTABLE;function p(s,t){var u=s.getBlockMap(),v={},w=t.getStartKey(),x=t.getStartOffset(),y=k.get(u,w),z=r(y,x);if(z)v[w]=z;var aa=t.getEndKey(),ba=t.getEndOffset(),ca=k.get(u,aa);if(w===aa&&z)ca=z;var da=r(ca,ba);if(da)v[aa]=da;if(n(v))return h.set(s,{selectionAfter:t});return h.set(s,{blockMap:k.set(u,v),selectionAfter:t});}function q(s,t,u){var v;m(s,function(w){return w===t;},function(w,x){if(w<=u&&x>=u)v={start:w,end:x};});return v;}function r(s,t){var u=s.getEntities(),v=u[t-1],w=u[t];if(w&&w===v){var x=j.get(w);if(x.getMutability()!==o){var y=q(u,w,t);return g.set(s,{entities:u.slice(0,y.start).concat(l(y.end-y.start,null),u.slice(y.end))});}}return null;}e.exports=p;},null);
__d("removeRangeFromContentState",["ContentBlock","ContentState","ImmutableMap","SelectionState"],function(a,b,c,d,e,f,g,h,i,j){"use strict";function k(l,m){if(m.isCollapsed())return l;var n=l.getBlockMap(),o=m.getStartKey(),p=m.getStartOffset(),q=i.indexOfKey(n,o),r=m.getEndKey(),s=m.getEndOffset(),t=i.indexOfKey(n,r),u=i.map(n,function(v,w,x){if(x<q||x>t)return v;if(x>q&&x<=t)return null;var y=i.get(n,r),z=y.getText(),aa=y.getInlineStyles(),ba=y.getEntities(),ca=z.length,da=v.getText(),ea=v.getInlineStyles(),fa=v.getEntities();return g.set(v,{text:(da.slice(0,p)+z.slice(s,ca)),inlineStyles:ea.slice(0,p).concat(aa.slice(s,ca)),entities:fa.slice(0,p).concat(ba.slice(s,ca))});});return h.set(l,{blockMap:i.filter(u,function(v){return !!v;}),selectionBefore:m,selectionAfter:j.set(m,{anchorKey:o,anchorOffset:p,focusKey:o,focusOffset:p,isBackward:false})});}e.exports=k;},null);
__d("setBlockTypeForContentState",["ContentBlock","ContentState","ImmutableMap"],function(a,b,c,d,e,f,g,h,i){"use strict";function j(k,l,m){var n=k.getBlockMap(),o=i.mapKeyRange(n,function(p,q){return g.set(p,{type:m});},l.getStartKey(),l.getEndKey());return h.set(k,{blockMap:i.set(n,o),selectionBefore:l,selectionAfter:l});}e.exports=j;},null);
__d("splitBlockInContentState",["ContentBlock","ContentState","ImmutableMap","SelectionState","generateBlockKey","invariant"],function(a,b,c,d,e,f,g,h,i,j,k,l){"use strict";function m(n,o){l(o.isCollapsed());var p=o.getAnchorKey(),q=o.getAnchorOffset(),r=n.getBlockMap(),s=i.get(r,p),t=s.getText(),u=s.getInlineStyles(),v=s.getEntities(),w=g.set(s,{text:t.slice(0,q),inlineStyles:u.slice(0,q),entities:v.slice(0,q)}),x=k(),y=g.set(w,{key:x,text:t.slice(q),inlineStyles:u.slice(q),entities:v.slice(q)}),z=[];i.forEach(r,function(aa,ba){if(ba===p){z.push(w);z.push(y);}else z.push(aa);});return h.set(n,{blockMap:i.fromArray(z,function(aa){return aa.getKey();}),selectionBefore:o,selectionAfter:j.set(o,{anchorKey:x,anchorOffset:0,focusKey:x,focusOffset:0,isBackward:false})});}e.exports=m;},null);
__d("DocumentModifierExperimental",["ContentStateInlineStyle","applyEntityToContentState","fillArray","getCharacterRemovalRangeExperimental","insertFragmentIntoContentState","insertTextIntoContentState","invariant","removeEntitiesAtEdges","removeRangeFromContentState","setBlockTypeForContentState","splitBlockInContentState"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){"use strict";var r={replaceText:function(s,t,u,v,w){var x=n(s,t),y=o(x,t);return l(y,y.getSelectionAfter(),u,i(u.length,v),i(u.length,w));},insertText:function(s,t,u,v,w){m(t.isCollapsed());var x=n(s,t);return l(x,x.getSelectionAfter(),u,i(u.length,v),i(u.length,w));},replaceWithFragment:function(s,t,u){var v=n(s,t),w=o(v,t);return k(w,w.getSelectionAfter(),u);},removeRange:function(s,t,u){if(t.getAnchorKey()===t.getFocusKey()){var v=t.getAnchorKey(),w=t.getStartOffset(),x=t.getEndOffset(),y=s.getBlockForKey(v),z=y.getEntities(),aa=z[w],ba=z[x-1];if(aa&&aa===ba){var ca=j(y,t,u);return o(s,ca);}}var da=n(s,t);return o(da,t);},splitBlock:function(s,t){var u=n(s,t),v=o(u,t);return q(v,v.getSelectionAfter());},applyInlineStyle:function(s,t,u){return g.add(s,t,u);},removeInlineStyle:function(s,t,u){return g.remove(s,t,u);},setBlockType:function(s,t,u){return p(s,t,u);},applyEntity:function(s,t,u){var v=n(s,t);return h(v,t,u);}};e.exports=r;},null);
__d("DocumentOffsetKey",[],function(a,b,c,d,e,f){var g='-',h={encode:function(i,j,k){return i+g+j+g+k;},decode:function(i){var j=i.split(g),k=j[0],l=j[1],m=j[2];return {blockKey:k,decoratorKey:l,leafKey:m};}};e.exports=h;},null);
__d("createEmptySelectionState",["SelectionState"],function(a,b,c,d,e,f,g){"use strict";function h(i){return g.create({anchorKey:i,anchorOffset:0,focusKey:i,focusOffset:0,isBackward:false,hasFocus:false});}e.exports=h;},null);
__d("createContentStateFromBlocks",["ContentState","ImmutableMap","createEmptySelectionState"],function(a,b,c,d,e,f,g,h,i){"use strict";function j(k,l){var m=h.fromArray(k,function(p){return p.getKey();}),n=h.keyAtIndex(m,0),o=i(n);return g.create({blockMap:m,selectionBefore:o,selectionAfter:o});}e.exports=j;},null);
__d("BlockTree",["emptyFunction","fillArray","findRanges"],function(a,b,c,d,e,f,g,h,i){"use strict";var j=g.thatReturnsTrue,k='-',l={generate:function(n,o){var p=n.getText().length;if(!p)return [{start:0,end:0,decoratorKey:null,leaves:[{start:0,end:0}]}];var q=[],r=o?o.getDecorations(n):h(p,null),s=n.getInlineStyles();i(r,j,function(t,u){q.push({start:t,end:u,decoratorKey:r[t],leaves:m(s.slice(t,u),t)});});return q;},getFingerprint:function(n){return n.map(function(o){var p=o.decoratorKey,q=p!==null?p+'.'+(o.end-o.start):'';return ''+q+'.'+o.leaves.length;}).join(k);}};function m(n,o){var p=[];i(n,j,function(q,r){p.push({start:q+o,end:r+o});});return p;}e.exports=l;},null);
__d("EditorChangeType",["keyMirror"],function(a,b,c,d,e,f,g){"use strict";var h=g({UNDO:true,REDO:true,CHANGE_SELECTION:true,INSERT_CHARACTERS:true,BACKSPACE_CHARACTER:true,DELETE_CHARACTER:true,REMOVE_RANGE:true,SPLIT_BLOCK:true,INSERT_FRAGMENT:true,CHANGE_INLINE_STYLE:true,CHANGE_BLOCK_TYPE:true,APPLY_ENTITY:true});e.exports=h;},null);
__d("generateContentStateKey",[],function(a,b,c,d,e,f){var g=0;function h(){return 'state-'+(++g);}e.exports=h;},null);
__d("EditorState",["BlockTree","ComposedInlineStyle","ContentState","DocumentCompositeDecorator.Experimental","EditorChangeType","Immutable","ImmutableMap","ImmutableObject","SelectionState","generateContentStateKey","invariant","keyMirror"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){"use strict";var s=r({ALLOW_UNDO:true,BOUNDARY_KEY:true,CURRENT_KEY:true,DECORATOR:true,FORCE_SELECTION:true,IN_COMPOSITION_MODE:true,INLINE_STYLE_OVERRIDE:true,LAST_CHANGE_TYPE:true,NATIVELY_RENDERED_KEY:true,SELECTION:true,STACK:true,TREE_MAP:true});t.create=function(z){if(z.allowUndo===undefined)z.allowUndo=true;var aa=u(z);aa[s.TREE_MAP]=v(m.get(aa[s.STACK],aa[s.CURRENT_KEY]),aa[s.DECORATOR]);return new t(new n(aa));};t.set=function(z,aa){var ba=u(aa),ca=ba[s.STACK]||z.getStack(),da=ba[s.CURRENT_KEY]||z.getCurrentKey(),ea=m.get(ca,da),fa=ba[s.DECORATOR]||z.getDecorator();if(fa!==z.getDecorator()){ba[s.TREE_MAP]=v(ea,fa);ba[s.NATIVELY_RENDERED_KEY]=null;}else if(ea!==z.getCurrentContent())ba[s.TREE_MAP]=m.set(z.getTreeMap(),w(z.getCurrentContent(),ea,fa));return new t(n.set(z.getImmutable(),ba));};t.prototype.allowUndo=function(){return this.$EditorState0[s.ALLOW_UNDO];};t.prototype.getCurrentKey=function(){return this.$EditorState0[s.CURRENT_KEY];};t.prototype.getBoundaryKey=function(){return this.$EditorState0[s.BOUNDARY_KEY];};t.prototype.getStack=function(){return this.$EditorState0[s.STACK];};t.prototype.getTreeMap=function(){return this.$EditorState0[s.TREE_MAP];};t.prototype.getSelection=function(){return this.$EditorState0[s.SELECTION];};t.prototype.getDecorator=function(){return this.$EditorState0[s.DECORATOR];};t.prototype.isInCompositionMode=function(){return this.$EditorState0[s.IN_COMPOSITION_MODE];};t.prototype.mustForceSelection=function(){return this.$EditorState0[s.FORCE_SELECTION];};t.prototype.getNativelyRenderedKey=function(){return this.$EditorState0[s.NATIVELY_RENDERED_KEY];};t.prototype.getLastChangeType=function(){return this.$EditorState0[s.LAST_CHANGE_TYPE];};t.prototype.getCurrentContent=function(){return m.get(this.getStack(),this.getCurrentKey());};t.prototype.getInlineStyleOverride=function(){return this.$EditorState0[s.INLINE_STYLE_OVERRIDE];};t.prototype.getCurrentInlineStyle=function(){var z=this.getInlineStyleOverride();if(z!==null)return z;var aa=this.getSelection(),ba=this.getCurrentContent();if(aa.isCollapsed()){var ca=aa.getStartOffset(),da=ba.getBlockForKey(aa.getStartKey()),ea=da.getInlineStyles();if(ca>0)return ea[ca-1];if(da.getLength())return ea[0];}return y(ba,aa);};t.prototype.isAtDocumentStart=function(){var z=this.getSelection(),aa=this.getCurrentContent(),ba=aa.getBlockMap(),ca=m.keyAtIndex(ba,0);return z.hasEdgeWithin(ca,0,0);};t.prototype.isAtDocumentEnd=function(){var z=this.getSelection(),aa=this.getCurrentContent(),ba=aa.getBlockMap(),ca=m.keyAtIndex(ba,m.size(ba)-1),da=m.get(ba,ca),ea=da.getText().length;return z.hasEdgeWithin(ca,ea,ea);};t.updateSelection=function(z,aa,ba){return t.set(z,{selection:aa,forceSelection:ba,nativelyRenderedKey:null,inlineStyleOverride:null});};t.moveFocusToEnd=function(z){var aa=z.getCurrentContent(),ba=aa.getLastBlock(),ca=ba.getKey(),da=ba.getLength();return t.updateSelection(z,o.create({anchorKey:ca,anchorOffset:da,focusKey:ca,focusOffset:da,isBackward:false,hasFocus:true}),true);};t.push=function(z,aa,ba){if(z.getCurrentContent()===aa)return z;var ca=z.getStack(),da=z.getBoundaryKey(),ea=z.getCurrentKey(),fa=z.getCurrentContent(),ga=z.getSelection(),ha=ba!==k.INSERT_CHARACTERS;if(ga!==fa.getSelectionAfter()||x(z,ba)){da=ea;aa=i.set(aa,{selectionBefore:ga});}else if(ba===k.INSERT_CHARACTERS||ba===k.BACKSPACE_CHARACTER||ba===k.DELETE_CHARACTER)aa=i.set(aa,{selectionBefore:fa.getSelectionBefore()});var ia=p(),ja={};ja[ia]=aa;var ka;if(z.allowUndo()){var la=m.indexOfKey(ca,da)+1,ma=m.slice(ca,0,la);ka=m.set(ma,ja);}else ka=m.create(ja);return t.set(z,{stack:ka,boundaryKey:da,currentKey:ia,lastChangeType:ba,selection:aa.getSelectionAfter(),forceSelection:ha,inlineStyleOverride:null});};t.undo=function(z){if(!z.allowUndo())return z;var aa=z.getBoundaryKey(),ba=z.getCurrentKey(),ca=z.getStack(),da=z.getCurrentContent();if(aa===ba){var ea=m.nthKeyBefore(ca,aa,1);if(ea===undefined)return z;return t.set(z,{boundaryKey:ea,currentKey:ea,forceSelection:true,inlineStyleOverride:null,lastChangeType:k.UNDO,nativelyRenderedKey:null,selection:da.getSelectionBefore()});}return t.set(z,{currentKey:aa,forceSelection:true,inlineStyleOverride:null,lastChangeType:k.UNDO,nativelyRenderedKey:null,selection:da.getSelectionBefore(),stack:ca});};t.redo=function(z){if(!z.allowUndo())return z;var aa=z.getStack(),ba=m.nthKeyAfter(aa,z.getBoundaryKey(),1);if(ba===undefined)return z;var ca=m.get(aa,ba);return t.set(z,{boundaryKey:ba,currentKey:ba,forceSelection:true,inlineStyleOverride:null,lastChangeType:k.REDO,nativelyRenderedKey:null,selection:ca.getSelectionAfter()});};function t(z){this.$EditorState0=z;}t.prototype.getImmutable=function(){return this.$EditorState0;};function u(z){var aa=z,ba=aa.allowUndo,ca=aa.boundaryKey,da=aa.currentKey,ea=aa.decorator,fa=aa.forceSelection,ga=aa.inCompositionMode,ha=aa.inlineStyleOverride,ia=aa.lastChangeType,ja=aa.nativelyRenderedKey,ka=aa.selection,la=aa.stack,ma={};if(ba!==undefined){q(typeof ba==='boolean');ma[s.ALLOW_UNDO]=ba;}if(ca!==undefined){q(typeof ca==='string');ma[s.BOUNDARY_KEY]=ca;}if(da!==undefined){q(typeof da==='string');ma[s.CURRENT_KEY]=da;}if(ea!==undefined){q(ea instanceof j);ma[s.DECORATOR]=ea;}if(fa!==undefined){q(typeof fa==='boolean');ma[s.FORCE_SELECTION]=fa;}if(ga!==undefined){q(typeof ga==='boolean');ma[s.IN_COMPOSITION_MODE]=ga;}if(ha!==undefined){q(typeof ha==='number'||ha===null);ma[s.INLINE_STYLE_OVERRIDE]=ha;}if(ia!==undefined){q(typeof ia==='string'||ia===null);ma[s.LAST_CHANGE_TYPE]=ia;}if(ja!==undefined){q(typeof ja==='string'||ja===null);ma[s.NATIVELY_RENDERED_KEY]=ja;}if(ka!==undefined){q(ka instanceof o);ma[s.SELECTION]=ka;}if(la!==undefined){q(la instanceof l);ma[s.STACK]=la;}return ma;}function v(z,aa){return m.map(z.getBlockMap(),function(ba){return g.generate(ba,aa);});}function w(z,aa,ba){var ca=z.getBlockMap();return m.map(m.filter(aa.getBlockMap(),function(da,ea){return da!==m.get(ca,ea);}),function(da){return g.generate(da,ba);});}function x(z,aa){var ba=z.getLastChangeType();return (aa!==ba||(aa!==k.INSERT_CHARACTERS&&aa!==k.BACKSPACE_CHARACTER&&aa!==k.DELETE_CHARACTER));}function y(z,aa){var ba=aa.getStartKey(),ca=aa.getStartOffset();if(ca>0){var da=z.getBlockForKey(ba),ea=da.getText(),fa=ca;if(ea.length===ca)fa--;return da.getInlineStyles()[fa];}var ga=z.getBlockBefore(ba),ha;while(ga){ha=ga.getLength();if(ha)return ga.getInlineStyles()[ha-1];ga=z.getBlockBefore(ga.getKey());}return h.NONE;}e.exports=t;},null);
__d("createInitialEditorState",["EditorState","ImmutableMap","createEmptySelectionState","generateContentStateKey"],function(a,b,c,d,e,f,g,h,i,j){"use strict";function k(l,m){var n=h.fromArray([l],function(){return j();}),o=h.keyAtIndex(n,0),p=l.getBlockMap(),q=h.keyAtIndex(p,0);return g.create({stack:n,currentKey:o,boundaryKey:o,decorator:m,selection:i(q),forceSelection:false,lastChangeType:null,nativelyRenderedKey:null,inCompositionMode:false});}e.exports=k;},null);
__d("createPlainBlocksFromText",["ComposedBlockType","ComposedInlineStyle","ContentBlock","fillArray","generateBlockKey"],function(a,b,c,d,e,f,g,h,i,j,k){function l(m){return m.map(function(n){var o=n.length;return i.create({key:k(),text:n,type:g.UNSTYLED,inlineStyles:j(o,h.NONE),entities:j(o,null)});});}e.exports=l;},null);
__d("isSelectionAtLeafStartExperimental",[],function(a,b,c,d,e,f){"use strict";function g(h){var i=h.getSelection(),j=i.getAnchorKey(),k=h.getTreeMap()[j],l=i.getStartOffset(),m,n,o;for(var p=0;p<k.length;p++){m=k[p];if(l===m.start)return true;if(l<m.end){n=m.leaves;for(var q=0;q<n.length;q++){o=n[q].start;if(l===o)return true;if(l<o)return false;}}}return false;}e.exports=g;},null);
__d("DocumentRemovableWord",["TokenizeUtil"],function(a,b,c,d,e,f,g){var h=g.getPunctuation();h=h.replace("\'","").slice(1,-1);var i='\\s'+h,j='^('+'['+i+']*'+'[^'+i+']+'+'|['+i+']+'+')',k=new RegExp(j),l='('+'[^'+i+']+'+'['+i+']*'+'|['+i+']+'+')$',m=new RegExp(l);function n(p,q){var r=q?m.exec(p):k.exec(p);return r?r[0]:null;}var o={getBackward:function(p){return n(p,true);},getForward:function(p){return n(p,false);}};e.exports=o;},null);
__d("DocumentSelectionState",["mixInEventEmitter"],function(a,b,c,d,e,f,g){function h(i,j){"use strict";this.$DocumentSelectionState0=i;this.$DocumentSelectionState1=j;this.$DocumentSelectionState2=false;}h.prototype.update=function(i,j){"use strict";if(this.$DocumentSelectionState0!==i||this.$DocumentSelectionState1!==j){this.$DocumentSelectionState0=i;this.$DocumentSelectionState1=j;this.emit('update');}};h.prototype.constrainLength=function(i){"use strict";this.update(Math.min(this.$DocumentSelectionState0,i),Math.min(this.$DocumentSelectionState1,i));};h.prototype.focus=function(){"use strict";if(!this.$DocumentSelectionState2){this.$DocumentSelectionState2=true;this.emit('focus');}};h.prototype.blur=function(){"use strict";if(this.$DocumentSelectionState2){this.$DocumentSelectionState2=false;this.emit('blur');}};h.prototype.hasFocus=function(){"use strict";return this.$DocumentSelectionState2;};h.prototype.isCollapsed=function(){"use strict";return this.$DocumentSelectionState0===this.$DocumentSelectionState1;};h.prototype.isBackward=function(){"use strict";return this.$DocumentSelectionState0>this.$DocumentSelectionState1;};h.prototype.getAnchorOffset=function(){"use strict";return this.$DocumentSelectionState2?this.$DocumentSelectionState0:null;};h.prototype.getFocusOffset=function(){"use strict";return this.$DocumentSelectionState2?this.$DocumentSelectionState1:null;};h.prototype.getStartOffset=function(){"use strict";return (this.$DocumentSelectionState2?Math.min(this.$DocumentSelectionState0,this.$DocumentSelectionState1):null);};h.prototype.getEndOffset=function(){"use strict";return (this.$DocumentSelectionState2?Math.max(this.$DocumentSelectionState0,this.$DocumentSelectionState1):null);};h.prototype.overlaps=function(i,j){"use strict";return (this.hasFocus()&&this.getStartOffset()<=j&&i<=this.getEndOffset());};g(h,{blur:true,focus:true,update:true});e.exports=h;},null);
__d("getSelectionOffsetKeyForNode",[],function(a,b,c,d,e,f){function g(h){return h.getAttribute&&h.getAttribute('data-offset-key');}e.exports=g;},null);
__d("findAncestorOffsetKey",["getSelectionOffsetKeyForNode"],function(a,b,c,d,e,f,g){function h(i){while(i&&i!==document.documentElement){var j=g(i);if(j!=null)return j;i=i.parentNode;}return null;}e.exports=h;},null);
__d("getDocumentSelectionExperimental",["DocumentOffsetKey","ImmutableMap","SelectionState","findAncestorOffsetKey","getSelectionOffsetKeyForNode","invariant"],function(a,b,c,d,e,f,g,h,i,j,k,l){function m(r,s){var t=a.getSelection();if(t.rangeCount===0)return {selectionState:i.set(r.getSelection(),{hasFocus:false}),needsRecovery:false};var u=t.anchorNode,v=t.focusNode,w=t.anchorOffset,x=t.focusOffset,y=u.nodeType===Node.TEXT_NODE,z=v.nodeType===Node.TEXT_NODE;if(y&&z)return {selectionState:q(r,j(u),w,j(v),x),needsRecovery:false};var aa=null,ba=null;if(y){aa={key:j(u),offset:w};ba=p(s,v,x);}else if(z){ba={key:j(v),offset:x};aa=p(s,u,w);}else{aa=p(s,u,w);ba=p(s,v,x);}return {selectionState:q(r,aa.key,aa.offset,ba.key,ba.offset),needsRecovery:true};}function n(r){while(r.firstChild&&k(r.firstChild))r=r.firstChild;return r;}function o(r){while(r.lastChild&&k(r.lastChild))r=r.lastChild;return r;}function p(r,s,t){var u=j(s);l(u!=null||r===s);if(t===0)return {key:u||k(n(s)),offset:0};var v=s.childNodes[t-1],w,x;if(!k(v)){w=u;x=v.textContent.length;}else{var y=o(v);w=k(y);x=y.textContent.length;}return {key:w,offset:x};}function q(r,s,t,u,v){var w=r.getSelection(),x=r.getTreeMap(),y=g.decode(s),z=y.blockKey,aa=x[z],ba=aa[y.decoratorKey].leaves,ca=ba[y.leafKey],da=g.decode(u),ea=da.blockKey,fa=x[ea],ga=fa[da.decoratorKey].leaves,ha=ga[da.leafKey],ia=ca?ca.start+t:null,ja=ha?ha.start+v:null,ka=(w.getAnchorKey()===z&&w.getAnchorOffset()===ia&&w.getFocusKey()===ea&&w.getFocusOffset()===ja);if(ka)return w;var la=false;if(z===ea){if(ha===ca){la=v<t;}else la=ha.start<ca.start;}else{var ma=h.indexOfKey(x,z),na=h.indexOfKey(x,ea);la=na<ma;}return i.set(w,{anchorKey:z,anchorOffset:ia,focusKey:ea,focusOffset:ja,isBackward:la});}e.exports=m;},null);
__d("setDocumentSelectionExperimental",[],function(a,b,c,d,e,f){"use strict";function g(j,k,l,m,n){var o=a.getSelection(),p=j.getAnchorKey(),q=j.getAnchorOffset(),r=j.getFocusKey(),s=j.getFocusOffset();if(!o.extend&&j.isBackward()){var t=p,u=q;p=r;q=s;r=t;s=u;}var v=(p===l&&m<=q&&n>=q),w=(r===l&&m<=s&&n>=s);if(v&&w){o.removeAllRanges();i(o,k,q-m);h(o,k,s-m);return;}if(!j.isBackward()){if(v){o.removeAllRanges();i(o,k,q-m);}if(w)h(o,k,s-m);}else{if(w){o.removeAllRanges();i(o,k,s-m);}if(v){var x=o.focusNode,y=o.focusOffset;o.removeAllRanges();i(o,k,q-m);h(o,x,y);}}}function h(j,k,l){if(j.extend){j.extend(k,l);}else{var m=j.getRangeAt(0);m.setEnd(k,l);j.addRange(m.cloneRange());}}function i(j,k,l){var m=document.createRange();m.setStart(k,l);j.addRange(m);}e.exports=g;},null);
__d("getContentStateFragment",["ContentBlock","ImmutableMap","generateBlockKey","removeEntitiesAtEdges"],function(a,b,c,d,e,f,g,h,i,j){"use strict";function k(l,m){var n=m.getStartKey(),o=m.getStartOffset(),p=m.getEndKey(),q=m.getEndOffset(),r=j(l,m),s=r.getBlockMap();return h.mapKeyRange(s,function(t,u){var v=i(),w=t.getText(),x=t.getInlineStyles(),y=t.getEntities();if(n===p)return g.set(t,{key:v,text:w.slice(o,q),inlineStyles:x.slice(o,q),entities:y.slice(o,q)});if(u===n)return g.set(t,{key:v,text:w.slice(o),inlineStyles:x.slice(o),entities:y.slice(o)});if(u===p)return g.set(t,{key:v,text:w.slice(0,q),inlineStyles:x.slice(0,q),entities:y.slice(0,q)});return g.set(t,{key:v});},n,p);}e.exports=k;},null);
__d("DocumentIterator",["DocumentCharacters"],function(a,b,c,d,e,f,g){var h=g.BLOCK_DELIMITER;function i(j,k){"use strict";this.$DocumentIterator0=j;this.$DocumentIterator1=k;}i.prototype.process=function(j,k,l){"use strict";this.$DocumentIterator2=j;this.$DocumentIterator3=k;this.$DocumentIterator4=l;this.$DocumentIterator5=this.$DocumentIterator0.getText();this.$DocumentIterator6=this.$DocumentIterator0.getInlineStyles();this.$DocumentIterator7=this.$DocumentIterator1.getDecorations(this.$DocumentIterator0);this.$DocumentIterator8();};i.prototype.$DocumentIterator8=function(){"use strict";var j=this.$DocumentIterator5.split(h),k=0,l;for(var m=0;m<j.length;m++){l=k+j[m].length;this.$DocumentIterator9(k,l);k=l+h.length;}};i.prototype.$DocumentIterator9=function(j,k){"use strict";this.$DocumentIterator2.call(null,j,k);this.$DocumentIteratora(this.$DocumentIterator7,j,k,this.$DocumentIteratorb.bind(this));};i.prototype.$DocumentIteratorb=function(j,k,l){"use strict";this.$DocumentIterator3.call(null,j,k,l);this.$DocumentIteratora(this.$DocumentIterator6,j,k,this.$DocumentIteratorc.bind(this));};i.prototype.$DocumentIteratorc=function(j,k,l){"use strict";this.$DocumentIterator4.call(null,j,k,l);};i.prototype.$DocumentIteratora=function(j,k,l,m){"use strict";var n=k;for(var o=k;o<l;o++)if(j[o]!==j[o+1]){m(n,o+1,j[n]);n=o+1;}if(k===l){m(k,l,null);}else if(n!==l)m(n,l,j[n]);};e.exports=i;},null);
__d("DocumentOffsetCache",[],function(a,b,c,d,e,f){function g(i){return i<0?0:i;}function h(){"use strict";this.reset();}h.prototype.reset=function(){"use strict";this.$DocumentOffsetCache0=-1;this.$DocumentOffsetCache1=-1;this.$DocumentOffsetCache2=-1;this.$DocumentOffsetCache3={};};h.prototype.nextBlock=function(i){"use strict";this.$DocumentOffsetCache0++;this.$DocumentOffsetCache1=-1;this.$DocumentOffsetCache2=-1;this.$DocumentOffsetCache4(i);};h.prototype.nextDecoration=function(i){"use strict";this.$DocumentOffsetCache1++;this.$DocumentOffsetCache2=-1;this.$DocumentOffsetCache4(i);};h.prototype.nextLeaf=function(i){"use strict";this.$DocumentOffsetCache2++;this.$DocumentOffsetCache4(i);};h.prototype.getCurrentKey=function(){"use strict";return (g(this.$DocumentOffsetCache0)+'.'+g(this.$DocumentOffsetCache1)+'.'+g(this.$DocumentOffsetCache2));};h.prototype.getOffset=function(i){"use strict";return this.$DocumentOffsetCache3[i];};h.prototype.getKey=function(i){"use strict";var j=null,k=null;for(var l in this.$DocumentOffsetCache3){var m=this.$DocumentOffsetCache3[l],n=i-m;if(n<0){continue;}else if(n===0){return l;}else if(n<j||j===null){j=n;k=l;}}return k;};h.prototype.$DocumentOffsetCache4=function(i){"use strict";this.$DocumentOffsetCache3[this.getCurrentKey()]=i;};e.exports=h;},null);
__d("DocumentView",["DocumentIterator","DocumentOffsetCache","UnicodeBidi","createArrayFrom","emptyFunction"],function(a,b,c,d,e,f,g,h,i,j,k){function l(m,n){"use strict";this.$DocumentView0=m;this.$DocumentView1=n;this.$DocumentView2=[];this.$DocumentView3=null;this.$DocumentView4=[];this.$DocumentView5=new g(this.$DocumentView0,this.$DocumentView1);this.$DocumentView6=new h(this.$DocumentView5);}l.prototype.getContent=function(){"use strict";return this.$DocumentView0;};l.prototype.getText=function(){"use strict";return this.$DocumentView0.getText();};l.prototype.getEntities=function(){"use strict";return this.$DocumentView0.getEntities();};l.prototype.getFragment=function(m,n){"use strict";return this.$DocumentView0.getFragment(m,n);};l.prototype.getVersion=function(){"use strict";return this.$DocumentView0.getVersion();};l.prototype.getBlockDirections=function(){"use strict";this.$DocumentView7();return this.$DocumentView4;};l.prototype.getFingerprint=function(){"use strict";this.$DocumentView7();return this.$DocumentView2.join(':');};l.prototype.getOffset=function(m){"use strict";this.$DocumentView7();return this.$DocumentView6.getOffset(m);};l.prototype.getKey=function(m){"use strict";this.$DocumentView7();return this.$DocumentView6.getKey(m);};l.prototype.iterate=function(m,n,o){"use strict";this.$DocumentView3=this.getVersion();this.$DocumentView2.length=0;this.$DocumentView4.length=0;this.$DocumentView6.reset();var p=this.$DocumentView6,q=this.$DocumentView1,r=0,s=this.$DocumentView0.getBlockStyles(),t=this.$DocumentView8.bind(this),u=this.$DocumentView9.bind(this);function v(y,z){p.nextBlock(y);u(y,z);m(p.getCurrentKey(),y,z,s[r++]);}function w(y,z,aa){var ba=null;p.nextDecoration(y);if(aa!==null){t("D",aa,z-y);ba=q.getComponentForKey(aa);}n(p.getCurrentKey(),y,z,ba);}function x(y,z,aa){p.nextLeaf(y);t("L",aa);o(p.getCurrentKey(),y,z,aa);}this.$DocumentView5.process(v,w,x);};l.prototype.$DocumentView7=function(){"use strict";if(this.$DocumentView3!==this.getVersion())this.iterate(k,k,k);};l.prototype.$DocumentView8=function(){"use strict";this.$DocumentView2.push(j(arguments).join('-'));};l.prototype.$DocumentView9=function(m,n){"use strict";var o=this.$DocumentView0.getText().slice(m,n),p=this.$DocumentView4,q=i.getDirection(o,p[p.length-1]);this.$DocumentView4.push(q);};e.exports=l;},null);
__d("OrderedMap",["invariant","mixInto"],function(a,b,c,d,e,f,g,h){"use strict";var i='key:';function j(q,r){var s={};for(var t=0;t<q.length;t++){var u=q[t],v=r(u);l(v);var w=i+v;g(!(w in s));s[w]=u;}return s;}function k(q,r){this._normalizedObj=q;this._computedPositions=null;this.length=r;}function l(q){g(q!==''&&(typeof q==='string'||typeof q==='number'));}function m(q,r,s){g(typeof q==='number'&&typeof r==='number'&&r>=0&&q>=0&&q+r<=s);}function n(q,r){g(q&&q.constructor===Object&&(!r||r.constructor===Object));var s={},t=0,u;for(u in q)if(q.hasOwnProperty(u)){s[u]=q[u];t++;}for(u in r)if(r.hasOwnProperty(u)){if(!(u in s))t++;s[u]=r[u];}return new k(s,t);}var o={has:function(q){l(q);var r=i+q;return r in this._normalizedObj;},get:function(q){l(q);var r=i+q;return this.has(q)?this._normalizedObj[r]:undefined;},merge:function(q){g(q instanceof k);return n(this._normalizedObj,q._normalizedObj);},map:function(q,r){return this.mapRange(q,0,this.length,r);},mapRange:function(q,r,s,t){var u=this._normalizedObj,v={},w=0;m(r,s,this.length);var x=r+s-1;for(var y in u)if(u.hasOwnProperty(y)){if(w>=r){if(w>x)break;var z=u[y];v[y]=q.call(t,z,y.substr(i.length),w);}w++;}return new k(v,s);},filter:function(q,r){return this.filterRange(q,0,this.length,r);},filterRange:function(q,r,s,t){var u={},v=0;this.forEachRange(function(w,x,y){if(q.call(t,w,x,y)){var z=i+x;u[z]=w;v++;}},r,s);return new k(u,v);},forEach:function(q,r){this.forEachRange(q,0,this.length,r);},forEachRange:function(q,r,s,t){m(r,s,this.length);var u=this._normalizedObj,v=0,w=r+s-1;for(var x in u)if(u.hasOwnProperty(x)){if(v>=r){if(v>w)break;var y=u[x];q.call(t,y,x.substr(i.length),v);}v++;}},mapKeyRange:function(q,r,s,t){var u=this.indexOfKey(r),v=this.indexOfKey(s);g(u!==undefined&&v!==undefined);g(v>=u);return this.mapRange(q,u,(v-u)+1,t);},forEachKeyRange:function(q,r,s,t){var u=this.indexOfKey(r),v=this.indexOfKey(s);g(u!==undefined&&v!==undefined);g(v>=u);this.forEachRange(q,u,(v-u)+1,t);},keyAtIndex:function(q){var r=this._getOrComputePositions(),s=r.keyByIndex[q];return s?s.substr(i.length):undefined;},keyAfter:function(q){return this.nthKeyAfter(q,1);},keyBefore:function(q){return this.nthKeyBefore(q,1);},nthKeyAfter:function(q,r){var s=this.indexOfKey(q);g(s!==undefined);return this.keyAtIndex(s+r);},nthKeyBefore:function(q,r){return this.nthKeyAfter(q,-r);},indexOfKey:function(q){l(q);var r=i+q,s=this._getOrComputePositions(),t=s.indexByKey[r];return t===undefined?undefined:t;},toArray:function(){var q=[],r=this._normalizedObj;for(var s in r)if(r.hasOwnProperty(s))q.push(r[s]);return q;},_getOrComputePositions:function(){var q=this._computedPositions;if(!q)this._computePositions();return this._computedPositions;},_computePositions:function(){this._computedPositions={keyByIndex:{},indexByKey:{}};var q=this._computedPositions.keyByIndex,r=this._computedPositions.indexByKey,s=0,t=this._normalizedObj;for(var u in t)if(t.hasOwnProperty(u)){q[s]=u;r[u]=s;s++;}}};h(k,o);var p={from:function(q){g(q instanceof k);return n(q._normalizedObj,null);},fromArray:function(q,r){g(Array.isArray(q));g(typeof r==='function');return new k(j(q,r),q.length);}};e.exports=p;},null);
__d("AbstractTextEditorPlaceholder.Experimental.react",["EditorState","React","cx"],function(a,b,c,d,e,f,g,h,i){var j=h.PropTypes,k=h.createClass({displayName:'AbstractTextEditorPlaceholder',propTypes:{editorState:j.instanceOf(g).isRequired,text:j.string.isRequired},shouldComponentUpdate:function(l,m){if(this.props.text!==l.text)return true;var n=this.props.editorState,o=l.editorState,p=n.getSelection(),q=o.getSelection();return (p.hasFocus()!==q.hasFocus());},render:function(){var l=this.props.editorState.getSelection().hasFocus(),m=(("_5ywb")+(l?' '+"_5ywc":''));return (h.createElement(h.DOM.div,{className:m},this.props.text));}});e.exports=k;},null);
__d("AbstractTextEditorProps",["DocumentSelectionState","DocumentView","ReactPropTypes"],function(a,b,c,d,e,f,g,h,i){var j={propTypes:{documentView:i.instanceOf(h).isRequired,selectionState:i.instanceOf(g).isRequired,placeholder:i.string,blockStyleFn:i.func.isRequired,inlineStyleFn:i.func.isRequired,keyBindingFn:i.func.isRequired,spellCheck:i.bool,onReturn:i.func.isRequired,onEscape:i.func,onTab:i.func,onUpArrow:i.func,onDownArrow:i.func,onCharacters:i.func.isRequired,onAlter:i.func.isRequired,onCut:i.func.isRequired,onPasteFragment:i.func.isRequired,onPasteFiles:i.func,onDelete:i.func.isRequired,onDropSelection:i.func.isRequired,onDropText:i.func.isRequired,onDropFiles:i.func,onSelect:i.func.isRequired,onBlur:i.func.isRequired,onFocus:i.func.isRequired,disabled:i.bool},getDefaultProps:function(){return {spellCheck:false,disabled:false};}};e.exports=j;},null);
__d("ElementForBlockType",["ComposedBlockType","React"],function(a,b,c,d,e,f,g,h){var i={getElement:function(j){switch(j){case g.HEADER_ONE:return h.DOM.h2;case g.HEADER_TWO:return h.DOM.h3;case g.UNORDERED_LIST_ITEM:case g.ORDERED_LIST_ITEM:return h.DOM.li;case g.BLOCKQUOTE:return h.DOM.blockquote;case g.MEDIA:return h.DOM.figure;default:return h.DOM.div;}},getWrapperElement:function(j){switch(j){case g.UNORDERED_LIST_ITEM:return h.DOM.ul;case g.ORDERED_LIST_ITEM:return h.DOM.ol;case g.CODE:return h.DOM.pre;default:return null;}}};e.exports=i;},null);
__d("TextEditorTextNode.react",["DOMPropertyOperations","ReactBrowserComponentMixin","ReactComponent","ReactDescriptor","UserAgent_DEPRECATED","escapeTextForBrowser","getTextContentAccessor","mixInto"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){"use strict";var o=k.ie()<=11,p=i.BackendIDOperations,q=m();function r(z){return o?z[q]==='\n':z.tagName==='BR';}function s(z){p.dangerouslyReplaceNodeWithMarkupByID(z,o?v(z):u(z));}function t(z,aa){if(o){p.updateTextContentByID(z,aa);}else p.dangerouslyReplaceNodeWithMarkupByID(z,w(z,aa));}function u(z){return '<br '+g.createMarkupForID(z)+' />';}function v(z){return w(z,'\n');}function w(z,aa){return ('<span '+g.createMarkupForID(z)+'>'+l(aa)+'</span>');}var x=function(z){};n(x,i.Mixin);n(x,h);n(x,{mountComponent:function(z,aa,ba){i.Mixin.mountComponent.call(this,z,aa,ba);if(this.props==='')return (o?v(z):u(z));return w(z,this.props);},receiveComponent:function(z,aa){var ba=this._rootNodeID,ca=z.props,da=this.getDOMNode();if(r(da)){if(ca!==''){this.props=ca;t(ba,ca);}return;}if(ca===''){this.props=ca;s(ba);return;}var ea=this.getDOMNode()[q];if(ca!==ea)p.updateTextContentByID(ba,ca);},type:x});var y=function(z){return new j(x,null,null,null,null,z);};y.type=x;e.exports=y;},null);
__d("TextEditorLeaf.Experimental.react",["DocumentCharacters","React","SelectionState","TextEditorTextNode.react","endsWith","setDocumentSelectionExperimental"],function(a,b,c,d,e,f,g,h,i,j,k,l){"use strict";var m=h.PropTypes,n=g.SOFT_NEWLINE,o=3,p=h.createClass({displayName:'TextEditorLeaf',propTypes:{selection:m.instanceOf(i),start:m.number.isRequired,blockKey:m.string.isRequired,text:m.string.isRequired,style:m.number,inlineStyleFn:m.func.isRequired,isLast:m.bool.isRequired},_setSelection:function(){var q=this.props.selection;if(q==null||!q.hasFocus())return;var r=this.props.start,s=r+this.props.text.length,t=this.props.blockKey;if(!q.hasEdgeWithin(t,r,s))return;var u=this.getDOMNode(),v=u.firstChild,w;if(v.nodeType===o){w=v;}else if(v.tagName==='BR'){w=u;}else w=v.firstChild;l(q,w,t,r,s);},shouldComponentUpdate:function(q){return (this.refs.leaf.getDOMNode().textContent!==q.text||q.forceSelection);},componentDidUpdate:function(){this._setSelection();},componentDidMount:function(){this._setSelection();},render:function(){var q=this.props.text;if(k(q,n)&&this.props.isLast)q+=n;var r;if(this.props.style)r=this.props.inlineStyleFn(this.props.style);return (h.createElement(h.DOM.span,{'data-offset-key':this.props.offsetKey,className:r,ref:"leaf"},j(q)));}});e.exports=p;},null);
__d("TextEditorBlock.Experimental.react",["ContentBlock","DocumentCompositeDecorator.Experimental","DocumentOffsetKey","React","SelectionState","TextEditorLeaf.Experimental.react","UnicodeBidiDirection","cx","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){var p=j.PropTypes,q=m.LTR,r=m.RTL,s=j.createClass({displayName:'TextEditorBlock',propTypes:{block:p.instanceOf(g).isRequired,tree:p.array.isRequired,selection:p.instanceOf(k).isRequired,decorator:p.instanceOf(h),forceSelection:p.bool.isRequired,direction:p.string.isRequired,blockPropTypes:p.object,blockStyleFn:p.func.isRequired,inlineStyleFn:p.func.isRequired},shouldComponentUpdate:function(u){return (this.props.block!==u.block||this.props.tree!==u.tree||this.props.direction!==u.direction||(t(u.selection,u.block.getKey())&&u.forceSelection));},_renderChildren:function(){var u=this.props.block,v=u.getKey(),w=u.getText(),x=u.getInlineStyles(),y=this.props.tree.length-1,z=t(this.props.selection,v);return this.props.tree.map(function(aa,ba){var ca=aa.leaves.map(function(ga,ha){var ia=i.encode(v,ba,ha);return (j.createElement(l,{key:ia,offsetKey:ia,blockKey:v,start:ga.start,selection:z?this.props.selection:null,forceSelection:this.props.forceSelection,text:w.slice(ga.start,ga.end),style:x[ga.start],inlineStyleFn:this.props.inlineStyleFn,isLast:ba===y}));}.bind(this));if(aa.decoratorKey===null)return ca;var da=this.props.decorator.getComponentForKey(aa.decoratorKey),ea=this.props.decorator.getPropsForKey(aa.decoratorKey),fa=i.encode(v,ba,0);return (j.createElement(da,Object.assign({},ea,{key:fa,offsetKey:fa}),ca));}.bind(this));},render:function(){var u=this.props.block,v=u.getKey(),w=o(this.props.blockStyleFn(u.getType()),((this.props.direction===q?"_2vxa":'')+(this.props.direction===r?' '+"_2vxb":'')));return (j.createElement(j.DOM.div,Object.assign({style:{position:'relative'},'data-offset-key':i.encode(v,0,0),className:w},this.props.blockProps),this._renderChildren()));}});function t(u,v){return (u.getAnchorKey()===v||u.getFocusKey()===v);}e.exports=s;},null);
__d("TextEditorCompositionHandler.Experimental",["ComposedInlineStyle","DocumentModifierExperimental","EditorChangeType","EditorState","Keys","isSelectionAtLeafStartExperimental"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m=g.NONE,n={onBeforeInput:function(o){this._textInputData=(this._textInputData||'')+o.data;},onCompositionStart:function(){this._stillComposing=true;},onCompositionEnd:function(o){this._stillComposing=false;setTimeout(n.resolveComposition.bind(this),0);},onKeyDown:function(o){if(o.which===k.RIGHT||o.which===k.LEFT)o.preventDefault();},onKeyPress:function(o){if(o.which===k.RETURN)o.preventDefault();},resolveComposition:function(){if(this._stillComposing)return;var o=this._textInputData;this._textInputData='';var p=j.set(this.props.editorState,{inCompositionMode:false}),q=!o||l(p);if(q)this.restoreEditorDOM();this.exitCurrentMode();this.removeRenderGuard();if(o){var r=h.replaceText(p.getCurrentContent(),p.getSelection(),o,m,null);this.update(j.push(p,r,i.INSERT_CHARACTERS));return;}if(q)this.update(j.set(p,{nativelyRenderedKey:null,forceSelection:true}));}};e.exports=n;},null);
__d("TextEditorModes",[],function(a,b,c,d,e,f){var g={EDIT:0,COMPOSITE:1,DRAG:2,RENDER:3,CUT:4};e.exports=g;},null);
__d("getSafeBodyFromHTML",[],function(a,b,c,d,e,f){function g(h){var i,j=null;if(document.implementation&&document.implementation.createHTMLDocument){i=document.implementation.createHTMLDocument('foo');i.documentElement.innerHTML=h;j=i.getElementsByTagName('body')[0];}return j;}e.exports=g;},null);
__d("TextEditorPasteHandler",["ComposedBlockType","ComposedInlineStyle","ContentBlock","DocumentCharacters","arrayContains","fillArray","generateBlockKey","getSafeBodyFromHTML"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o=h.BOLD,p=h.ITALIC,q=h.UNDERLINE,r=h.NONE,s=j.BLOCK_DELIMITER,t='&nbsp;',u=j.SOFT_NEWLINE,v=' ',w=g.UNSTYLED,x=['p','h1','h2','h3','li','blockquote'],y={strong:o,b:o,em:p,i:p,u:q};function z(){return {text:'',inlines:[],blocks:[]};}function aa(){return {text:v,inlines:[r],blocks:[]};}function ba(){return {text:u,inlines:[r],blocks:[]};}function ca(ka){return {text:s,inlines:[r],blocks:[ka]};}function da(ka,la){switch(ka){case 'h1':return g.HEADER_ONE;case 'h2':return g.HEADER_TWO;case 'li':if(la==='ol')return g.ORDERED_LIST_ITEM;return g.UNORDERED_LIST_ITEM;case 'blockquote':return g.BLOCKQUOTE;case 'pre':return g.CODE;default:return g.UNSTYLED;}}function ea(ka,la,ma){var na=y[ka];if(na){ma|=na;}else if(la.style){ma|=la.style.fontWeight==='bold'?o:0;ma|=la.style.fontStyle==='italic'?p:0;ma|=la.style.textDecoration==='underline'?q:0;}return ma;}function fa(ka,la){if(ka.text.slice(-1)===s&&la.text.slice(0,1)===s){ka.text=ka.text.slice(0,-1);ka.inlines.pop();ka.blocks.pop();}if(ka.text.slice(-1)===s&&(la.text===v||la.text===u))return ka;return {text:ka.text+la.text,inlines:ka.inlines.concat(la.inlines),blocks:ka.blocks.concat(la.blocks)};}function ga(ka){return x.some(function(la){return ka.indexOf('<'+la)!==-1;});}function ha(ka,la,ma,na,oa){var pa=ka.nodeName.toLowerCase(),qa=false;if(pa==="#text"){var ra=ka.textContent;if(ra.trim()==='')return aa();return {text:ra,inlines:l(ra.length,la),blocks:[]};}if(pa==="br")return ba();var sa=z(),ta;la=ea(pa,ka,la);if(pa==="ul"||pa==="ol")ma=pa;if(!na&&k(oa,pa)){sa=ca(da(pa,ma));na=true;qa=true;}ka=ka.firstChild;while(ka){ta=ha(ka,la,ma,na,oa);sa=fa(sa,ta);ka=ka.nextSibling;}if(qa)sa=fa(sa,ca(w));return sa;}function ia(ka){ka=ka.trim().replace(s,'').replace(u,v).replace(t,v);var la=n(ka);if(!la)return null;var ma=ga(ka)?x:['div'],na=ha(la,0,'ul',false,ma);if(na.text.indexOf(s)===0)na={text:na.text.slice(1),inlines:na.inlines.slice(1),blocks:na.blocks};if(na.text.slice(-1)===s){na.text=na.text.slice(0,-1);na.inlines=na.inlines.slice(0,-1);na.blocks.pop();}if(na.blocks.length===0)na.blocks.push(w);if(na.text.split(s).length===na.blocks.length+1)na.blocks.unshift(w);return na;}var ja={processHTML:function(ka){return ia(ka);},processHTMLAsImmutable:function(ka){var la=ia(ka);if(!la)return null;var ma=0;return la.text.split(s).map(function(na,oa){var pa=ma+na.length,qa=i.create({key:m(),type:la.blocks[oa],text:na,inlineStyles:la.inlines.slice(ma,pa),entities:l(na.length,null)});ma=pa+1;return qa;});},processText:function(ka){return {text:ka,inlines:l(ka.length,r),blocks:l(ka.split(s).length,w)};},processTextAsImmutable:function(ka){return ka.map(function(la){return i.create({key:m(),type:w,text:la,inlineStyles:l(la.length,r),entities:l(la.length,null)});});}};e.exports=ja;},null);
__d("TextEditorEditHandler.Experimental",["BlockTree","ContentState","DataTransfer","DocumentCharacters","DocumentCommands","DocumentModifierExperimental","DocumentOffsetKey","DocumentRemovableWord","DocumentRemovalDirection","EditorChangeType","EditorState","ImmutableMap","Keys","SelectionState","TextEditorModes","TextEditorPasteHandler","UnicodeUtils","UserAgent_DEPRECATED","areEqual","findAncestorOffsetKey","getActiveElement","getContentStateFragment","getDocumentSelectionExperimental","isSelectionAtLeafStartExperimental"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da){"use strict";var ea=j.SOFT_NEWLINE,fa={onFocus:function(fb){var gb=this.props.editorState,hb=gb.getSelection();if(hb.hasFocus())return;var ib=t.set(hb,{hasFocus:true});this.props.onFocus&&this.props.onFocus(fb);this.update(q.updateSelection(gb,ib,false));},onBlur:function(fb){if(a.getSelection&&aa()===document.body)a.getSelection().removeAllRanges();var gb=this.props.editorState,hb=gb.getSelection();if(!hb.hasFocus())return;var ib=t.set(hb,{hasFocus:false});this.props.onBlur&&this.props.onBlur(fb);this.update(q.updateSelection(gb,ib,false));},onBeforeInput:function(fb){var gb=fb.data;if(!gb)return;var hb=this.props.editorState,ib=hb.getSelection();if(!ib.isCollapsed()){fb.preventDefault();this.update(ja(hb,gb,hb.getCurrentInlineStyle(),null));return;}var jb=!da(hb),kb=ja(hb,gb,hb.getCurrentInlineStyle(),null);if(!jb){fb.preventDefault();this.update(kb);return;}var lb=ib.getAnchorKey(),mb=r.get(hb.getTreeMap(),lb),nb=g.getFingerprint(mb),ob=g.getFingerprint(r.get(kb.getTreeMap(),lb));if(eb(gb)||nb!==ob){fb.preventDefault();}else kb=q.set(kb,{nativelyRenderedKey:kb.getCurrentKey()});this.update(kb);},onSelect:function(fb){var gb=this.props.editorState,hb=ca(gb,this.refs.editorContainer.getDOMNode().firstChild),ib=hb.selectionState;if(ib!==gb.getSelection())this.update(q.updateSelection(gb,ib,!!hb.needsRecovery));},onKeyDown:function(fb){var gb=fb.which,hb=this.props.editorState;switch(gb){case s.RETURN:fb.preventDefault();if(!this.props.handleReturn||!this.props.handleReturn(fb))this.update(ta(hb));return;case s.ESC:fb.preventDefault();this.props.onEscape&&this.props.onEscape(fb);return;case s.TAB:this.props.onTab&&this.props.onTab(fb);return;case s.UP:this.props.onUpArrow&&this.props.onUpArrow(fb);return;case s.DOWN:this.props.onDownArrow&&this.props.onDownArrow(fb);return;}var ib=this.props.keyBindingFn(fb);if(!ib)return;fb.preventDefault();if(this.props.handleKeyCommand&&this.props.handleKeyCommand(ib))return;if(ib===k.UNDO){ha(hb,this.update);return;}var jb=ga(ib,hb);if(jb!==hb)this.update(jb);},onCharacterData:function(fb){var gb=z(fb),hb=this.props.editorState,ib=hb.getSelection(),jb=hb.getCurrentContent(),kb=hb.getTreeMap(),lb=m.decode(gb),mb=lb.blockKey,nb=r.get(kb,mb),ob=nb[lb.decoratorKey].leaves[lb.leafKey],pb=jb.getBlockForKey(mb);if(pb.getText().slice(ob.start,ob.end)===fb.textContent)return;var qb=t.set(hb.getSelection(),{anchorOffset:ob.start,focusOffset:ob.end,isBackward:false}),rb=l.replaceText(jb,qb,fb.textContent,pb.getInlineStyles()[ob.start],null),sb=ca(this.props.editorState,this.refs.editorContainer.getDOMNode().firstChild),tb=h.set(rb,{selectionBefore:ib,selectionAfter:sb.selectionState});this.update(q.push(hb,tb,p.INSERT_CHARACTERS));},onDragStart:function(fb){this._internalDrag=true;this.setMode(u.DRAG);},onDragOver:function(fb){this._internalDrag=false;this.setMode(u.DRAG);fb.preventDefault();},onCompositionStart:function(fb){this.setRenderGuard();this.captureEditorDOM();this.setMode(u.COMPOSITE);this.update(q.set(this.props.editorState,{inCompositionMode:true}));},onCut:function(fb){var gb=this.props.editorState,hb=gb.getSelection();if(hb.isCollapsed()){fb.preventDefault();return;}this.setRenderGuard();this.captureEditorDOM();ab(gb,function(ib){this._clipboard=ib;this.setMode(u.CUT);setTimeout(function(){this.restoreEditorDOM();this.removeRenderGuard();this.exitCurrentMode();this.update(za(gb));}.bind(this),0);}.bind(this));},onCopy:function(){ab(this.props.editorState,function(fb){this._clipboard=fb;}.bind(this));},onPaste:function(fb){fb.preventDefault();var gb=new i(fb.clipboardData);if(!gb.isRichText()){var hb=gb.getFiles();if(hb.length>0){this.props.onPasteFiles&&this.props.onPasteFiles(hb);return;}}var ib,jb=gb.getText();if(jb)ib=jb.split(ea);if(this._clipboard){var kb=ib.filter(xa),lb=r.toArray(r.map(this._clipboard,function(qb){return qb.getText();})).filter(xa),mb=y(kb,lb);if(mb){this.update(ya(this.props.editorState,this._clipboard));return;}}var nb=gb.getHTML();if(nb){var ob=v.processHTMLAsImmutable(nb);if(ob){this.update(ya(this.props.editorState,r.fromArray(ob,function(qb){return qb.getKey();})));return;}}this._clipboard=null;if(ib){var pb=v.processTextAsImmutable(ib);this.update(ya(this.props.editorState,r.fromArray(pb,function(qb){return qb.getKey();})));}}};function ga(fb,gb){switch(fb){case k.UNDO:return ha(gb);case k.REDO:return ia(gb);case k.DELETE:return la(gb);case k.DELETE_WORD:return ma(gb);case k.DELETE_TO_END_OF_BLOCK:return na(gb);case k.BACKSPACE:return oa(gb);case k.BACKSPACE_WORD:return ra(gb);case k.BACKSPACE_TO_END_OF_BLOCK:return sa(gb);case k.INSERT_BLOCK_DELIMITER:return ta(gb);case k.TRANSPOSE_CHARACTERS:return ua(gb);case k.MOVE_SELECTION_TO_START_OF_BLOCK:return va(gb);case k.MOVE_SELECTION_TO_END_OF_BLOCK:return wa(gb);default:return gb;}}function ha(fb,gb){var hb=q.undo(fb);if(!fb.getNativelyRenderedKey()){gb(hb);return;}gb(q.set(fb,{nativelyRenderedKey:null}));setTimeout(function(){gb(hb);});}function ia(fb){return q.redo(fb);}function ja(fb,gb,hb,ib){var jb=l.replaceText(fb.getCurrentContent(),fb.getSelection(),gb,hb,ib||null);return q.push(fb,jb,p.INSERT_CHARACTERS);}function ka(fb,gb,hb){var ib=fb.getSelection(),jb=fb.getCurrentContent(),kb=ib;if(ib.isCollapsed()){if(hb===o.FORWARD){if(fb.isAtDocumentEnd())return jb;}else if(fb.isAtDocumentStart())return jb;kb=gb(fb);if(kb===ib)return jb;}return l.removeRange(jb,kb,hb);}function la(fb){var gb=ka(fb,function(ib){var jb=ib.getSelection(),kb=ib.getCurrentContent(),lb=jb.getAnchorKey(),mb=jb.getAnchorOffset(),nb=kb.getBlockForKey(lb).getText()[mb];return qa(ib,nb?w.getUTF16Length(nb,0):1);},o.FORWARD);if(gb===fb.getCurrentContent())return fb;gb=h.set(gb,{selectionBefore:fb.getSelection()});var hb=fb.getSelection().isCollapsed()?p.DELETE_CHARACTER:p.REMOVE_RANGE;return q.push(fb,gb,hb);}function ma(fb){var gb=ka(fb,function(hb){var ib=hb.getSelection(),jb=ib.getStartOffset(),kb=ib.getStartKey(),lb=hb.getCurrentContent(),mb=lb.getBlockForKey(kb).getText().slice(jb),nb=n.getForward(mb)||'';return qa(hb,nb.length||1);},o.FORWARD);if(gb===fb.getCurrentContent())return fb;return q.push(fb,gb,p.REMOVE_RANGE);}function na(fb){var gb=ka(fb,function(hb){var ib=hb.getSelection(),jb=ib.getStartOffset(),kb=ib.getStartKey(),lb=hb.getCurrentContent(),mb=lb.getBlockForKey(kb).getText();if(jb===mb.length)return qa(hb,1);return t.set(ib,{focusOffset:mb.length});},o.FORWARD);if(gb===fb.getCurrentContent())return fb;return q.push(fb,gb,p.REMOVE_RANGE);}function oa(fb){var gb=ka(fb,function(ib){var jb=ib.getSelection(),kb=ib.getCurrentContent(),lb=jb.getAnchorKey(),mb=jb.getAnchorOffset(),nb=kb.getBlockForKey(lb).getText()[mb-1];return pa(ib,nb?w.getUTF16Length(nb,0):1);},o.BACKWARD);if(gb===fb.getCurrentContent())return fb;gb=h.set(gb,{selectionBefore:fb.getSelection()});var hb=fb.getSelection().isCollapsed()?p.BACKSPACE_CHARACTER:p.REMOVE_RANGE;return q.push(fb,gb,hb);}function pa(fb,gb){var hb=fb.getSelection(),ib=fb.getCurrentContent(),jb=hb.getStartKey(),kb=hb.getStartOffset(),lb=jb,mb;if(gb>kb){var nb=ib.getKeyBefore(jb);lb=nb;var ob=ib.getBlockForKey(nb);mb=ob.getText().length;}else mb=kb-gb;return t.set(hb,{focusKey:lb,focusOffset:mb,isBackward:true});}function qa(fb,gb){var hb=fb.getSelection(),ib=hb.getStartKey(),jb=hb.getStartOffset(),kb=fb.getCurrentContent(),lb=ib,mb,nb=kb.getBlockForKey(ib);if(gb>(nb.getText().length-jb)){lb=kb.getKeyAfter(ib);mb=0;}else mb=jb+gb;return t.set(hb,{focusKey:lb,focusOffset:mb});}function ra(fb){var gb=ka(fb,function(hb){var ib=hb.getSelection(),jb=ib.getStartOffset();if(jb===0)return pa(hb,1);var kb=ib.getStartKey(),lb=hb.getCurrentContent(),mb=lb.getBlockForKey(kb).getText().slice(0,jb),nb=n.getBackward(mb)||'';return pa(hb,nb.length||1);},o.BACKWARD);if(gb===fb.getCurrentContent())return fb;return q.push(fb,gb,p.REMOVE_RANGE);}function sa(fb){var gb=ka(fb,function(hb){var ib=hb.getSelection();if(ib.getStartOffset()===0)return pa(hb,1);return t.set(ib,{focusOffset:0,isBackward:true});},o.BACKWARD);if(gb===fb.getCurrentContent())return fb;return q.push(fb,gb,p.REMOVE_RANGE);}function ta(fb){var gb=l.splitBlock(fb.getCurrentContent(),fb.getSelection());return q.push(fb,gb,p.SPLIT_BLOCK);}function ua(fb){return fb;}function va(fb){var gb=fb.getSelection(),hb=gb.getStartKey(),ib=t.set(gb,{anchorKey:hb,anchorOffset:0,focusKey:hb,focusOffset:0,isBackward:false});return q.set(fb,{selection:ib,forceSelection:true});}function wa(fb){var gb=fb.getSelection(),hb=gb.getEndKey(),ib=fb.getCurrentContent(),jb=ib.getBlockForKey(hb),kb=jb.getText().length,lb=t.set(gb,{anchorKey:hb,anchorOffset:kb,focusKey:hb,focusOffset:kb,isBackward:false});return q.set(fb,{selection:lb,forceSelection:true});}function xa(fb){return fb.length>0;}function ya(fb,gb){var hb=l.replaceWithFragment(fb.getCurrentContent(),fb.getSelection(),gb);return q.push(fb,hb,p.INSERT_FRAGMENT);}function za(fb){var gb=l.removeRange(fb.getCurrentContent(),fb.getSelection(),o.FORWARD);return q.push(fb,gb,p.REMOVE_RANGE);}function ab(fb,gb){var hb=fb.getSelection();if(!hb.isCollapsed())gb(ba(fb.getCurrentContent(),hb));}var bb='\'',cb='\/',db=!!x.firefox();function eb(fb){return (db&&(fb==bb||fb==cb));}e.exports=fa;},null);
__d("TextEditorDragHandler",["DataTransfer"],function(a,b,c,d,e,f,g){function h(j,event){var k,l;if(document.caretRangeFromPoint){var m=document.caretRangeFromPoint(event.x,event.y);k=m.startContainer;l=m.startOffset;}else if(event.rangeParent){k=event.rangeParent;l=event.rangeOffset;}if(k){var n=document.createRange();n.setStart(j,0);n.setEnd(k,l);var o=n.toString().length;n.detach();return o;}}var i={onDragEnd:function(){this.exitCurrentMode();},onDrop:function(j){var k=new g(j.nativeEvent.dataTransfer),l=h(this.refs.editorContainer.getDOMNode(),j.nativeEvent);if(l!=null){var m=k.getFiles();if(this.props.onDropFiles&&m.length>0){this.props.onDropFiles(l,m);}else if(this._internalDrag){this.props.onDropSelection(l);}else this.props.onDropText(l,k.getText());}j.preventDefault();this.exitCurrentMode();}};e.exports=i;},null);
__d("UnicodeBidiService",["Locale","UnicodeBidi","UnicodeBidiDirection","invariant"],function(a,b,c,d,e,f,g,h,i,j){"use strict";function k(l){if(!l)l=g.getDirection();j(i.isStrong(l));this.defaultDir=l;this.reset();}k.prototype.reset=function(){this.lastDir=this.defaultDir;};k.prototype.getDirection=function(l){this.lastDir=h.getDirection(l,this.lastDir);return this.lastDir;};e.exports=k;},null);
__d("AbstractTextEditor.Experimental.react",["AbstractTextEditorPlaceholder.Experimental.react","AbstractTextEditorProps","DocumentOffsetKey","DOMVector","EditorState","ElementForBlockType","ImmutableMap","React","TextEditorBlock.Experimental.react","TextEditorCompositionHandler.Experimental","TextEditorEditHandler.Experimental","TextEditorDragHandler","TextEditorModes","UnicodeBidiService","cx","extendArray","requestAnimationFrame","setImmediate"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x){"use strict";var y=a.MutationObserver||a.WebKitMutationObserver;function z(ca){return function(da){var ea=this._handler&&this._handler[ca];ea&&ea.call(this,da);};}function aa(ca){switch(ca){case s.EDIT:return q;case s.COMPOSITE:return p;case s.DRAG:return r;case s.CUT:case s.RENDER:return null;}}var ba=n.createClass({displayName:'AbstractTextEditor',getDefaultProps:h.getDefaultProps,_onBlur:z('onBlur'),_onFocus:z('onFocus'),_onSelect:z('onSelect'),_onKeyDown:z('onKeyDown'),_onKeyUp:z('onKeyUp'),_onKeyPress:z('onKeyPress'),_onMouseDown:z('onMouseDown'),_onMouseUp:z('onMouseUp'),_onCharacterData:z('onCharacterData'),_onCompositionStart:z('onCompositionStart'),_onCompositionEnd:z('onCompositionEnd'),_onDragStart:z('onDragStart'),_onDragOver:z('onDragOver'),_onDragEnd:z('onDragEnd'),_onDrop:z('onDrop'),_onCut:z('onCut'),_onCopy:z('onCopy'),_onPaste:z('onPaste'),_onBeforeInput:z('onBeforeInput'),_renderContents:function(){var ca=this.props.editorState,da=this.props.blockComponent||o,ea=ca.getCurrentContent(),fa=ca.getSelection(),ga=ca.getCurrentKey(),ha=ca.mustForceSelection(),ia=ea.getBlocksAsArray(),ja=[],ka=null,la=null,ma,na,oa,pa,qa,ra,sa;for(var ta=0;ta<ia.length;ta++){na=ia[ta];oa=na.getKey();pa=na.getText();qa=na.getType();ra=n.createElement(da,{currentEditorState:ga,key:oa,tree:m.get(ca.getTreeMap(),oa),decorator:ca.getDecorator(),block:na,selection:fa,forceSelection:ha,direction:this._bidiService.getDirection(pa),blockProps:this.props.blockProps,blockStyleFn:this.props.blockStyleFn,inlineStyleFn:this.props.inlineStyleFn});sa=l.getWrapperElement(qa);if(sa){if(la!==qa){ma=[];ka=n.createElement(sa,{className:"_4noe",key:oa+'-wrap','data-offset-key':i.encode(oa,0,0)},ma);la=qa;ja.push(ka);}ma.push(ra);}else{ma=null;ka=null;la=null;ja.push(ra);}}return ja;},_attachMutationObserver:function(){if(!y)return;var ca=[],da=function(){if(ca.length>1){var ea=ca[0],fa=ea.target;x(function(){this._onCharacterData(fa);}.bind(this));}ca.length=0;}.bind(this);this._mutationObserver=new y(function(ea){if(!this._guardAgainstRender){if(ca.length===0)w(da);v(ca,ea);}}.bind(this));this._mutationObserver.observe(this.refs.editorContainer.getDOMNode(),{characterDataOldValue:true,characterData:true,subtree:true});},_renderPlaceholder:function(){var ca=this.props.editorState.getCurrentContent(),da=(this.props.placeholder&&!this.props.editorState.isInCompositionMode()&&!ca.hasText());if(da)return (n.createElement(g,{text:this.props.placeholder,editorState:this.props.editorState}));},render:function(){return (n.createElement(n.DOM.div,{className:"_5yw9"},this._renderPlaceholder(),n.createElement(n.DOM.div,{className:"_5ywa",ref:"editorContainer"},n.createElement(n.DOM.div,{ref:"editor",role:"textbox",className:"_54-z",onBlur:this._onBlur,onFocus:this._onFocus,onSelect:this._onSelect,onMouseUp:this._onMouseUp,onKeyDown:this._onKeyDown,onKeyUp:this._onKeyUp,onKeyPress:this._onKeyPress,onCut:this._onCut,onCopy:this._onCopy,onPaste:this._onPaste,onDragStart:this._onDragStart,onDragOver:this._onDragOver,onDragEnd:this._onDragEnd,onDrop:this._onDrop,onCompositionStart:this._onCompositionStart,onCompositionEnd:this._onCompositionEnd,onBeforeInput:this._onBeforeInput,spellCheck:this.props.spellCheck,contentEditable:true},this._renderContents()))));},focus:function(){var ca=this.props.editorState,da=ca.getSelection().hasFocus(),ea=j.getScrollPosition();this.refs.editor.getDOMNode().focus();window.scrollTo(ea.x,ea.y);if(da)return;this.update(k.moveFocusToEnd(ca));},blur:function(){this.refs.editor.getDOMNode().blur();},componentDidMount:function(){this._renderedVersion=null;this._clipboard=null;this._clonedEditor=null;this._guardAgainstRender=false;this._handler=q;this._attachMutationObserver();},shouldComponentUpdate:function(ca){var da=this.props.editorState,ea=ca.editorState,fa=ea.getNativelyRenderedKey(),ga=da.isInCompositionMode(),ha=ea.isInCompositionMode();if(da===ea||(fa&&ea.getCurrentKey()===fa)||(ga&&ha))return false;var ia=da.getCurrentContent(),ja=ea.getCurrentContent(),ka=da.getTreeMap(),la=ea.getTreeMap();return (ga!==ha||ia!==ja||ka!==la||ea.mustForceSelection());},componentWillUpdate:function(ca){this._blockSelectEvents=true;this._bidiService.reset();},componentDidUpdate:function(){this._blockSelectEvents=false;},componentWillMount:function(){this._bidiService=new t();},componentWillUnmount:function(){if(this._mutationObserver){this._mutationObserver.disconnect();this._mutationObserver=null;}},setMode:function(ca){this._handler=aa(ca);},exitCurrentMode:function(){this.setMode(s.EDIT);},captureEditorDOM:function(){this._clonedEditor=this.refs.editor.getDOMNode().cloneNode(true);},restoreEditorDOM:function(){var ca=this.refs.editorContainer.getDOMNode();ca.innerHTML='';ca.appendChild(this._clonedEditor);this.focus();this._clonedEditor=null;},setRenderGuard:function(){this._guardAgainstRender=true;},removeRenderGuard:function(){this._guardAgainstRender=false;},update:function(ca){this.props.onChange(ca);}});e.exports=ba;},null);
__d("getDefaultKeyBinding",["DocumentCommands","Keys","UserAgent_DEPRECATED"],function(a,b,c,d,e,f,g,h,i){var j=i.osx(),k=i.windows(),l=i.firefox(),m=j&&l&&l<29;function n(u){return u.ctrlKey&&!u.altKey;}function o(u){return j?(u.metaKey&&!u.altKey):n(u);}function p(u){return (j&&u.altKey)||n(u);}function q(u){if(o(u))return u.shiftKey?g.REDO:g.UNDO;}function r(u){if(k&&u.shiftKey)return null;return p(u)?g.DELETE_WORD:g.DELETE;}function s(u){if(o(u)&&j)return g.BACKSPACE_TO_END_OF_BLOCK;return p(u)?g.BACKSPACE_WORD:g.BACKSPACE;}function t(u){switch(u.keyCode){case 66:return o(u)?g.BOLD:null;case 68:return n(u)?g.DELETE:null;case 72:return n(u)?g.BACKSPACE:null;case 73:return o(u)?g.ITALIC:null;case 74:return o(u)?g.CODE:null;case 75:return n(u)?g.DELETE_TO_END_OF_BLOCK:null;case 79:return n(u)?g.INSERT_BLOCK_DELIMITER:null;case 84:return n(u)?g.TRANSPOSE_CHARACTERS:null;case 85:return o(u)?g.UNDERLINE:null;case 90:return q(u)||null;case h.DELETE:return r(u);case h.BACKSPACE:return s(u);case h.LEFT:return (m&&o(u)?g.MOVE_SELECTION_TO_START_OF_BLOCK:null);case h.RIGHT:return (m&&o(u)?g.MOVE_SELECTION_TO_END_OF_BLOCK:null);default:return null;}}e.exports=t;},null);
__d("isSoftNewlineEvent",["Keys"],function(a,b,c,d,e,f,g){function h(i){return i.which===g.RETURN&&(i.getModifierState('Shift')||i.getModifierState('Alt')||i.getModifierState('Control'));}e.exports=h;},null);
__d("DropdownContextualHelpLink",["DOM","ge"],function(a,b,c,d,e,f,g,h){var i={set:function(j){var k=h('navHelpCenter');if(k!==null)g.replace(k,j);}};e.exports=i;},null);
__d("TabsViewport",["Arbiter","ArbiterMixin","ChatTabModel","Dock","DOM","DOMDimensions","Event","Parent","Vector","ViewportBounds","areJSONRepresentationsEqual","copyProperties","csx","shield"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){var u=175,v=269,w=0;function x(){return u;}function y(){return v;}function z(aa){this._root=aa;var ba=this._recalculateWidth.bind(this);m.listen(window,'resize',ba);j.subscribe('resize',ba);g.subscribeOnce('sidebar/initialized',ba,g.SUBSCRIBE_NEW);i.subscribe('chat/tabs-changed',t(this._recalculateTabs,this,true));this._recalculateWidth();this._initialized=true;}r(z.prototype,h,{_root:null,_initialized:false,_availableWidth:0,_maxShown:1,_viewState:null,_recalculateWidth:function(){var aa=z._getAvailableDockWidth(this._root),ba=Math.max(1,Math.floor(aa/y())),ca=ba!=this._maxShown;if(!this._viewState||ca||aa<=this._viewState.usedWidth||aa>this._viewState.widthToShowNext){this._availableWidth=aa;this._maxShown=ba;this._viewState=null;this._recalculateTabs(ca);}},_onTabsChanged:function(){if(this._initialized){this.inform('tabs-changed');this.inform('max-to-show-changed',this._maxShown);this.inform('max-to-show-change-completed');}},_recalculateTabs:function(aa){var ba=z._getTabsToShow(i.get(),this._availableWidth);if(aa||!q(this._viewState,ba)){this._viewState=ba;this._onTabsChanged();}},getMaxTabsToShow:function(){return this._maxShown;},checkWidth:function(){this._recalculateWidth();},hasRoomForRaisedTab:function(){return this._availableWidth-this._viewState.usedWidth>y();},getTabsToShow:function(){return JSON.parse(JSON.stringify(this._viewState.tabsToShow));},getShowingTabsOrder:function(){var aa=i.get(),ba=this._viewState.tabsToShow;return aa.tabs.filter(function(ca){return ba[ca.id];});},getRightmostHiddenTab:function(){var aa=i.get(),ba=this._viewState.tabsToShow,ca=aa.tabs.filter(function(ea){return !ba[ea.id];}),da=ca.shift();return da?da.id:null;},getLeftmostVisibleTab:function(){var aa=this.getShowingTabsOrder(),ba=aa.pop();return ba?ba.id:null;},getRightmostRaisedTab:function(){var aa=this.getShowingTabsOrder(),ba=aa.length;for(var ca=0;ca<ba;ca++)if(i.getTab(aa[ca].id).raised)return aa[ca].id;return null;},getRaisedVisibleTabs:function(){var aa=[],ba=this.getShowingTabsOrder(),ca=ba.length;for(var da=0;da<ca;da++)if(i.getTab(ba[da].id).raised)aa.push(ba[da].id);return aa;},shouldPromoteOnRaise:function(aa){if(!this._viewState.tabsToShow[aa])return true;if(this._viewState.nextToHide!=aa)return false;var ba=i.getTab(aa),ca=ba&&ba.raised;return !ca&&(this._availableWidth-this._viewState.usedWidth<y()-x());}});r(z,{_getAvailableDockWidth:function(aa){var ba=l.getViewportWithoutScrollbarDimensions().width;ba-=p.getLeft()+p.getRight();ba-=50;var ca=n.byClass(aa,'fbDock'),da=k.find(ca,"._56ox"),ea=o.getElementDimensions(da).x;ba-=ea;var fa=k.scry(ca,"._56oy");ea+=o.getElementDimensions(fa.pop()).x;var ga=o.getElementDimensions(ca),ha=ga.x-ea;if(ha>w)w=ha;ba-=w;ba-=15;return Math.max(ba,0);},_getTabsToShow:function(aa,ba){ba=Math.max(ba,y()+1);function ca(sa,ta){return (sa.raised||!ta)?y():x();}var da=JSON.parse(JSON.stringify(aa.tabs)),ea=-1,fa=null;if(aa.promoted)da.forEach(function(sa,ta){if(sa.id===aa.promoted){ea=ta;fa=sa;}});var ga=0,ha=false,ia=0,ja=!fa;da.forEach(function(sa,ta){var ua=ca(sa,ha);ha=ha||!sa.raised;sa.leftmostOffset=ga+ua;ga+=ua;if(sa.leftmostOffset<ba)ia++;ja|=ta==ea;sa.alreadyPlacedPromoted=ja;});function ka(sa,ta,ua){var va={};for(var wa=0;wa<ta;wa++){var xa=sa[wa];if(!xa.alreadyPlacedPromoted&&wa==ta-1){va[ua]=true;}else va[xa.id]=true;}return va;}var la=ka(da,ia,aa.promoted),ma=ka(da,ia-1,aa.promoted),na=null;for(var oa in la)if(!ma[oa])na=oa;var pa=da[ia-1],qa=pa?pa.leftmostOffset:0,ra=Infinity;if(ia<da.length)ra=da[ia].leftmostOffset;return {nextToHide:na,tabsToShow:la,usedWidth:qa,widthToShowNext:ra};}});e.exports=z;},null);
__d("ChatTabPresence",["AvailableList","ChatTabModel","MercuryThreads"],function(a,b,c,d,e,f,g,h){var i=b('MercuryThreads').get(),j={};function k(l){var m=i.getCanonicalUserInThread(l);if(m)g.updateForID(m);}h.subscribe('chat/tabs-changed',function(event,l){l.tabs.forEach(function(m){if(m.raised&&!j[m.id])k(m.id);});j={};l.tabs.forEach(function(m){if(m.raised)j[m.id]=true;});});e.exports={};},null);
__d("ChatMentionsNotifications",["fbt","CurrentUser","MercuryParticipants"],function(a,b,c,d,e,f,g,h,i){var j={notifyIfMessageToMe:function(k){var l='fbid:'+h.getID(),m=k.body;i.get(l,function(n){var o=new RegExp(n.short_name,"i");if(o.test(m))j._notify(k);});},_notify:function(k){var l=48,m=k.body;if(m.length>l)m=m.substr(0,l-3)+"...";new Notification("\"You were tagged in a message!\"",{body:m,icon:"http://facebook.com//images/icons-large/fb-xl.png"});}};e.exports=j;},null);
__d("VideoCallTourDialog",["ArbiterMixin","LegacyContextualDialog","CSS","ChatTabTemplates","VideoCallCore","VideoCallingTour","copyProperties","MercuryThreads"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n=b('MercuryThreads').get();function o(){this._dialog=null;}m(o.prototype,g);m(o.prototype,{render:function(p,q){var r=n.getCanonicalUserInThread(q);if(!r||!k.availableForCall(r))return;var s=j[':fb:mercury:call:tour'].build();this._dialog=new h();this._dialog.init(s.getRoot()).setWidth(250).setAlignH('center').setContext(p).show();i.addClass(this._dialog.getRoot(),'uiContextualDialogWithFooterArrowBottom');i.addClass(p,'video_call_tour');this.inform('chat/dialog-rendered',{dialog:this,thread_id:q});l.inform('videocallingtour/end');},updatePosition:function(){if(this._dialog&&this._dialog.isShown())this._dialog.updatePosition();},hide:function(){if(this._dialog&&this._dialog.isShown()){this._dialog.hide();this._dialog=null;}}});e.exports=o;},null);
__d("ChatContextualDialogController",["Event","ArbiterMixin","ChatTabModel","VideoCallingTour","VideoCallTourDialog","copyProperties","setTimeoutAcrossTransitions"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n=60000,o=false,p=function(w,x){this._videoCallTour=new k();this._threadID=w;this._tabMainElement=x;this._openDialog=null;this._subscriptionTokens=[];this._scrollListener=null;this._timeout=null;};function q(w,event,x){if(w._openDialog)w._openDialog.updatePosition();}function r(w){if(w._openDialog)w._openDialog.updatePosition();}function s(w){if(w._openDialog){w._openDialog.hide();w._openDialog=null;}if(w._timeout){clearTimeout(w._timeout);w._timeout=null;}while(w._subscriptionTokens.length)w._subscriptionTokens.pop().unsubscribe();if(w._scrollListener){w._scrollListener.remove();w._scrollListener=null;}}function t(w,event,x){if(x.thread_id===w._threadID){w._openDialog=x.dialog;v(w);w._timeout=m(w.destroy.bind(w,w._threadID),n);w._scrollListener=g.listen(window,'scroll',r.bind(null,w));}}function u(w,x){if(!w._openDialog){w._subscriptionTokens.push(x.subscribe('chat/dialog-rendered',t.bind(null,w)));x.render(w._tabMainElement,w._threadID);}}function v(w){w._subscriptionTokens.push(i.subscribe('chat/tabs-changed',q.bind(null,w)),p.subscribe('dialog/close-all',s.bind(null,w)));}l(p,h);l(p.prototype,{destroy:function(){s(this);},tabFocused:function(){if(o){u(this,this._videoCallTour);return;}},tabNotActive:function(){s(this);},hideVideoCallouts:function(){s(this);}});j.subscribe('videocallingtour/start',function(){o=true;p.inform('dialog/close-all');});j.subscribe('videocallingtour/end',function(){o=false;});e.exports=p;},null);
__d("ChatFileUploaderMixin",["SubscriptionsHandler","React"],function(a,b,c,d,e,f,g,h){var i={propTypes:{attachmentsShelf:h.PropTypes.object,onFileUploaderMounted:h.PropTypes.func,onUploadFinished:h.PropTypes.func,onUpdateAttachmentsShelf:h.PropTypes.func,onSubmit:h.PropTypes.func},setUpSubscriptionsHandler:function(j){this._uploader=j;this._subscriptions=new g();this._subscriptions.addSubscriptions(this._uploader.subscribe(['all-uploads-completed','upload-canceled'],this._handleUploadFinished),this._uploader.subscribe('dom-updated',this._handleUpdateAttachmentsShelf),this._uploader.subscribe('submit',this._handleSubmit));this.props.onFileUploaderMounted(this._uploader);},componentWillUnmount:function(){this._subscriptions&&this._subscriptions.release();this._uploader&&this._uploader.destroy();},isUploading:function(){return this._uploader.isUploading();},getAttachments:function(){return this._uploader.getAttachments();},getImageFiles:function(){return this._uploader.getImageFiles();},getVideoFiles:function(){return this._uploader.getVideoFiles();},getAudioFiles:function(){return this._uploader.getAudioFiles();},getFiles:function(){return this._uploader.getFiles();},removeAttachments:function(){return this._uploader.removeAttachments();},_handleUploadFinished:function(){if(this.props.onUploadFinished)this.props.onUploadFinished();},_handleUpdateAttachmentsShelf:function(){if(this.props.onUpdateAttachmentsShelf)this.props.onUpdateAttachmentsShelf();},_handleSubmit:function(){if(this.props.onSubmit)this.props.onSubmit();}};e.exports=i;},null);
__d("ChatFileUploader.react",["ChatFileUploaderMixin","InlineBlock.react","MercuryConfig","MercuryFileUploader","React","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){'use strict';var n=k.createClass({displayName:'ChatFileUploader',mixins:[g],shouldComponentUpdate:function(){return false;},componentDidMount:function(){var o=new j(this.props.attachmentsShelf,this.refs.form.getDOMNode(),this.refs.input.getDOMNode(),this.refs.attachID.getDOMNode());this.setUpSubscriptionsHandler(o);},render:function(){return (k.createElement(k.DOM.form,{ref:"form",action:i.upload_url,method:"post"},k.createElement(k.DOM.input,{type:"hidden",ref:"attachID",name:"attach_id"}),k.createElement(h,{className:"_m _4q60 itemLabel"},k.createElement(k.DOM.input,{type:"file",className:"_n",name:"attachment[]",multiple:"true",ref:"input"}),k.createElement(k.DOM.span,{className:"_4q61 itemAnchor"},"Add Files..."))));}});e.exports=n;},null);
__d("StickerTriggerHighlightSpan.react",["React","cx"],function(a,b,c,d,e,f,g,h){"use strict";var i=g.createClass({displayName:'StickerTriggerHighlightSpan',getInitialState:function(){return {activated:false};},propTypes:{offsetKey:g.PropTypes.string},_onClick:function(){if(this.state.activated)return;this.props.openFlyoutFn();this.setState({activated:true});},render:function(){return (g.createElement(g.DOM.span,{onClick:this._onClick,'data-offset-key':this.props.offsetKey,className:(("_29dt")+(this.state.activated?' '+"_1t57":'')),spellCheck:false},this.props.children));}});e.exports=i;},null);
__d("ChatInput.react",["AbstractTextEditor.Experimental.react","DocumentCompositeDecorator.Experimental","DocumentDecorator","DocumentModifierExperimental","DOMVector","EditorChangeType","EditorState","StickerTriggerHighlightSpan.react","React","createContentStateFromBlocks","createPlainBlocksFromText","createInitialEditorState","emptyFunction","getDefaultKeyBinding","isSoftNewlineEvent","setImmediate"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){"use strict";var w=s.thatReturnsNull,x=' ',y=o.createClass({displayName:'ChatInput',propTypes:{blockStyleFn:o.PropTypes.func,getTriggeredWordFn:o.PropTypes.func,initializeThingsWithInputFn:o.PropTypes.func,inlineStyleFn:o.PropTypes.func,inputChanged:o.PropTypes.func,inputKeyDown:o.PropTypes.func,isTriggerValid:o.PropTypes.func,keyBindingFn:o.PropTypes.func,onBlur:o.PropTypes.func,onEscape:o.PropTypes.func,onFocus:o.PropTypes.func,onTab:o.PropTypes.func,resizeFn:o.PropTypes.func},getDefaultProps:function(){return {blockStyleFn:w,inlineStyleFn:w,keyBindingFn:t};},componentDidMount:function(){this.props.resizeFn();this._oldHeight=this.getDOMNode().getBoundingClientRect().height;this.props.initializeThingsWithInputFn(this.refs.input.getDOMNode(),this.getValue.bind(this));},componentWillReceiveProps:function(z){if(this.props.triggeredWord!==z.triggeredWord)this._updateDecorator(z.triggeredWord);},componentDidUpdate:function(){var z=k.getScrollPosition();v(function(){var aa=this.getDOMNode().getBoundingClientRect().height;if(this._oldHeight!==aa){window.scrollTo(z.x,z.y);this.props.resizeFn();}this._oldHeight=aa;}.bind(this));},getInitialState:function(){var z=q(['']),aa=r(p(z));return {editorState:m.moveFocusToEnd(aa)};},resetState:function(){this.setState(this.getInitialState());},_updateDecorator:function(z){var aa=this._getStickerTagDecorator(z),ba=m.set(this.state.editorState,{decorator:aa});v(function(){return this.setState({editorState:ba});}.bind(this));},_getStickerTagDecorator:function(z){var aa=function(ba,ca){if(!z)return;var da,ea,fa;if(z.match(/\W/)){fa=new RegExp(z.replace(/(\W)/g,'\\$1'),'gi');}else fa=new RegExp('\\b'+z+'\\b','gi');while((da=fa.exec(ba.getText()))!==null){ea=da.index;ca(ea,ea+z.length);}};return new h([new i(aa,n,{openFlyoutFn:this.props.openFlyoutFn})]);},onChange:function(z){if(z.getCurrentContent()!==this.state.editorState.getCurrentContent())this.props.inputChanged(this.getValueFromEditorState(z));this.setState({editorState:z});},onReturn:function(event){if(u(event))return false;this.props.inputKeyDown(event,this.getValue());this.resetState();return true;},getValueFromEditorState:function(z){return z.getCurrentContent().getPlainText();},getValue:function(){return this.getValueFromEditorState(this.state.editorState);},focus:function(){this.refs.input.focus();},_onPasteFiles:function(z){var aa=/^image\//,ba=z.filter(function(ca){return aa.test(ca.type);});if(ba.length)this.props.uploadPhotoFn(ba[0]);},insertEmoticon:function(z){var aa=this.state.editorState,ba=aa.getSelection(),ca=aa.getCurrentContent(),da=ba.getStartOffset(),ea=ba.getEndOffset(),fa=ca.getBlockForKey(ba.getStartKey()).getText(),ga=ca.getBlockForKey(ba.getEndKey()).getText();if(da>0&&fa[da-1]!==x)z=x+z;if(ea<=ga.length&&ga[ea]!==x)z=z+x;var ha=j.replaceText(ca,ba,z,aa.getCurrentInlineStyle(),null),ia=m.push(aa,ha,l.INSERT_CHARACTERS);this.setState({editorState:ia});},render:function(){return (o.createElement(g,Object.assign({ref:"input"},this.props,{editorState:this.state.editorState,onChange:this.onChange,onPasteFiles:this._onPasteFiles,handleReturn:this.onReturn})));}});e.exports=y;},null);
__d("getImageSize",["DataViewPolyfill"],function(a,b,c,d,e,f,g){var h=a.DataView||g;function i(m){return {width:m.getUint16(6,true),height:m.getUint16(8,true)};}function j(m){return {width:m.getUint32(16,false),height:m.getUint32(20,false)};}function k(m){var n=m.byteLength,o=2;while(o<n){var p=m.getUint16(o,false);o+=2;if(p==65472||p==65474){return {width:m.getUint16(o+5,false),height:m.getUint16(o+3,false)};}else o+=m.getUint16(o,false);}return null;}function l(m){var n=new h(m);if(n.getUint8(0)==255&&n.getUint8(1)==216)return k(n);if(n.getUint8(0)==71&&n.getUint8(1)==73&&n.getUint8(2)==70)return i(n);if(n.getUint8(0)==137&&n.getUint8(1)==80&&n.getUint8(2)==78&&n.getUint8(3)==71)return j(n);return null;}e.exports=l;l.gif=i;l.png=j;l.jpeg=k;},null);
__d("ChatAutoSendPhotoUploader",["ArbiterMixin","AsyncUploadRequest","DOM","Event","FileForm","FileFormResetOnSubmit","FileInput","FormSubmitOnChange","JpegResizer","MercuryAttachmentType","PhotosMimeType","PhotosUploadID","SubscriptionsHandler","arrayContains","csx","getImageSize","getObjectValues","invariant","isEmpty","mixin"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z){"use strict";function aa(){return 'upload_'+r.getNewID();}var ba=z(g);for(var ca in ba)if(ba.hasOwnProperty(ca))ea[ca]=ba[ca];var da=ba===null?null:ba.prototype;ea.prototype=Object.create(da);ea.prototype.constructor=ea;ea.__superConstructor__=ba;function ea(fa,ga,ha){this.$ChatAutoSendPhotoUploader0=ha;this.$ChatAutoSendPhotoUploader1=ga;this.$ChatAutoSendPhotoUploader2=new s();this.$ChatAutoSendPhotoUploader3={};this.$ChatAutoSendPhotoUploader4={};this.$ChatAutoSendPhotoUploader5=fa.getAttribute('action');this.$ChatAutoSendPhotoUploader6=new k(fa,[n,l]);this.$ChatAutoSendPhotoUploader6.setAllowCrossOrigin(true);this.$ChatAutoSendPhotoUploader6.setUploadInParallel(true);var ia=i.find(fa,"._4q60"),ja=i.find(ia,"._4q61");new m(ia,ja,ga);this.$ChatAutoSendPhotoUploader2.addSubscriptions(this.$ChatAutoSendPhotoUploader6.subscribe('submit',this.$ChatAutoSendPhotoUploader7.bind(this)),this.$ChatAutoSendPhotoUploader6.subscribe('success',this.$ChatAutoSendPhotoUploader8.bind(this)),this.$ChatAutoSendPhotoUploader6.subscribe('failure',this.$ChatAutoSendPhotoUploader9.bind(this)),this.$ChatAutoSendPhotoUploader6.subscribe('progress',this.$ChatAutoSendPhotoUploadera.bind(this)),j.listen(ja,'click',function(){if(this.$ChatAutoSendPhotoUploaderb)if(o.prepareResource)o.prepareResource();this.inform('open');}.bind(this)));this.$ChatAutoSendPhotoUploaderb=o.isSupported();if(this.$ChatAutoSendPhotoUploaderb)this.$ChatAutoSendPhotoUploader6.setPreprocessHandler(this.$ChatAutoSendPhotoUploaderc.bind(this));}ea.prototype.isUploading=function(){return !y(this.$ChatAutoSendPhotoUploader3);};ea.prototype.destroy=function(){this.$ChatAutoSendPhotoUploader2.release();this.$ChatAutoSendPhotoUploader6.destroy();this.$ChatAutoSendPhotoUploader3={};this.$ChatAutoSendPhotoUploader4={};};ea.prototype.$ChatAutoSendPhotoUploaderd=function(fa,ga){var ha=this.$ChatAutoSendPhotoUploadere(fa);if(ga){ha.preview_width=ga.width;ha.preview_height=ga.height;}return ha;};ea.prototype.$ChatAutoSendPhotoUploadere=function(fa){var ga={upload_id:fa,on_progress:function(ha){this.$ChatAutoSendPhotoUploader2.addSubscriptions(this.subscribe('progress',ha));}.bind(this),on_resizing_progress:function(ha){this.$ChatAutoSendPhotoUploader2.addSubscriptions(this.subscribe('resize_progress',ha));}.bind(this),on_success:function(ha){this.$ChatAutoSendPhotoUploader2.addSubscriptions(this.subscribe('success',ha));}.bind(this),upload_canceled:this.$ChatAutoSendPhotoUploaderf.bind(this),attach_type:p.PHOTO,preview_uploading:true};return ga;};ea.prototype.$ChatAutoSendPhotoUploaderc=function(fa,ga){var ha=fa.getFile();if(!q(ha.type).isJpeg())return ga(fa);o.getSingleton().resizeBlob(ha,function(ia,ja,ka){if(ja)fa.setFile(ja);ga(fa);},this.$ChatAutoSendPhotoUploaderg.bind(this,fa));};ea.prototype.$ChatAutoSendPhotoUploader7=function(){var fa=aa();this.$ChatAutoSendPhotoUploaderh(fa,this.$ChatAutoSendPhotoUploader1.files);};ea.prototype.$ChatAutoSendPhotoUploaderh=function(fa,ga){var ha={};if(typeof FileReader!=='undefined'&&FileReader.prototype.readAsArrayBuffer&&ga&&ga.length===1){this.$ChatAutoSendPhotoUploader3[fa]=fa;ha[fa]=ga[0];var ia=new FileReader();ia.onload=function(){this.inform('submit',{upload_id:fa,preview_attachments:[this.$ChatAutoSendPhotoUploaderd(fa,v(ia.result))]});}.bind(this);ia.onerror=function(){this.inform('submit',{upload_id:fa,preview_attachments:[this.$ChatAutoSendPhotoUploadere(fa)]});}.bind(this);ia.readAsArrayBuffer(ga[0]);}else{var ja=[];if(!ga){this.$ChatAutoSendPhotoUploader3[fa]=fa;this.$ChatAutoSendPhotoUploader0.value=fa;ja.push(this.$ChatAutoSendPhotoUploadere(fa));}else for(var ka=0;ka<ga.length;++ka){var la=aa();ha[la]=ga[ka];this.$ChatAutoSendPhotoUploader3[la]=fa;ja.push(this.$ChatAutoSendPhotoUploadere(la));}this.inform('submit',{upload_id:fa,preview_attachments:ja});}if(Object.keys(ha).length>0)this.$ChatAutoSendPhotoUploader6.setFiles(ha);};ea.prototype.$ChatAutoSendPhotoUploader8=function(event,fa){var ga=this.$ChatAutoSendPhotoUploaderi(fa);if(this.$ChatAutoSendPhotoUploader3[ga]){var ha=this.$ChatAutoSendPhotoUploader3[ga];delete this.$ChatAutoSendPhotoUploader3[ga];var ia=fa.response.getPayload();if(!this.$ChatAutoSendPhotoUploader4[ha])this.$ChatAutoSendPhotoUploader4[ha]=[];this.$ChatAutoSendPhotoUploader4[ha].push({id:ga,fbid:ia.metadata[0].image_id});this.inform('success',{upload_id:ga});if(!this.$ChatAutoSendPhotoUploaderj(ha))this.$ChatAutoSendPhotoUploaderk(ha);}};ea.prototype.$ChatAutoSendPhotoUploaderk=function(fa){x(!this.$ChatAutoSendPhotoUploaderj(fa));this.$ChatAutoSendPhotoUploader4[fa].sort(function(ha,ia){return ha.id<ia.id?-1:1;});var ga=this.$ChatAutoSendPhotoUploader4[fa].map(function(ha){return ha.fbid;});this.inform('all-uploads-completed',{upload_id:fa,image_ids:ga});delete this.$ChatAutoSendPhotoUploader4[fa];};ea.prototype.$ChatAutoSendPhotoUploadera=function(event,fa){this.inform('progress',{upload_id:fa.upload.getName(),event:fa.event});};ea.prototype.$ChatAutoSendPhotoUploaderg=function(fa,event){this.inform('resize_progress',{upload_id:fa.getName(),event:event});};ea.prototype.$ChatAutoSendPhotoUploaderj=function(fa){return t(w(this.$ChatAutoSendPhotoUploader3),fa);};ea.prototype.$ChatAutoSendPhotoUploader9=function(event,fa){var ga=this.$ChatAutoSendPhotoUploaderi(fa);this.$ChatAutoSendPhotoUploaderl(ga,'last-upload-failed');return false;};ea.prototype.$ChatAutoSendPhotoUploaderf=function(fa){this.$ChatAutoSendPhotoUploaderl(fa,'last-upload-canceled');};ea.prototype.$ChatAutoSendPhotoUploaderl=function(fa,ga){if(!this.$ChatAutoSendPhotoUploader3[fa])return;var ha=this.$ChatAutoSendPhotoUploader3[fa];delete this.$ChatAutoSendPhotoUploader3[fa];if(!this.$ChatAutoSendPhotoUploaderj(ha))if(this.$ChatAutoSendPhotoUploader4[ha]){this.$ChatAutoSendPhotoUploaderk(ha);}else this.inform(ga,{upload_id:ha});};ea.prototype.$ChatAutoSendPhotoUploaderi=function(fa){if(fa.upload){return fa.upload.getName();}else return fa.response.getPayload().uploadID;};ea.prototype.uploadFile=function(fa){var ga=aa(),ha={};ha[ga]=fa;var ia=new h(this.$ChatAutoSendPhotoUploader5).setAllowCrossOrigin(true).setRelativeTo(this.$ChatAutoSendPhotoUploader6.getRoot()).setFiles(ha);this.$ChatAutoSendPhotoUploader2.addSubscriptions(ia.subscribe('success',function(event,ja){this.$ChatAutoSendPhotoUploader8(event,{upload:ja,response:ja.getResponse()});}.bind(this)),ia.subscribe('failure',this.$ChatAutoSendPhotoUploader9.bind(this)));ia.send();this.$ChatAutoSendPhotoUploaderh(ga,[fa]);};e.exports=ea;},null);
__d("ChatPhotoUploader.react",["ChatAutoSendPhotoUploader","Image.react","InlineBlock.react","Link.react","MercuryConfig","React","SubscriptionsHandler","cx","emptyFunction","fbt","ix"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){'use strict';var r=l.createClass({displayName:'ChatPhotoUploader',propTypes:{actionURI:l.PropTypes.string,onSubmit:l.PropTypes.func,onAllUploadsComplete:l.PropTypes.func,onLastUploadFail:l.PropTypes.func,onLastUploadCancel:l.PropTypes.func},getDefaultProps:function(){return {actionURI:k.upload_url,onSubmit:o,onAllUploadsComplete:o,onLastUploadFail:o,onLastUploadCancel:o};},componentDidMount:function(){this._uploader=new g(this.refs.form.getDOMNode(),this.refs.input.getDOMNode(),this.refs.attachID.getDOMNode());this._subscriptions=new m();this._subscriptions.addSubscriptions(this._uploader.subscribe('submit',this._handleSubmit),this._uploader.subscribe('all-uploads-completed',this._handleAllUploadsCompleted),this._uploader.subscribe('last-upload-failed',this._handleLastUploadFailed),this._uploader.subscribe('last-upload-canceled',this._handleLastUploadCanceled));},shouldComponentUpdate:function(s,t){return s.actionURI!=this.props.actionURI;},componentWillUnmount:function(){this._subscriptions&&this._subscriptions.release();this._uploader&&this._uploader.destroy();},render:function(){return (l.createElement(l.DOM.form,{action:this.props.actionURI,method:"post",ref:"form"},l.createElement(l.DOM.input,{type:"hidden",name:"attach_id",ref:"attachID"}),l.createElement(l.DOM.input,{type:"hidden",name:"images_only",value:true}),l.createElement(i,{className:"_m _4q60 _3rzn"},l.createElement(j,{className:"_4q61 _509v"},l.createElement(h,{className:"_509w",src:q('/images/chat/chat_camera_icon.png'),alt:"Camera"})),l.createElement(l.DOM.input,{type:"file",className:"_n",name:"attachment[]",multiple:"true",accept:"image/*",ref:"input"}))));},_handleSubmit:function(s,t){this.props.onSubmit(s,t);},_handleAllUploadsCompleted:function(s,t){this.props.onAllUploadsComplete(s,t);},_handleLastUploadFailed:function(s,t){this.props.onLastUploadFail(s,t);},_handleLastUploadCanceled:function(s,t){this.props.onLastUploadCancel(s,t);},isUploading:function(){return this._uploader&&this._uploader.isUploading();},uploadFile:function(s){this._uploader.uploadFile(s);}});e.exports=r;},null);
__d("ChatPrivacyActionController",["ChatVisibility","JSLogger","PresencePrivacy","copyProperties"],function(a,b,c,d,e,f,g,h,i,j){var k=function(l,m){this._userID=l;this._logger=h.create('blackbird');this._getState=function(){if(g.isOnline())return i.allows(this._userID)?k.NORMAL:k.BLOCKED;return k.OFFLINE;};this._togglePrivacy=function(){var n=this._getState();switch(this._getState()){case k.OFFLINE:if(g.isOnline()){this._logger.error('tabs_already_online');break;}this._logger.log('tabs_go_online',{tab_id:this._userID});g.goOnline(function(){if(!i.allows(this._userID)){if(this._getState()!==k.BLOCKED)this._logger.error('privacy_action_controller_blocked_inconsistency');this._togglePrivacy();}}.bind(this));break;case k.BLOCKED:i.allow(this._userID);this._logger.log('tabs_unblock',{tab_id:this._userID});break;case k.NORMAL:i.disallow(this._userID);this._logger.log('tabs_block',{tab_id:this._userID});break;}};setTimeout(function(){var n=function(){m&&m(this._getState());}.bind(this);n();this._subscribeToken=i.subscribe('privacy-changed',n);}.bind(this),0);};k.OFFLINE='offline';k.BLOCKED='blocked';k.NORMAL='normal';j(k.prototype,{togglePrivacy:function(){this._logger.log('gear_menu_toggle_privacy',{tab_id:this._userID});this._togglePrivacy();},destroy:function(){this._subscribeToken&&i.unsubscribe(this._subscribeToken);}});e.exports=k;},null);
__d("ChatShareLinkUploader",["AsyncRequest","CSS","DOM","URLScraper","MercuryShareLinkUploader","MercuryAttachmentTemplates","Event"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){for(var n in k)if(k.hasOwnProperty(n))p[n]=k[n];var o=k===null?null:k.prototype;p.prototype=Object.create(o);p.prototype.constructor=p;p.__superConstructor__=k;function p(q,r,s,t){"use strict";this.$ChatShareLinkUploader0=q;this.$ChatShareLinkUploader1=r;this.$ChatShareLinkUploader2=s;this.$ChatShareLinkUploader3=false;this.$ChatShareLinkUploader4=null;this.$ChatShareLinkUploader5=null;this.$ChatShareLinkUploader6=t;m.listen(r,'keyup',function(){var u=t?t():r.value;!u.length&&this.$ChatShareLinkUploader7.enable();}.bind(this));this.$ChatShareLinkUploader7=new j(r,t);this.$ChatShareLinkUploader7.subscribe('match',function(u,v){this.loadShare(v&&v.url);}.bind(this));this.$ChatShareLinkUploader8=null;}p.prototype.getAttachData=function(){"use strict";return this.loadAttachData(this.$ChatShareLinkUploader3,this.$ChatShareLinkUploader0,this.$ChatShareLinkUploader1,this.$ChatShareLinkUploader6);};p.prototype.close=function(){"use strict";this.$ChatShareLinkUploader9();this.$ChatShareLinkUploader7.disable();this.inform('closed');};p.prototype.clear=function(){"use strict";this.$ChatShareLinkUploader9();this.$ChatShareLinkUploader7.enable();};p.prototype.$ChatShareLinkUploader9=function(){"use strict";var q=this.$ChatShareLinkUploader8;delete this.$ChatShareLinkUploader8;if(q){i.remove(q);this.inform('dom-updated');}this.$ChatShareLinkUploader3=false;this.$ChatShareLinkUploader4=null;this.$ChatShareLinkUploader5&&this.$ChatShareLinkUploader5.abort();this.$ChatShareLinkUploader5=null;this.$ChatShareLinkUploader7&&this.$ChatShareLinkUploader7.reset();};p.prototype.loadShare=function(q,r){"use strict";this.$ChatShareLinkUploader4=q;this.$ChatShareLinkUploader5&&this.$ChatShareLinkUploader5.abort();var s=l[':fb:mercury:share-link-row'].build();if(this.$ChatShareLinkUploader8)i.remove(this.$ChatShareLinkUploader8);this.$ChatShareLinkUploader8=s.getRoot();m.listen(s.getNode('closeFileUpload'),'click',function(event){this.close();event.kill();}.bind(this));i.appendContent(this.$ChatShareLinkUploader0,this.$ChatShareLinkUploader8);h.show(this.$ChatShareLinkUploader0);this.inform('dom-updated');var t={u:q,chat:true,extra_params:JSON.stringify(r)};this.$ChatShareLinkUploader5=new g().setMethod('POST').setURI('/ajax/share_scrape.php').setData(t).setHandler(this.$ChatShareLinkUploadera.bind(this).bind(null,q));this.$ChatShareLinkUploader5.send();this.inform('link-detected');};p.prototype.$ChatShareLinkUploadera=function(q,r){"use strict";if(this.$ChatShareLinkUploader4!==q)return;this.$ChatShareLinkUploader4=null;this.$ChatShareLinkUploader5=null;i.appendContent(this.$ChatShareLinkUploader8,r.payload);this.$ChatShareLinkUploader2();this.$ChatShareLinkUploader3=true;if(!this.getAttachData()){this.close();return;}h.addClass(this.$ChatShareLinkUploader8,'done');};e.exports=p;},null);
__d("StickerContextualDialog.react",["ReactAbstractContextualDialog","ReactLayer","cx"],function(a,b,c,d,e,f,g,h,i){'use strict';var j=47,k=h.createClass(g.createSpec({displayName:'StickerXUIContextualDialog',theme:{wrapperClassName:"_53ii",arrowDimensions:{offset:j,length:16}}}));k.WIDTH={NORMAL:312,WIDE:400};e.exports=k;},null);
__d("ChatStickerButton.react",["BanzaiODS","React","ReactLayeredComponentMixin","StickerContextualDialog.react","StickersFlyout.react","StickerState","cx","emptyFunction","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){'use strict';var p=278,q=h.createClass({displayName:'ChatStickerButton',propTypes:{onStickerSelect:h.PropTypes.func,onEmoticonSelect:h.PropTypes.func,onFlyoutShown:h.PropTypes.func,onFlyoutHidden:h.PropTypes.func,packID:h.PropTypes.string},getInitialState:function(){return {shown:false};},mixins:[i],getDefaultProps:function(){return {onStickerSelect:n,onEmoticonSelect:n};},componentDidMount:function(){g.bumpEntityKey('chat.web','sticker_button.mounted');this._subscription=l.addListener(l.PACK_SELECTED,function(r){return this.setProps({packID:r});}.bind(this));},shouldComponentUpdate:function(r,s){return (r.packID!=this.props.packID||s.shown!=this.state.shown);},componentWillUnmount:function(){this._subscription&&this._subscription.remove();},render:function(){return (h.createElement(h.DOM.a,{className:"_4vuh",onClick:this.showFlyout,onMouseDown:this._prepareForClick,title:"Choose a sticker or emoticon",ref:"link"},h.createElement(h.DOM.div,{className:(("_4vui")+(this.state.shown?' '+"open":''))})));},renderLayers:function(){return {contextualDialog:h.createElement(j,{alignment:"left",className:"_5e-r",contextRef:"link",onBlur:this._hideFlyout,position:"above",shown:this.state.shown,width:p},h.createElement(h.DOM.div,null,h.createElement(k,{onShown:function(r){return this.props.onFlyoutShown&&this.props.onFlyoutShown(r);}.bind(this),onHidden:function(){return this.props.onFlyoutHidden&&this.props.onFlyoutHidden();}.bind(this),onEscKeyDown:this._hideFlyout,onStickerSelect:this._handleStickerSelected,onEmoticonSelect:this._handleEmoticonSelected,packID:this.props.packID,shown:this.state.shown})))};},_prepareForClick:function(){this._clickGuard=this.state.shown;},showFlyout:function(){!this._clickGuard&&this.setState({shown:true});},_hideFlyout:function(){this.setState({shown:false});},_handleStickerSelected:function(r){this.props.onStickerSelect(r);},_handleEmoticonSelected:function(r){this._hideFlyout();this.props.onEmoticonSelect(r);}});e.exports=q;},null);
__d("ChatTabMenu.react",["ChatFileUploader.react","ChatPrivacyActionController","ChatConfig","MercuryConfig","MercuryThreadMuter","React","PopoverMenu.react","ReactMenu","MenuSeparator.react","Toggler","TrackingNodes","WebMessengerThreadPermalinks","cx","fbt","goURI","MercuryThreads"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){'use strict';var v=b('MercuryThreads').get(),w=n.Item,x=l.createClass({displayName:'ChatTabMenu',propTypes:{onFileUploaderMounted:l.PropTypes.func,updatePrivacyLinkFunc:l.PropTypes.func,nameConversationFunc:l.PropTypes.func,leaveConversationFunc:l.PropTypes.func,showParticipantsFunc:l.PropTypes.func,clearHistoryFunc:l.PropTypes.func,reportSpamFunc:l.PropTypes.func,createGroupFunc:l.PropTypes.func,isMultichat:l.PropTypes.bool,isEmptyChat:l.PropTypes.bool,showAddFriend:l.PropTypes.func,threadID:l.PropTypes.string,attachmentsShelf:l.PropTypes.object,onUploadFinished:l.PropTypes.func,onUpdateAttachmentsShelf:l.PropTypes.func,onSubmit:l.PropTypes.func,enableDesktopNotif:l.PropTypes.func},getDefaultProps:function(){return {show:true};},componentWillMount:function(){if(!this.props.isMultiChat)this._privacyActionController=new h(v.getCanonicalUserInThread(this.props.threadID),this.props.updatePrivacyLinkFunc);},componentDidMount:function(){if(!this.props.fullURL)r.getThreadURI(this.props.threadID,function(y){this.isMounted()&&this.setProps({fullURL:y});}.bind(this));},componentWillUnmount:function(){this._privacyActionController&&this._privacyActionController.destroy();},_unmuteThread:function(){v.updateThreadMuteSetting(this.props.threadID,0);p.hide();},_renderFileUploader:function(){return (l.createElement(w,{className:"_37_x"},l.createElement(g,{onFileUploaderMounted:this.props.onFileUploaderMounted,attachmentsShelf:this.props.attachmentsShelf,onUploadFinished:this.props.onUploadFinished,onUpdateAttachmentsShelf:this.props.onUpdateAttachmentsShelf,onSubmit:this.props.onSubmit})));},_renderOpenFullConversation:function(){if(this.props.fullURL)return (l.createElement(w,{onclick:function(){return u(this.props.fullURL);}.bind(this)},"See Full Conversation"));return null;},_renderAddFriend:function(){if(!this.props.showAddFriend)return null;return (l.createElement(w,{onclick:this.props.showAddFriend},"Add Friends to Chat..."));},_renderTogglePrivacy:function(){if(!this.props.isMultichat){var y=this._privacyActionController.togglePrivacy.bind(this._privacyActionController);return (l.createElement(w,{onclick:y},this.props.privacyText));}return null;},_renderMuteConversation:function(){if(!this.props.isMuted){var y=k.showMuteChangeDialog.bind(null,this.props.threadID);return (l.createElement(w,{onclick:y},"Mute Conversation..."));}else return (l.createElement(w,{onclick:this._unmuteThread},"Unmute Conversation"));},_renderClearConversation:function(){if(!this.props.isMultichat)return (l.createElement(w,{onclick:this.props.clearHistoryFunc},"Clear Window"));return null;},_renderReportSpam:function(){if(!this.props.isMultichat)return (l.createElement(w,{onclick:this.props.reportSpamFunc},"Report as Spam or Abuse..."));return null;},_renderCreateGroup:function(){if(this.props.isMultichat)return (l.createElement(w,{onclick:this.props.createGroupFunc},"Create Group"));return null;},_renderConversationName:function(){if(this.props.isMultichat&&this.props.fullURL)return (l.createElement(w,{onclick:this.props.nameConversationFunc},"Edit Conversation Name"));return null;},_renderLeaveConversation:function(){if(this.props.isMultichat)return (l.createElement(w,{onclick:this.props.leaveConversationFunc},"Leave Conversation..."));return null;},_renderEnableDesktopNotifications:function(){if(j.DesktopNotificationsGK&&"Notification" in window&&Notification.permission!=="granted")return (l.createElement(w,{onclick:this.props.enableDesktopNotif},"Enable Desktop Notifications"));return null;},_renderPeopleList:function(){if(this.props.isMultichat&&this.props.fullURL&&i.get('chat_remove_participants'))return (l.createElement(w,{onclick:this.props.showParticipantsFunc},"Edit Participants..."));return null;},render:function(){var y=this._renderReportSpam(),z=this._renderCreateGroup(),aa=l.createElement(n,{className:(("chatReact")+(!this.props.show?' '+"hidden_elem":''))},this._renderOpenFullConversation(),this._renderFileUploader(),this._renderAddFriend(),this._renderTogglePrivacy(),this._renderConversationName(),this._renderPeopleList(),l.createElement(o,null),this._renderMuteConversation(),this._renderClearConversation(),this._renderLeaveConversation(),y?(l.createElement(o,null)):null,y,z?(l.createElement(o,null)):null,z,this._renderEnableDesktopNotifications()),ba="Options",ca=q.getTrackingInfo(q.types.DROPDOWN_BUTTON);return (l.createElement(m,{menu:aa},l.createElement(l.DOM.a,{'data-ft':ca,'data-hover':"tooltip",'aria-label':ba,'data-tooltip-alignh':"center",className:(("button")+(this.props.isEmptyChat?' '+"hidden_elem":''))})));}});e.exports=x;},null);
__d("ChatDateBreak.react",["React","ReactPropTypes","Timestamp.react","cx","formatDate","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m=g.createClass({displayName:'ChatDateBreak',propTypes:{date:h.instanceOf(Date).isRequired},shouldComponentUpdate:function(n){return this.props.date.getTime()!==n.date.getTime();},render:function(){var n=this.props.date,o=k(n,{today:'g:ia',withinWeek:'l g:ia',thisYear:'F jS, g:ia',older:'F j, Y g:i a'}),p=Math.round(n.getTime()/1000);return (g.createElement(g.DOM.div,Object.assign({},this.props,{className:l(this.props.className,"_5w-5")}),g.createElement(g.DOM.div,{className:"_5w-6"},g.createElement(i,{time:p,verbose:o,text:o}))));}});e.exports=m;},null);
__d("ChatAuthorPhotoBlock.react",["MercuryParticipants","ReactPropTypes","React","cx","formatDate","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m=86400000,n=i.createClass({displayName:'ChatAuthorPhotoBlock',propTypes:{authorID:h.string.isRequired,hideName:h.bool,hidePhoto:h.bool,timestamp:h.number},getInitialState:function(){return {author:{id:null,name:'',href:'#',image_src:''}};},componentDidMount:function(){this.updateAuthor(this.props.authorID);},componentWillReceiveProps:function(o){if(o.authorID!=this.state.author.id)this.updateAuthor(o.authorID);},render:function(){return (i.createElement(i.DOM.div,Object.assign({},this.props,{className:l(this.props.className,"_5yt9")}),this.renderAuthorName(),this.renderAuthorPhoto(),this.props.children));},renderAuthorName:function(){if(!this.props.hideName)return (i.createElement(i.DOM.div,{className:"_5ys-",ref:"name"},this.state.author.name));},renderAuthorPhoto:function(){if(!this.props.hidePhoto){var o=null;if(this.props.timestamp){var p=(Date.now()-this.props.timestamp>m)?'M jS, g:ia':'g:ia';o=k(new Date(this.props.timestamp),p);}return (i.createElement(i.DOM.a,{'aria-label':o,className:"_5ys_",'data-hover':"tooltip",'data-tooltip-position':"left",href:this.state.author.href,ref:"link"},i.createElement(i.DOM.img,{src:this.state.author.image_src,ref:"image"})));}},updateAuthor:function(o){g.get(o,function(p){this.isMounted()&&this.setState({author:p});}.bind(this));}});e.exports=n;},null);
__d("ChatBubble.react",["DOM","DOMDimensions","MercuryMessageRenderer","ReactPropTypes","React","cx","fbt","startsWith","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){var p=null,q=k.createClass({displayName:'ChatBubble',propTypes:{attachments:j.renderable,body:j.string,maxWidth:j.number.isRequired},getInitialState:function(){return {bubbleWidth:this.props.maxWidth};},componentDidMount:function(){this.renderDOMBody();this.shrinkBubble();},componentWillReceiveProps:function(r){if(r.body!=this.props.body)this.setState({bubbleWidth:this.props.maxWidth});},componentDidUpdate:function(r,s){this.renderDOMBody();if(r.body!=this.props.body)this.shrinkBubble();},render:function(){return (k.createElement(k.DOM.div,Object.assign({},this.props,{className:o(this.props.className,"_5w1r"),ref:"bubble",style:Object.assign({},(this.props.style||{}),{maxWidth:this.state.bubbleWidth})}),k.createElement(k.DOM.div,null,k.createElement(k.DOM.span,{className:"_5yl5",ref:"content"},this.renderBody())),this.props.attachments));},renderBody:function(){var r=this.props.body||'';if(n(r,'?OTR'))return (k.createElement(k.DOM.span,{className:"_89h"},"[encrypted message]"));return r;},renderDOMBody:function(){var r=this.props.body||'';if(!n(r,'?OTR'))g.setContent(this.refs.content.getDOMNode(),i.formatMessageBody(r));},shrinkBubble:function(){var r=this.refs.bubble.getDOMNode(),s=this.refs.content.getDOMNode(),t=h.getElementDimensions(r).width,u=h.getElementDimensions(s).width;if(this.contentWraps()&&u>0&&u<this.props.maxWidth&&t-u-this.getBoxWidth()>0&&u!=this.state.bubbleWidth)this.setState({bubbleWidth:u});},contentWraps:function(){var r=this.refs.content.getDOMNode(),s=r.getClientRects(),t=h.getElementDimensions(r).height;return (s&&s.length>1&&s[0].height<t);},getBoxWidth:function(){if(!p)p=h.measureElementBox(this.refs.bubble.getDOMNode(),'width',true,true,false);return p;}});e.exports=q;},null);
__d("MercuryAttachments.react",["MercuryAttachmentRenderer","DOM","Event","ImmutableObject","React","SubscriptionsHandler","arraySort","cx","emptyFunction","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){'use strict';var q=176,r=4,s=k.createClass({displayName:'MercuryAttachments',propTypes:{message:k.PropTypes.instanceOf(j).isRequired,attachments:k.PropTypes.array.isRequired,isChat:k.PropTypes.bool,onImageLoad:k.PropTypes.func,onStickerClick:k.PropTypes.func},getDefaultProps:function(){return {isChat:false,onImageLoad:o,onStickerClick:o};},componentDidMount:function(){this._subscriptionsHandler=new l();this.renderAttachments();},componentDidUpdate:function(){this.renderAttachments();},componentWillUnmount:function(){this._subscriptionsHandler.release();},render:function(){var t=this.props.attachments.filter(g.isPhotoAttachment).length>0;return (k.createElement(k.DOM.div,Object.assign({},this.props,{className:p(this.props.className,(("_5h9y")+(t?' '+"_zl6":'')))})));},renderAttachments:function(){var t=this.getDOMNode();h.empty(t);var u=this.props.message,v=m(this.props.attachments,g.booleanLexicographicComparator([g.isPhotoAttachment,g.isShareAttachment,g.isFileAttachment,g.isErrorAttachment])),w=g.renderPhotoAttachments(v.filter(g.isPhotoAttachment),u,q,r);w&&h.appendContent(t,w);for(var x=0;x<v.length;x++){var y=v[x];if(g.isPhotoAttachment(y))continue;var z=g.renderAttachment(this.props.isChat,y,u,null,null,this.props.onStickerClick);z.error&&h.appendContent(t,z.error);z.content&&h.appendContent(t,z.content);}h.scry(t,'img').forEach(function(aa){this._subscriptionsHandler.addSubscriptions(i.listen(aa,'load',function(){this.props.onImageLoad(aa);}.bind(this)));}.bind(this));}});e.exports=s;},null);
__d("MercurySpoofWarning.react",["MercuryParticipants","ReactPropTypes","React","fbt"],function(a,b,c,d,e,f,g,h,i,j){var k=i.createClass({displayName:'MercurySpoofWarning',propTypes:{authorID:h.string.isRequired},getInitialState:function(){return {author:{name:''}};},componentWillMount:function(){this.componentWillReceiveProps(this.props);},componentWillReceiveProps:function(l){g.get(l.authorID,function(m){return this.setState({author:m});}.bind(this));},render:function(){return (i.createElement(i.DOM.div,Object.assign({},this.props),j._("Unable to confirm {name_or_email} as the sender.",[j.param("name_or_email",this.state.author.name)])));}});e.exports=k;},null);
__d("ChatMessage.react",["ChatAnimatedGifs","ChatAuthorPhotoBlock.react","ChatBubble.react","ChatConfig","CSS","ImmutableObject","MercuryAttachment","MercuryAttachments.react","MercuryAttachmentRenderer","MercuryErrorInfo","MercuryIDs","MercuryMessageError.react","MercurySpoofWarning.react","React","ReactPropTypes","cx","fbt","formatDate","isRTL","joinClasses","MercuryMessages"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z){'use strict';var aa=b('MercuryMessages').get(),ba=t.createClass({displayName:'ChatMessage',propTypes:{message:u.instanceOf(l).isRequired,maxBubbleWidth:u.number.isRequired,onImageLoad:u.func,onStickerClick:u.func},componentDidMount:function(){k.conditionClass(this.getDOMNode(),"_2cnu",this.isOneLine());},isOneLine:function(){var ca=this.props.message;return aa.isInbound(ca)&&!this.refs.attachmentsInside&&this.refs.bubble&&!this.refs.bubble.contentWraps();},shouldComponentUpdate:function(ca,da){return ca.message!==this.props.message;},render:function(){var ca=this.props.message,da=aa.isInbound(ca),ea=q.isMultichat(ca.thread_id),fa=y(ca.body),ga=j.get('chat_fading_bubbles')&&!da&&aa.isSending(ca),ha=p.hasErrorStatus(ca),ia=(("_5wd4")+(da?' '+"_1nc7":'')+(!da?' '+"_1nc6":'')+(da&&ea?' '+"_5ysy":'')+(ga?' '+"_4oe5":'')+(ha?' '+"_1zcs":'')+(fa?' '+"direction_rtl":'')+(!fa?' '+"direction_ltr":'')),ja=new Date(ca.timestamp);return (t.createElement(h,Object.assign({},this.props,{authorID:ca.author,className:z(this.props.className,ia),hideName:!da||!ea,hidePhoto:!da,timestamp:ca.timestamp,title:da?null:x(ja,'g:ia')}),this._renderInner(),this._renderUndertext()));},_renderInner:function(){if(this.props.message.is_filtered_content)return (t.createElement(t.DOM.div,{className:"_5wd9",ref:"inner"},this._renderFilteredContent()));return (t.createElement(t.DOM.div,{className:"_5wd9",ref:"inner"},this._renderBubble(),this._renderAttachments('outside')));},_renderUndertext:function(){if(this.props.message.is_filtered_content)return null;return (t.createElement(t.DOM.div,{className:"_3ry4",ref:"undertext"},t.createElement(r,{className:"_5wda clearfix",message:this.props.message,ref:"status"}),this._renderSpoofWarning()));},_renderSpoofWarning:function(){return (this.props.message.is_spoof_warning?t.createElement(s,{authorID:this.props.message.author,className:"_5wdb"}):null);},_renderFilteredContent:function(){return t.createElement(t.DOM.div,{className:"_5wdc uiBoxYellow clearfix"},"This message is no longer available because it was identified as abusive or marked as spam.");},_renderAttachments:function(ca){var da=this.props.message,ea=ca=='inside'?'attachmentsInside':'attachmentsOutside',fa=m.get(da).filter(function(ga){var ha=o.isBubblePreferred(ga);return (ha&&ca==='inside')||(!ha&&ca==='outside');});if(fa.length>0)return t.createElement(n,{className:"_5wdd clearfix",isChat:true,message:da,attachments:fa,ref:ea,onImageLoad:this.props.onImageLoad,onStickerClick:this.props.onStickerClick});},_renderBubble:function(){var ca=this.props.message,da=ca.body,ea=this._renderAttachments('inside');if(g.shouldHideBody(ca))da='';if(da||ea)return (t.createElement(t.DOM.div,{className:"_5wde"},t.createElement(i,{attachments:ea,body:da,className:"_5wdf",maxWidth:this.props.maxBubbleWidth,ref:"bubble"})));}});e.exports=ba;},null);
__d("ChatVideoCallLink.react",["Arbiter","ChatVisibility","MercuryParticipants","PresencePrivacy","React","ReactPropTypes","SubscriptionsHandler","VideoCallCore","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){var q=k.createClass({displayName:'ChatVideoCallLink',propTypes:{message:l.object.isRequired,onClick:l.func.isRequired},componentDidMount:function(){this._subscriptions=new m();this._subscriptions.addSubscriptions(g.subscribe(['buddylist/availability-changed'],this.availabilityChanged),j.subscribe(['privacy-changed','privacy-availability-changed'],this.availabilityChanged));},componentWillUnmount:function(){this._subscriptions.release();},render:function(){return (k.createElement(k.DOM.a,{className:(("callBackLink")+(this.shouldHideLink()?' '+"hidden_elem":'')),'data-gt':JSON.stringify({videochat:'clicked_callback_link'}),href:"#",onClick:this.linkClicked},this.renderLinkText()));},renderLinkText:function(){if(this.props.message.log_message_data.event_name=='install_canceled'){return ("Retry setup and call back.");}else if(!this.props.message.log_message_data.event_name&&this.props.message.log_message_data.callee==i.user&&!this.props.message.log_message_data.answered)return ("Call back.");},shouldHideLink:function(){return !h.isOnline()||!n.availableForCall(this.props.message.log_message_data.to);},linkClicked:function(){var r;if(this.props.message.log_message_data.event_name=='install_canceled'){r='callback_cancelinstall_link';}else if(!this.props.message.log_message_data.event_name&&this.props.message.log_message_data.callee==i.user&&!this.props.message.log_message_data.answered)r='callback_link';this.props.onClick(this.props.message.log_message_data.to,this.props.message.thread_id,r);},availabilityChanged:function(){this.forceUpdate();}});e.exports=q;},null);
__d("MercuryLogMessage.react",["DOM","Event","ChatVideoCallLink.react","ImmutableObject","MercuryLogMessageRenderer","MercuryLogMessageType","React","ReactPropTypes","VideoCallSupport","cx","emptyFunction","formatDate","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){'use strict';var t=m.createClass({displayName:'MercuryLogMessage',propTypes:{message:n.instanceOf(j).isRequired,onImageLoad:n.func,onVideoCallLinkClick:n.func},getDefaultProps:function(){return {onImageLoad:q};},getInitialState:function(){return {messageText:null};},componentDidMount:function(){this.componentWillReceiveProps(this.props);},componentWillReceiveProps:function(u){k.renderText(u.message,function(v){this.setState({messageText:v});}.bind(this));},shouldComponentUpdate:function(u,v){return this.state.messageText!=v.messageText;},componentDidUpdate:function(){var u=this.refs.attachment.getDOMNode();k.renderAttachmentLegacy(u,this.props.message);g.scry(u,'img').forEach(function(v){var w=h.listen(v,'load',function(){this.props.onImageLoad(v);w.remove();}.bind(this));}.bind(this));},render:function(){return (m.createElement(m.DOM.div,Object.assign({},this.props,{className:s(this.props.className,"_5ye6"),title:r(new Date(this.props.message.timestamp),'g:ia')}),k.renderIcon(this.props.message),m.createElement(m.DOM.div,{className:"_5ye7"},this.state.messageText,this.renderVideoCallLink()),m.createElement(m.DOM.div,{className:"_5ye8",ref:"attachment"})));},renderVideoCallLink:function(){if(this.props.message.log_message_type!==l.VIDEO_CALL||!this.props.onVideoCallLinkClick||!o.isVideoCallSupported())return null;return (m.createElement(i,{message:this.props.message,onClick:this.props.onVideoCallLinkClick}));}});e.exports=t;},null);
__d("ChatConversation.react",["ChatConfig","ChatDateBreak.react","ChatMessage.react","CurrentUser","MercuryConstants","ImmutableObject","MercuryActionTypeConstants","MercuryLogMessage.react","React","cx","invariant","OrionMercuryReceiverNUX"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){'use strict';var r=b('OrionMercuryReceiverNUX').module,s=k.MercurySupportedShareType,t=1000*60*60,u=o.createClass({displayName:'ChatConversation',propTypes:{maxBubbleWidth:o.PropTypes.number.isRequired,messages:o.PropTypes.arrayOf(o.PropTypes.instanceOf(l)).isRequired,onCallLinkClick:o.PropTypes.func,onImageLoad:o.PropTypes.func,onStickerClick:o.PropTypes.func},componentWillReceiveProps:function(v){q(v.maxBubbleWidth===this.props.maxBubbleWidth);},render:function(){var v=this.props.messages,w=[];for(var x=0;x<v.length;x++){var y=v[x],z=(x>0)?v[x-1]:null;if(y.is_cleared)continue;if(!z||z.is_cleared||y.timestamp-z.timestamp>t)w.push(o.createElement(h,{date:new Date(y.timestamp),key:'db:'+y.message_id}));if(y.action_type==m.LOG_MESSAGE){w.push(o.createElement(n,{className:"_5w0o",key:y.message_id,message:y,onImageLoad:this.props.onImageLoad,onCallLinkClick:this.props.onCallLinkClick}));}else w.push(o.createElement(i,{key:y.message_id,message:y,maxBubbleWidth:this.props.maxBubbleWidth,onImageLoad:this.props.onImageLoad,onStickerClick:this.props.onStickerClick}));if(r&&!g.get('orion_receiver_nux_completed')&&y.attachments&&y.attachments.length&&y.attachments[0].share_data_type===s.FB_ORION&&y.attachments[0].metadata&&y.attachments[0].metadata.receiver&&y.attachments[0].metadata.receiver.id===j.getID()){var aa=y.attachments[0],ba=aa.metadata;w.push(o.createElement(r,{key:'omrn:'+y.message_id,amount:ba.amount,currency:ba.currency,creationTime:ba.creationTime,onImageLoad:this.props.onImageLoad,sender:ba.sender}));}}return o.createElement(o.DOM.div,null,w);}});e.exports=u;},null);
__d("ChatTypingIndicators.react",["ChatAuthorPhotoBlock.react","DOM","MercuryIDs","MercuryParticipants","ReactPropTypes","React","SubscriptionsHandler","Tooltip","MercuryTypingReceiver","arraySort","createObjectFrom","cx","emptyFunction","fbt","MercuryThreadInformer"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){var u=b('MercuryThreadInformer').get(),v=l.createClass({displayName:'ChatTypingIndicators',propTypes:{indicatorsWillShow:k.func,indicatorsDidShow:k.func,threadID:k.string.isRequired},getDefaultProps:function(){return {indicatorsWillShow:s,indicatorsDidShow:s};},getInitialState:function(){return {typingUserIDs:[]};},componentDidMount:function(){this._subscriptions=new m();this._subscriptions.addSubscriptions(o.addRetroactiveListener('state-changed',this.typingStateChanged),u.subscribe('messages-received',this.messagesReceived));},componentWillReceiveProps:function(w){if(w.threadID!=this.props.threadID)this.setState({typingUserIDs:[]});},componentWillUpdate:function(w,x){if(x.typingUserIDs.length>0)this.props.indicatorsWillShow();},componentDidUpdate:function(){if(this.state.typingUserIDs.length>0)this.props.indicatorsDidShow();j.getMulti(this.state.typingUserIDs,function(w){if(this.isMounted())this.state.typingUserIDs.forEach(function(x){var y=w[x];n.set(this.refs[x].getDOMNode(),this.renderTooltip(y.short_name),'above','left');}.bind(this));}.bind(this));},componentWillUnmount:function(){this._subscriptions.release();},render:function(){var w=i.isMultichat(this.props.threadID);return (l.createElement(l.DOM.div,{className:"_2fsr"},this.state.typingUserIDs.map(function(x){return l.createElement(g,{authorID:x,className:(("_gfq")+(w?' '+"_52fu":'')),hideName:!w,key:x},l.createElement(l.DOM.div,{className:"_52ft"},l.createElement(l.DOM.div,{className:"_gfp",ref:x})));})));},renderTooltip:function(w){var x=h.create('span');l.renderComponent(l.createElement(l.DOM.span,null,t._("{name} is typing...",[t.param("name",w)])),x);return x;},typingStateChanged:function(w){if(this.props.threadID in w)this.setState({typingUserIDs:p(w[this.props.threadID])});},messagesReceived:function(w,x){if(this.props.threadID in x){var y=x[this.props.threadID],z=q(y.map(function(aa){return aa.author;}));this.setState({typingUserIDs:p(this.state.typingUserIDs.filter(function(aa){return !z[aa];}))});}}});e.exports=v;},null);
__d("MercuryTypingAnimation.react",["React","cx","joinClasses"],function(a,b,c,d,e,f,g,h,i){'use strict';var j=g.createClass({displayName:'MercuryTypingAnimation',propTypes:{color:g.PropTypes.oneOf(['light','dark'])},getDefaultProps:function(){return {color:'dark'};},render:function(){var k=(("_4a0v")+(this.props.color==='light'?' '+"_4a0w":'')+(this.props.color==='dark'?' '+"_4a0x":''));return (g.createElement(g.DOM.div,{className:i(this.props.className,k)},g.createElement(g.DOM.div,{className:"_4b0g"},g.createElement(g.DOM.div,{className:"_4a0y"}),g.createElement(g.DOM.div,{className:"_4a0y"}),g.createElement(g.DOM.div,{className:"_4a0y"}))));}});e.exports=j;},null);
__d("MercuryTypingIndicator",["Animation","ChatConfig","CSS","DOM","MercuryTypingAnimation.react","MercuryTypingReceiver","MercuryParticipants","React","Style","ChatTabTemplates","Tooltip","copyProperties","cx","csx","tx","MercuryThreadInformer"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){var v=b('MercuryThreadInformer').get(),w=[];v.subscribe('messages-received',function(z,aa){w.forEach(function(ba){var ca=aa[ba._threadID];ca&&ba.receivedMessages(ca);});});l.addRetroactiveListener('state-changed',function(z){w.forEach(function(aa){var ba=z[aa._threadID];ba&&aa._handleStateChanged(ba);});});function x(z){var aa=p[':fb:chat:conversation:message-group'].build(),ba=p[':fb:mercury:typing-indicator:typing'].build();i.addClass(aa.getRoot(),"_50kd");var ca=aa.getNode('profileLink');q.set(ca,z.name,'left');ca.href=z.href;aa.setNodeContent('profileName',z.name);aa.setNodeProperty('profilePhoto','src',z.image_src);var da=u._("{name} is typing...",{name:z.short_name});q.set(ba.getRoot(),da,'above');j.appendContent(aa.getNode('messages'),ba.getRoot());return aa;}function y(z,aa,ba){this._animations={};this._activeUsers={};this._typingIndicator=aa;this._messagesView=ba;this._threadID=z;this._subscription=l.addRetroactiveListener('state-changed',function(ca){var da=ca[this._threadID];da&&this._handleStateChanged(da);}.bind(this));w.push(this);}r(y.prototype,{destroy:function(){Object.keys(this._activeUsers).forEach(this._removeUserBubble.bind(this));this._controller.destroy();w.remove(this);},receivedMessages:function(z){z.forEach(function(aa){if(!m.isAuthor(aa.author))this._removeUserBubble(aa.author);}.bind(this));},_handleStateChanged:function(z){for(var aa in this._activeUsers)if(z.indexOf(aa)===-1){this._slideOutUserBubble(aa);delete this._activeUsers[aa];}if(z.length)m.getMulti(z,function(ba){var ca=this._messagesView.isScrolledToBottom(),da={};for(var ea in ba){var fa=this._activeUsers[ea];da[ea]=fa||x(ba[ea]).getRoot();if(!fa){j.appendContent(this._typingIndicator,da[ea]);if(h.get('chat_thread_typing_indicator_animated')){var ga=j.scry(this._typingIndicator,"._510u");for(var ha=0,ia=ga.length;ha<ia;ha++)n.renderComponent(n.createElement(k,{className:"_3e2s"}),ga[ha]);}}}var ja=Object.keys(da).length>0;ca&&this._messagesView.scrollToBottom(ja);this._activeUsers=da;}.bind(this));},_removeUserBubble:function(z,aa){var ba=this._getCurrentAnimation(z,aa);if(ba){ba.animation.stop();j.remove(ba.elem);delete this._animations[z];}if(z in this._activeUsers){j.remove(this._activeUsers[z]);delete this._activeUsers[z];}if(aa&&h.get('chat_thread_typing_indicator_animated')){var ca=j.scry(aa,"._510u");for(var da=0,ea=ca.length;da<ea;da++)n.unmountComponentAtNode(ca[da]);}aa&&j.remove(aa);},_slideOutUserBubble:function(z){var aa=this._activeUsers[z];if(this._getCurrentAnimation(z,aa)){return;}else if(aa){o.set(aa,'overflow','hidden');var ba=(new g(aa)).from('opacity',1).from('height',aa.offsetHeight).to('height',0).to('opacity',0).ease(g.ease.end).duration(250).ondone(this._removeUserBubble.bind(this,z,aa)).go();this._animations[z]={animation:ba,elem:aa};}},_getCurrentAnimation:function(z,aa){if(this._animations[z]&&(!aa||this._animations[z].elem===aa))return this._animations[z];}});e.exports=y;},null);
__d("MercuryMessageList",["ImmutableObject","LogHistory","OrderedMap","setTimeoutAcrossTransitions"],function(a,b,c,d,e,f,g,h,i,j){'use strict';var k=h.getInstance('mercury_message_list');function l(q){this.$MercuryMessageList0=n(q?m(q):[]);}l.prototype.append=function(q){this.$MercuryMessageList0=this.$MercuryMessageList0.merge(n(m(q)));p('append',q);};l.prototype.prepend=function(q){this.$MercuryMessageList0=n(m(q)).merge(this.$MercuryMessageList0);p('prepend',q);};l.prototype.update=function(q){var r=q.filter(function(s){return this.contains(s);}.bind(this));if(r.length===0)return;this.$MercuryMessageList0=this.$MercuryMessageList0.merge(n(m(r)));p('update',q);};l.prototype.reorder=function(q){this.$MercuryMessageList0=n(q.map(function(r){var s=this.$MercuryMessageList0.get(r.message_id);if(!s||s.timestamp!=r.timestamp||s.is_cleared!=r.is_cleared)return new g(r);return s;}.bind(this)));p('reorder',q);};l.prototype.hasReachedClearedMessages=function(){var q=this.messageAt(0);return !!(q&&q.is_cleared);};l.prototype.messageAt=function(q){var r=this.$MercuryMessageList0.keyAtIndex(q);return r?this.$MercuryMessageList0.get(r):undefined;};l.prototype.contains=function(q){return this.$MercuryMessageList0.indexOfKey(o(q))!==undefined;};l.prototype.toArray=function(){return this.$MercuryMessageList0.toArray();};l.prototype.toOrderedMap=function(){return this.$MercuryMessageList0;};function m(q){return q.map(function(r){return new g(r);});}function n(q){return i.fromArray(q,o);}function o(q){return q.message_id;}function p(event,q){j(function(){k.debug(event,{messageIDs:q.map(function(r){return r.message_id;})});},0);}e.exports=l;},null);
__d("MercuryMessageStore",["MercuryAPIArgsSource","LogHistory","MercuryMessageList","MercuryParticipants","SubscriptionsHandler","MercuryThreadlistConstants","copyProperties","merge","mixInEventEmitter","setTimeoutAcrossTransitions","MercuryMessages","MercuryThreads","MercuryThreadInformer"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){'use strict';var q=b('MercuryMessages').get(),r=b('MercuryThreads').get(),s=b('MercuryThreadInformer').get(),t=h.getInstance('mercury_message_store');function u(w){this.$MercuryMessageStore0=w;this.$MercuryMessageStore1=new i();this.$MercuryMessageStore2=1;this.$MercuryMessageStore3=null;this.$MercuryMessageStore4=0;this.$MercuryMessageStore5=new k();this.$MercuryMessageStore5.addSubscriptions(s.subscribe('messages-received',function(x,y){return this.$MercuryMessageStore7(y);}.bind(this)),s.subscribe('messages-updated',function(x,y){return y[this.$MercuryMessageStore0]&&this.$MercuryMessageStore8(y[this.$MercuryMessageStore0]);}.bind(this)),s.subscribe('messages-reordered',function(x,y){return y[this.$MercuryMessageStore0]&&this.$MercuryMessageStore9();}.bind(this)));t.debug('constructed',{threadID:this.$MercuryMessageStore0});this.$MercuryMessageStorea();}u.prototype.setNewThreadID=function(w){this.$MercuryMessageStoreb=w;};u.prototype.destroy=function(){this.$MercuryMessageStore5&&this.$MercuryMessageStore5.release();t.debug('destroyed',{threadID:this.$MercuryMessageStore0});};u.prototype.subscribe=function(w){return this.addRetroactiveListener('updated',w);};u.prototype.fetchMoreMessages=function(){if(q.hasLoadedExactlyNMessages(this.$MercuryMessageStore0,this.$MercuryMessageStore4)&&q.hasLoadedAllMessages(this.$MercuryMessageStore0))return false;if(r.isNewEmptyLocalThread(this.$MercuryMessageStore0))return false;if(this.$MercuryMessageStore1.hasReachedClearedMessages())return false;return this.$MercuryMessageStorea();};u.prototype.$MercuryMessageStorea=function(){var w=this.$MercuryMessageStore4+l.RECENT_MESSAGES_LIMIT*this.$MercuryMessageStore2;t.debug('fetching',{threadID:this.$MercuryMessageStore0,limit:w});q.getThreadMessagesRange(this.$MercuryMessageStore0,0,w,this.$MercuryMessageStorec.bind(this),null,g.MERCURY);if(this.$MercuryMessageStore2<10)this.$MercuryMessageStore2+=1;if(q.hasLoadedNMessages(this.$MercuryMessageStore0,w)){this.$MercuryMessageStore9();return false;}return true;};u.prototype.$MercuryMessageStorec=function(w){if(w&&w.length){this.$MercuryMessageStore3=w[0].timestamp;this.$MercuryMessageStore4=w.length;t.debug('fetched',{threadID:this.$MercuryMessageStore0,earliestMessageTimestamp:this.$MercuryMessageStore3,count:this.$MercuryMessageStore4});}};u.prototype.$MercuryMessageStore7=function(w){var x=[],y=w[this.$MercuryMessageStore0];if(y&&y.length)x=x.concat(y);if(this.$MercuryMessageStoreb){var z=w[this.$MercuryMessageStoreb];if(z&&z.length){x=x.concat(z);this.$MercuryMessageStoreb=null;}}if(x.length){this.$MercuryMessageStore1.append(x);this.$MercuryMessageStore4+=x.length;var aa=x.every(function(ba){return ba.author!=j.user;});this.$MercuryMessageStored(u.MESSAGES_RECEIVED,{allFromOthers:aa});}};u.prototype.$MercuryMessageStore8=function(w){this.$MercuryMessageStore1.update(q.getMessagesFromIDs(Object.keys(w)));this.$MercuryMessageStoree();this.$MercuryMessageStored(u.MESSAGES_CHANGED);};u.prototype.$MercuryMessageStore9=function(){if(!this.$MercuryMessageStore3)return;this.$MercuryMessageStore1.reorder(q.getThreadMessagesSinceTimestamp(this.$MercuryMessageStore0,this.$MercuryMessageStore3));this.$MercuryMessageStoree();this.$MercuryMessageStored(u.MESSAGES_REORDERED);};u.prototype.$MercuryMessageStored=function(w,x){var y=this.$MercuryMessageStore1.toArray();this.releaseHeldEventType('updated');this.emitAndHold('updated',n({messages:y,eventType:w},x));v(this.$MercuryMessageStore0,w,y);};u.prototype.$MercuryMessageStoree=function(){var w=this.$MercuryMessageStore1.messageAt(0);if(w)this.$MercuryMessageStore3=w.timestamp;};function v(w,x,y){p(function(){t.debug('update:'+x,{threadID:w,messageIDs:y.map(function(z){return z.message_id;})});},0);}m(u,{MESSAGES_FETCHED:'fetched',MESSAGES_CHANGED:'changed',MESSAGES_RECEIVED:'received',MESSAGES_REORDERED:'reordered'});o(u,{updated:true});e.exports=u;},null);
__d("ChatTabMessagesView",["Animation","Arbiter","ArbiterMixin","BanzaiLogger","ChatConfig","ChatConversation.react","ChatTypingIndicators.react","CSS","DOM","Event","MercuryLastMessageIndicator.react","LiveTimer","MercuryTypingIndicator","MercuryMessageStore","MercuryParticipants","React","ServerTime","StickerActions","StickerState","StickerStoreController","Style","SubscriptionsHandler","UserAgent_DEPRECATED","arrayContains","copyProperties","getElementPosition","throttle"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga){'use strict';var ha=70,ia=null,ja=20;function ka(ma){if(ia===null){var na=ma.childNodes[0];aa.set(ma,'overflow','scroll');ia=na.clientWidth-ha;aa.set(ma,'overflow','');}return ia;}function la(ma,na,oa,pa,qa,ra,sa,ta){this.loadingIcon=qa;this.threadID=ma;this.sheetController=na;this.scrollContainer=oa;this.conversationElem=pa;this.tabView=ta;r.restart(w.get()/1000);this._loadingMoreMessages=false;function ua(){la.inform('interaction-with-tab',ma);}this._subscriptions=new ba();this._subscriptions.addSubscriptions(h.subscribe('overflow-applied-to-body',this.scrollToBottom.bind(this)),p.listen(this.scrollContainer,'mousedown',ua));if(ca.firefox()){var va=('WheelEvent' in window)?'wheel':'DOMMouseScroll';this.scrollContainer.addEventListener(va,ua,false);}else this._subscriptions.addSubscriptions(p.listen(this.scrollContainer,'mousewheel',ua));this._subscriptions.addSubscriptions(p.listen(this.scrollContainer,'scroll',ga(this.scrolling,50,this)));if(k.get('chat_react')){var wa;v.renderComponent(v.createElement(m,{threadID:this.threadID,indicatorsWillShow:function(){return wa=this.isScrolledToBottom();}.bind(this),indicatorsDidShow:function(){return wa&&this.scrollToBottom(true);}.bind(this)}),sa);}else this.typingIndicator=new s(this.threadID,sa,this);var xa;this.lastMessageIndicatorNode=ra;this.lastMessageIndicator=v.renderComponent(v.createElement(q,{threadID:this.threadID,hideTyping:true,indicatorWillShow:function(){return xa=this.isScrolledToBottom();}.bind(this),indicatorDidShow:function(){return xa&&this.scrollToBottom(true);}.bind(this)}),this.lastMessageIndicatorNode);this.initializeConversation();}ea(la,i);ea(la.prototype,{initializeConversation:function(){this._store=new t(this.threadID);this._conversation=v.renderComponent(v.createElement(l,{maxBubbleWidth:ka(this.scrollContainer),messages:[],onImageLoad:function(ma){var na=this.scrollContainer,oa=na.scrollTop+na.clientHeight;if(oa+ma.offsetHeight>=na.scrollHeight)this.scrollToBottom();}.bind(this),onStickerClick:this._onStickerClick.bind(this),onCallLinkClick:function(ma,na,oa){la.inform('video-call-clicked',{userID:ma,threadID:na,clickSource:oa});}}),this.conversationElem);this._subscriptions.addSubscriptions(this._store.subscribe(function(ma){if(ma.eventType==t.MESSAGES_RECEIVED&&ma.allFromOthers&&!this.isScrolledToBottom()){this.sheetController.openNewMessagesSheet();this._newMessagesSheetOpened=true;}if(ma.eventType==t.MESSAGES_REORDERED){this._loadingMoreMessages=false;n.hide(this.loadingIcon);}var na=this.isScrolledToBottom(),oa=this._getLoadingHeight(),pa=this.scrollContainer.scrollHeight,qa=this.scrollContainer.scrollTop,ra=ma.messages;this._conversation.setProps({messages:ra},function(){if(na){this.scrollToBottom();}else if(ma.eventType==t.MESSAGES_REORDERED)this.scrollToPosition(this.scrollContainer.scrollHeight-pa-oa+qa);}.bind(this));this.lastMessageIndicator.setProps({lastMessage:ra.length>0?ra[ra.length-1]:null});if(ma.eventType==t.MESSAGES_RECEIVED&&this._shouldShowStickerReplyNUX(ra)&&this.tabView&&this.tabView.isFocused())this.tabView.showStickerReplyNUX();}.bind(this)));},scrolling:function(){this._checkToAnimateSticker();if(this.isScrolledNearTop()&&!this._loadingMoreMessages&&!this.isScrolledToBottom()&&!this.tabView._isDragDropActive)if(this._store.fetchMoreMessages()){n.show(this.loadingIcon);this._loadingMoreMessages=true;}if(!this._newMessagesSheetOpened)return;if(this.isScrolledToBottom()){this.sheetController.closeNewMessagesSheet();this._newMessagesSheetOpened=false;}},getScrollTop:function(){return this.scrollContainer&&this.scrollContainer.scrollTop;},destroy:function(){o.scry(this.conversationElem,'.stickerContainer').forEach(function(ma){return v.unmountComponentAtNode(ma);});v.unmountComponentAtNode(this.conversationElem);this._subscriptions&&this._subscriptions.release();v.unmountComponentAtNode(this.lastMessageIndicatorNode);delete this.lastMessageIndicator;this._store&&this._store.destroy();this.destroyed=true;},_getLoadingHeight:function(){return this.loadingHeight||this.loadingIcon.clientHeight;},_shouldShowStickerReplyNUX:function(ma){if(!y.shouldShowStickerReplyNUX()||!ma.length)return false;var na=ma[ma.length-1];if(na.author===u.user)return false;if(na.has_attachment)return na.attachments.some(function(oa){return oa.attach_type==='sticker';});return false;},isScrolledToBottom:function(ma){var na=this.scrollContainer;ma=ma||ja;return na.scrollTop+na.clientHeight>=na.scrollHeight-ma;},isScrolledNearTop:function(){return this.scrollContainer.scrollTop<this.scrollContainer.clientHeight;},scrollToBottom:function(ma){this.scrollToPosition(this.scrollContainer.scrollHeight,ma);},scrollToPosition:function(ma,na){this._scrollTopAnimation&&this._scrollTopAnimation.stop();if(na===true){this._scrollTopAnimation=(new g(this.scrollContainer)).to('scrollTop',ma).ease(g.ease.end).duration(400).go();}else this.scrollContainer.scrollTop=ma;},_onStickerClick:function(ma,na){if(!ma)return;j.log('StickersLoggerConfig',{event:'click_sticker',packid:ma,stickerid:na});var oa=this.tabView;y.onTrayDataReady(function(){if(da(y.getPackIDsInTray(),ma)){var pa=y.getPack(ma);if(pa&&pa.isPromoted)x.addPack(ma);oa.setStickersFlyoutPackID(ma);}else z.showStore(ma);});},_checkToAnimateSticker:function(){var ma=fa(this.scrollContainer);h.inform('chatScrolled/'+this.threadID,{scrollTop:this.scrollContainer.scrollTop,top:ma.y,viewHeight:ma.height});},setNewThreadID:function(ma){this._store.setNewThreadID(ma);}});e.exports=la;},null);
__d("ChatAddFriendsTabSheetRawRenderer",["ContextualTypeaheadView","DOM","Event","MercuryDataSourceWrapper","MercuryTypeahead","ChatTabTemplates","fbt","tx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o={render:function(p,q,r,s,t,u){var v=u?l[':fb:mercury:chat:tab-sheet:add-friends-empty-tab'].build():l[':fb:mercury:chat:tab-sheet:add-friends'].build(),w=u?j.source:j.add_people_source,x=new k(w,g);x.setExcludedParticipantsFromThreadMeta(s);if(!u)x.setPlaceholder("Add friends to this chat");x.build();h.replace(v.getNode('participantsTypeahead'),x.getElement());h.setContent(r,v.getRoot());x.getTokenizer().adjustWidth();var y=v.getNode('participantsTypeahead').getAttribute('data-labelid'),z=h.scry(x.getElement(),'input[type="text"]')[0];if(z)if(y){z.setAttribute('aria-labelledby',y);}else z.setAttribute('aria-label',"To");x.focus();if(!u){var aa=function(){var ba=x.getSelectedParticipantIDs();if(ba.length)t(ba);q.close(p);};i.listen(v.getNode('doneButton'),'click',aa);x.subscribe('tokens-return',function(){if(x.getTokens().length)aa();});}return x;}};e.exports=o;},null);
__d("MultiChatController",["AsyncSignal","ChatOpenTab","copyProperties","Form","MercuryMessages","MercuryServerRequests","MercuryThreads"],function(a,b,c,d,e,f,g,h,i,j){var k=b('MercuryMessages').get(),l=b('MercuryServerRequests').get(),m=b('MercuryThreads').get();function n(){}i(n,{subscribe:function(o,p){o.subscribe('confirm',function(){this.createGroupThreadFromChooserDialog(o,p);}.bind(this));},createGroupThreadFromChooserDialog:function(o,p){var q=j.serialize(o.getRoot()),r=JSON.parse(q.profileChooserItems),s=[];for(var t in r)if(r[t])s.push(t);var u=n.createThreadForFBIDs(s);l.subscribe('update-thread-ids',function(v,w){for(var x in w)if(w[x]==u)new g('/ajax/groups/chat/log',{group_id:p,message_id:x}).send();});o.hide();},createThreadForTokens:function(o){if(!o.length)return;var p;if(o.length==1){p='user:'+o[0].split(':')[1];}else p='root:'+k.generateNewClientMessageID(Date.now());m.createNewLocalThread(p,o);h.openThread(p,'MultiChatController');},createThreadForFBIDs:function(o){var p=[];for(var q=0;q<o.length;q++)p.push("fbid:"+o[q]);return n.createThreadForTokens(p);}});e.exports=n;},null);
__d("ChatAddFriendsTabSheet",["ArbiterMixin","ChatAddFriendsTabSheetRawRenderer","ChatOpenTab","MercuryLogMessageType","MercurySourceType","MultiChatController","Style","copyProperties","MercuryMessages","MercuryThreads"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o=b('MercuryMessages').get(),p=b('MercuryThreads').get();function q(t,u,v){this._threadID=t;this._rootElement=u;this._sheetView=v;this._typeahead=null;}n(q.prototype,g,{render:function(){p.getThreadMeta(this._threadID,function(t){var u=t.is_canonical_user?r:s;this._typeahead=h.render(this,this._sheetView,this._rootElement,t,u.bind(null,t),p.isNewEmptyLocalThread(this._threadID));this._typeahead.subscribe('tokens-changed',function(){this.inform('chat/tokens-changed',{token_count:this._typeahead.getTokens().length});}.bind(this));this._typeahead.subscribe('resize',function(){this._sheetView.resize();}.bind(this));}.bind(this));},getParticipants:function(){if(!this._typeahead)return null;return this._typeahead.getSelectedParticipantIDs();},isPermanent:function(){return true;},isSheetWithInput:function(){return true;},getType:function(){return 'add_friends_type';},open:function(){this._sheetView.open(this);},close:function(){this._sheetView.close(this);},getHeight:function(){return m.get(this._rootElement,'height');}});function r(t,u){var v=t.participants;l.createThreadForTokens(v.concat(u));}function s(t,u){var v=t.thread_id;if(p.isEmptyLocalThread(v)){p.addParticipantsToThreadLocally(v,u);}else o.sendMessage(o.constructLogMessageObject(k.CHAT_WEB,v,j.SUBSCRIBE,{added_participants:u}));i.openThread(v,'ChatAddFriendsTabSheet');}e.exports=q;},null);
__d("ChatNameConversationTabSheetRawRenderer",["DOM","Event","Input","Keys","ChatTabTemplates","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l){"use strict";var m={render:function(n,o,p,q,r,s){var t=k[':fb:mercury:chat:tab-sheet:name-conversation'].build(),u=t.getNode('nameInput'),v=t.getNode('doneButton'),w="Done",x="Hide",y=q.name;if(y){i.setValue(u,y);}else g.setContent(v,x);var z=function(){var aa=i.getValue(u);if(aa)r(aa);s();o.close(n);};h.listen(u,'input',function(){g.setContent(v,i.getValue(u).length===0?x:w);});h.listen(v,'click',z);h.listen(u,'keyup',function(aa){if(aa.keyCode===j.RETURN){z();return false;}});g.setContent(p,t.getRoot());!n.isAutomatic()&&u.focus();}};e.exports=m;},null);
__d("ChatNameConversationTabSheet",["AsyncRequest","ChatNameConversationTabSheetRawRenderer","MercuryAPIArgsSource","MercuryLogMessageType","MercurySourceType","MercuryMessages","MercuryServerRequests","MercuryThreads"],function(a,b,c,d,e,f,g,h,i,j,k){var l=b('MercuryMessages').get(),m=b('MercuryServerRequests').get(),n=b('MercuryThreads').get(),o='/ajax/chat/multichat/name_conversation/dismiss.php',p={};function q(r,s,t){"use strict";this.$ChatNameConversationTabSheet0=r;this.$ChatNameConversationTabSheet1=s;this.$ChatNameConversationTabSheet2=t;this.$ChatNameConversationTabSheet3=false;}q.prototype.render=function(){"use strict";n.getThreadMeta(this.$ChatNameConversationTabSheet0,function(r){h.render(this,this.$ChatNameConversationTabSheet2,this.$ChatNameConversationTabSheet1,r,this.$ChatNameConversationTabSheet4.bind(null,r),this.$ChatNameConversationTabSheet5.bind(this,r));this.$ChatNameConversationTabSheet2.resize();}.bind(this));};q.prototype.isPermanent=function(){"use strict";return true;};q.prototype.isSheetWithInput=function(){"use strict";return true;};q.prototype.getType=function(){"use strict";return 'name_conversation_type';};q.prototype.open=function(r){"use strict";this.$ChatNameConversationTabSheet3=r;if(!(this.$ChatNameConversationTabSheet3&&this.$ChatNameConversationTabSheet6()))this.$ChatNameConversationTabSheet2.open(this);};q.prototype.close=function(){"use strict";this.$ChatNameConversationTabSheet2.close(this);};q.prototype.isAutomatic=function(){"use strict";return this.$ChatNameConversationTabSheet3;};q.prototype.$ChatNameConversationTabSheet6=function(){"use strict";return !!p[this.$ChatNameConversationTabSheet0];};q.prototype.$ChatNameConversationTabSheet7=function(){"use strict";p[this.$ChatNameConversationTabSheet0]=true;};q.prototype.$ChatNameConversationTabSheet5=function(r){"use strict";if(!r.name_conversation_sheet_dismissed||!this.$ChatNameConversationTabSheet6()){this.$ChatNameConversationTabSheet7();m.getServerThreadID(r.thread_id,function(s){new g(o).setData({thread_id:s}).send();});}};q.prototype.$ChatNameConversationTabSheet4=function(r,s){"use strict";var t=r.name;if((s||t)&&(s!=t))l.sendMessage(l.constructLogMessageObject(k.CHAT_WEB,r.thread_id,j.THREAD_NAME,{name:s}),null,i.CHAT);};e.exports=q;},null);
__d("ChatNewMessagesTabSheet",["Event","ArbiterMixin","DOM","ChatTabTemplates","copyProperties"],function(a,b,c,d,e,f,g,h,i,j,k){function l(m,n,o){this._threadID=m;this._rootElement=n;this._sheetView=o;}k(l.prototype,h,{render:function(){var m=j[':fb:mercury:chat:tab-sheet:clickable-message-icon-sheet'].build();i.setContent(m.getNode('text'),i.tx._("Scroll down to see new messages."));i.setContent(this._rootElement,m.getRoot());g.listen(m.getRoot(),'click',function(){this.inform('clicked',this._threadID);}.bind(this));},isPermanent:function(){return true;},isSheetWithInput:function(){return true;},getType:function(){return 'new_messages_type';},open:function(){this._sheetView.open(this);},close:function(){this._sheetView.close(this);}});e.exports=l;},null);
__d("ChatNoRecipientsTabSheet",["DOM","fbt","MercuryParticipants","ChatTabTemplates","copyProperties","MercuryThreadInformer","MercuryThreads"],function(a,b,c,d,e,f,g,h,i,j,k){var l=b('MercuryThreadInformer').get(),m=b('MercuryThreads').get();function n(o,p,q){this._threadID=o;this._rootElement=p;this._sheetView=q;l.subscribe('threads-updated',this._handleThreadsUpdated.bind(this));}k(n.prototype,{render:function(){var o=j[':fb:mercury:chat:tab-sheet:message-icon-sheet'].build();g.setContent(o.getNode('text'),"Everyone has left the conversation.");g.setContent(this._rootElement,o.getRoot());},isPermanent:function(){return true;},getType:function(){return 'no_recipients_type';},_handleThreadsUpdated:function(){m.getThreadMeta(this._threadID,function(o){var p=i.user,q=o.participants.filter(function(r){return r!=p;});if(q.length<1&&!m.isNewEmptyLocalThread(this._threadID)){this._sheetView.open(this);}else this._sheetView.close(this);}.bind(this));}});e.exports=n;},null);
__d("ChatOfflineTabSheet",["ChatPrivacyActionController","ChatVisibility","CSS","DOM","Event","JSLogger","MercuryParticipants","ChatTabTemplates","copyProperties","cx","MercuryThreads"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){var q=b('MercuryThreads').get();function r(s,t,u){this._rootElement=t;this._sheetView=u;this._logger=l.create('blackbird');this._canonicalUser=q.getCanonicalUserInThread(s);if(this._canonicalUser)this._privacyActionController=new g(this._canonicalUser,this._handlePrivacyChange.bind(this));}o(r.prototype,{render:function(){if(!this._canonicalUser){this._logger.error('offline_sheet_open_with_non_friend');return;}var s=n[':fb:mercury:chat:tab-sheet:message-icon-sheet'].build(),t='fbid:'+this._canonicalUser;m.get(t,function(u){var v='fbChatGoOnlineLink',w=j.tx._("turn on chat"),x=j.create('a',{href:'#',className:v},w),y=j.tx._("To chat with {name} and other friends, {link}.",{name:u.short_name,link:x});j.setContent(s.getNode('text'),y);i.addClass(s.getRoot(),"_1sk1");j.setContent(this._rootElement,s.getRoot());k.listen(this._rootElement,'click',function(event){if(i.hasClass(event.getTarget(),v)){if(h.isOnline())this._logger.error('tab_sheet_already_online');this._privacyActionController.togglePrivacy();this._logger.log('tab_sheet_go_online',{tab_id:this._canonicalUser});return false;}}.bind(this));this._sheetView.resize();}.bind(this));},_handlePrivacyChange:function(s){if(!this._canonicalUser)this._logger.error('user_blocked_sheet_privacy_changed_non_friend');switch(s){case g.OFFLINE:this._sheetView.open(this);break;case g.NORMAL:case g.BLOCKED:this._sheetView.close(this);break;}},isPermanent:function(){return true;},getType:function(){return 'offline_type';},destroy:function(){this._privacyActionController&&this._privacyActionController.destroy();}});e.exports=r;},null);
__d("ChatUploadWarningTabSheet",["DOM","ChatTabTemplates","copyProperties"],function(a,b,c,d,e,f,g,h,i){function j(k,l,m){this._threadID=k;this._rootElement=l;this._sheetView=m;}i(j.prototype,{render:function(){var k=h[':fb:mercury:chat:tab-sheet:message-icon-sheet'].build();g.setContent(k.getNode('text'),g.tx._("Please wait until the upload is complete before you send your message."));g.setContent(this._rootElement,k.getRoot());},isPermanent:function(){return false;},getType:function(){return 'upload_warning_type';},open:function(){this._sheetView.open(this);},close:function(){this._sheetView.close(this);}});e.exports=j;},null);
__d("ChatReadOnlyTabSheet",["React","MercuryReadOnlyReason","cx","MercuryThreads"],function(a,b,c,d,e,f,g,h,i){var j=b('MercuryThreads').get();function k(l,m,n){"use strict";this.$ChatReadOnlyTabSheet0=l;this.$ChatReadOnlyTabSheet1=m;this.$ChatReadOnlyTabSheet2=n;}k.prototype.render=function(){"use strict";var l=h.getReason(j.getThreadMetaNow(this.$ChatReadOnlyTabSheet0));g.renderComponent(g.createElement(g.DOM.div,{className:"_87-"},l),this.$ChatReadOnlyTabSheet1);};k.prototype.isPermanent=function(){"use strict";return false;};k.prototype.getType=function(){"use strict";return 'chat-thread-is-read-only';};k.prototype.open=function(){"use strict";this.$ChatReadOnlyTabSheet2.open(this);};k.prototype.close=function(){"use strict";this.$ChatReadOnlyTabSheet2.open(this);};e.exports=k;},null);
__d("ChatThreadIsMutedTabSheet",["Event","ArbiterMixin","DOM","ChatTabTemplates","copyProperties"],function(a,b,c,d,e,f,g,h,i,j,k){function l(m,n,o){this._threadID=m;this._rootElement=n;this._sheetView=o;}k(l.prototype,h,{render:function(){var m=j[':fb:mercury:chat:tab-sheet:message-mute-sheet'].build();i.setContent(m.getNode('text'),i.tx._("This conversation is muted. Chat tabs will not pop up for it and push notifications are off."));i.setContent(this._rootElement,m.getRoot());g.listen(m.getNode('unmuteButton'),'click',function(){this.inform('clicked',this._threadID);}.bind(this));},isPermanent:function(){return false;},getType:function(){return 'chat-thread-is-muted';},open:function(){this._sheetView.open(this);},close:function(){this._sheetView.close(this);}});e.exports=l;},null);
__d("ChatUserBlockedTabSheet",["CSS","ChatPrivacyActionController","DOM","Event","GenderConst","JSLogger","MercuryParticipants","ChatTabTemplates","copyProperties","cx","tx","MercuryThreads"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){var r=b('MercuryThreads').get();function s(t,u,v){this._rootElement=u;this._sheetView=v;this._logger=l.create('blackbird');this._canonicalUser=r.getCanonicalUserInThread(t);if(this._canonicalUser)this._privacyActionController=new h(this._canonicalUser,this._handlePrivacyChange.bind(this));}o(s.prototype,{render:function(){if(!this._canonicalUser){this._logger.error('user_blocked_sheet_open_with_non_friend');return;}var t=n[':fb:mercury:chat:tab-sheet:user-blocked'].build(),u='fbid:'+this._canonicalUser;m.get(u,function(v){var w=null;switch(v.gender){case k.FEMALE_SINGULAR:case k.FEMALE_SINGULAR_GUESS:w=q._("You turned off chat for {name} but you can still send her a message. ",{name:v.short_name});break;case k.MALE_SINGULAR:case k.MALE_SINGULAR_GUESS:w=q._("You turned off chat for {name} but you can still send him a message. ",{name:v.short_name});break;default:w=q._("You turned off chat for {name} but you can still send them a message. ",{name:v.short_name});}i.setContent(t.getNode('text'),w);var x=q._("Turn on chat for {name}?",{name:v.short_name});i.setContent(t.getNode('actionLink'),x);g.addClass(t.getRoot(),"_1sk0");i.setContent(this._rootElement,t.getRoot());j.listen(t.getNode('actionLink'),'click',this._privacyActionController.togglePrivacy.bind(this._privacyActionController));this._sheetView.resize();}.bind(this));},_handlePrivacyChange:function(t){if(!this._canonicalUser)this._logger.error('user_blocked_sheet_privacy_changed_non_friend');if(t==h.BLOCKED){var u='fbid:'+this._canonicalUser;m.get(u,function(v){if(v.is_friend){this._sheetView.open(this);}else this._sheetView.close(this);}.bind(this));return;}this._sheetView.close(this);},isPermanent:function(){return true;},getType:function(){return 'user_blocked_type';},destroy:function(){this._privacyActionController&&this._privacyActionController.destroy();}});e.exports=s;},null);
__d("ChatTabSheetController",["ChatAddFriendsTabSheet","ChatNameConversationTabSheet","ChatNewMessagesTabSheet","ChatNoRecipientsTabSheet","ChatOfflineTabSheet","ChatUploadWarningTabSheet","ChatReadOnlyTabSheet","ChatThreadIsMutedTabSheet","ChatUserBlockedTabSheet","copyProperties","MercurySheetView","MercuryThreads"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){var r=b('MercuryThreads').get(),s=function(t,u,v){this._sheetView=new q(t,u,v);this._addFriendsTabSheet=new g(t,u,this._sheetView);this._nameConversationTabSheet=new h(t,u,this._sheetView);this._userBlockedTabSheet=new o(t,u,this._sheetView);this._offlineTabSheet=new k(t,u,this._sheetView);this._newMessagesTabSheet=new i(t,u,this._sheetView);this._uploadWarningTabSheet=new l(t,u,this._sheetView);this._threadIsMutedTabSheet=new n(t,u,this._sheetView);this._readOnlyTabSheet=new m(t,u,this._sheetView);if(!r.getCanonicalUserInThread(t))this._noRecipientsTabSheet=new j(t,u,this._sheetView);};p(s.prototype,{openAddFriendsSheet:function(){this._addFriendsTabSheet.open();},getAddFriendsTabSheet:function(){return this._addFriendsTabSheet;},getAddFriendsParticipants:function(){var t=this._addFriendsTabSheet.getParticipants();this._addFriendsTabSheet.close();return t;},openNameConversationSheet:function(t){this._nameConversationTabSheet.open(t);},openReadOnlySheet:function(){this._readOnlyTabSheet.open();},openNewMessagesSheet:function(){this._newMessagesTabSheet.open();},openUploadWarningTabSheet:function(){this._uploadWarningTabSheet.open();},openThreadIsMutedTabSheet:function(){this._threadIsMutedTabSheet.open();},closeAutomaticNameConversationSheet:function(){if(this._nameConversationTabSheet.isAutomatic())this._nameConversationTabSheet.close();},closeThreadIsMutedTabSheet:function(){this._threadIsMutedTabSheet.close();},closeNewMessagesSheet:function(){this._newMessagesTabSheet.close();},closeUploadWarningTabSheet:function(){this._uploadWarningTabSheet.close();},onClickNewMessagesSheet:function(t){this._newMessageClickSub=this._newMessagesTabSheet.subscribe('clicked',t);},onClickThreadIsMutedSheet:function(t){this._threadIsMutedClickSub=this._threadIsMutedTabSheet.subscribe('clicked',t);},onResize:function(t){this._sheetView.subscribe('resize',t);},onTokensChanged:function(t){this._addFriendsTabSheet.subscribe('chat/tokens-changed',t);},destroy:function(){this._sheetView&&this._sheetView.destroy();this._offlineTabSheet&&this._offlineTabSheet.destroy();this._userBlockedTabSheet&&this._userBlockedTabSheet.destroy();this._newMessageClickSub&&this._newMessageClickSub.unsubscribe();this._threadIsMutedClickSub&&this._threadIsMutedClickSub.unsubscribe();}});e.exports=s;},null);
__d("EmoticonUtils",["EmoticonsList","Parent","endsWith","startsWith"],function(a,b,c,d,e,f,g,h,i,j){var k='emoticon_',l=g.symbols,m={getEmoteFromTarget:function(n){var o=h.byClass(n,'emoticon');if(!o)return null;var p=null;o.className.split(' ').forEach(function(q){if(j(q,k))p=q.substring(k.length);});return l[p]||null;},insertEmoticon:function(n,o,p){var q=o.substring(0,p.start),r=o.substring(p.end);if(p.start>0&&!i(q,' '))n=' '+n;if(!j(r,' '))n+=' ';var s=q+n+r;p.start+=n.length;p.end=p.start;return {result:s,start:p.start,end:p.end};}};e.exports=m;},null);
__d("SelectionPosition",["Event","InputSelection","SubscriptionsHandler","merge"],function(a,b,c,d,e,f,g,h,i,j){function k(l){"use strict";this.$SelectionPosition0=l;this.$SelectionPosition1={start:0,end:0};this.$SelectionPosition2=new i();this.$SelectionPosition3=false;this.updatePos();this.enable();}k.prototype.getPos=function(){"use strict";return j(this.$SelectionPosition1);};k.prototype.setPos=function(l,m){"use strict";this.$SelectionPosition1={start:l,end:m};this.restore();};k.prototype.updatePos=function(){"use strict";this.$SelectionPosition1=h.get(this.$SelectionPosition0);};k.prototype.restore=function(){"use strict";h.set(this.$SelectionPosition0,this.$SelectionPosition1.start,this.$SelectionPosition1.end);};k.prototype.enable=function(){"use strict";if(!this.$SelectionPosition3){this.$SelectionPosition2.addSubscriptions(g.listen(this.$SelectionPosition0,'keyup',this.updatePos.bind(this)),g.listen(this.$SelectionPosition0,'click',this.updatePos.bind(this)));this.$SelectionPosition3=true;}};k.prototype.disable=function(){"use strict";if(this.$SelectionPosition3){this.$SelectionPosition2.release();this.$SelectionPosition3=false;}};e.exports=k;},null);
__d("StickerTrigger",["StickerConfig","StickerSearch","StickerServerRequests"],function(a,b,c,d,e,f,g,h,i){'use strict';var j=g.StickerTriggerThreshold,k={findTriggerForInput:function(l,m){h.prepareTagsData().then(function(){return this.findTagForInput(l,function(n,o){return m(n,o);});}.bind(this));},findTagForInput:function(l,m){var n=this.findTriggeredWord(l);if(n){i.getStickersForQuery(n,function(o){return m(o.getPayload(),n);});}else m([],null);},_getRegex:function(){var l=null;if(g.TriggerConfidence==='emoji_only'){l=g.EmoticonRegex;}else if(g.TriggerConfidence==='high')l='^\\w+$';return new RegExp(l);},findTriggeredWord:function(l){var m=h.getTagsIndex();if(!m)return null;l=l.toLowerCase();var n=l.match(this._getRegex()),o=j,p=null;for(var q=0;n!==null&&q<n.length;q++)if(m[n[q]]&&m[n[q]].sticker_count>o){o=m[n[q]].sticker_count;p=n[q];}return p;}};e.exports=k;},null);
__d("StickersFlyoutTriggerSelector.react",["BanzaiLogger","React","Sticker.react","StickerTrigger","StickerUtils","XUIContextualDialog.react","cx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){'use strict';var n=84,o=h.createClass({displayName:'StickersFlyoutTriggerSelector',propTypes:{context:h.PropTypes.object.isRequired,input:h.PropTypes.string,onStickerSelect:h.PropTypes.func.isRequired,onTriggerChanged:h.PropTypes.func.isRequired},getDefaultProps:function(){return {input:null};},getInitialState:function(){return {stickers:[],triggeredWord:null};},componentWillReceiveProps:function(p){if(!p.input){this._resetFlyout();}else if(p.input!==this.props.input)j.findTriggerForInput(p.input,this._onTriggerChanged);},_resetFlyout:function(){this.setState(this.getInitialState());},_onTriggerChanged:function(p,q){if(q)g.log('StickersLoggerConfig',{event:'sticker_trigger_activated',numsearchresults:p.length,triggeredword:q,triggerused:false});this.props.onTriggerChanged(q);this.setState({stickers:p,triggeredWord:q});},_onStickerSelect:function(p){g.log('StickersLoggerConfig',{event:'sticker_trigger_activated',stickerid:p,triggeredword:this.state.triggeredWord,triggerused:true});this.props.onStickerSelect(p);this._resetFlyout();},_renderStickers:function(){if(!this.state.stickers||this.state.stickers.length===0)return null;var p=this.state.stickers[0],q=k.getScaledDimensions(p.height,p.width);return (h.createElement(h.DOM.div,{className:"_5r8h _onc",'data-id':p.id,onClick:function(){return this._onStickerSelect(p.id);}.bind(this)},h.createElement(i,{animationTrigger:"hover",className:"_5r8i",frameCount:p.frameCount,frameRate:p.frameRate||83,framesPerCol:p.framesPerCol,framesPerRow:p.framesPerRow,sourceHeight:q.height,sourceURI:p.sourceURI,sourceWidth:q.width,spriteURI:p.spriteURI,paddedSpriteURI:p.paddedSpriteURI,stickerID:p.id,style:{cursor:'pointer'}})));},render:function(){return (h.createElement(l,{alignment:"center",autoFocus:false,context:this.props.context,onBlur:this._resetFlyout,position:"above",shown:this.state.stickers&&this.state.stickers.length>0,width:n},this._renderStickers()));}});e.exports=o;},null);
__d("StickerSearchNUX.react",["React","ReactLayeredComponentMixin","StickerServerRequests","XUIAmbientNUX.react","fbt"],function(a,b,c,d,e,f,g,h,i,j,k){var l=g.createClass({displayName:'StickerSearchNUX',mixins:[h],getInitialState:function(){return {nuxShown:true};},componentDidMount:function(){i.markSeenSearchTooltipNUX();},hideNUX:function(){this.setState({nuxShown:false});},onCloseButtonClicked:function(){this.hideNUX();this.props.showIndicatorFunc();},renderLayers:function(){return {stickerSearchNUX:g.createElement(j,{ref:"NUX",contextRef:"container",shown:this.state.nuxShown,position:"above",width:"auto",onCloseButtonClick:this.onCloseButtonClicked},"Now you can search for stickers!")};},render:function(){return (g.createElement(g.DOM.span,{ref:"container"}));}});e.exports=l;},null);
__d("StickerTriggerIndicator.react",["BanzaiLogger","React","StickerTrigger","cx"],function(a,b,c,d,e,f,g,h,i,j){'use strict';var k=h.createClass({displayName:'StickerTriggerIndicator',propTypes:{input:h.PropTypes.string,onTriggerChanged:h.PropTypes.func.isRequired},getDefaultProps:function(){return {input:null};},getInitialState:function(){return {shown:false};},componentWillReceiveProps:function(l){if(!l.input){this.setState({shown:false});}else if(l.input!==this.props.input)i.findTriggerForInput(l.input,this._onTriggerChanged);},_onTriggerChanged:function(l,m){if(m)g.log('StickersLoggerConfig',{event:'sticker_trigger_activated',numsearchresults:l.length,triggeredword:m,triggerused:false});this.props.onTriggerChanged(m);this.setState({shown:l&&l.length>0});},render:function(){return h.createElement(h.DOM.span,{className:((this.state.shown?"emoticonIndicator":''))});}});e.exports=k;},null);
__d("XStickerReplyNUXControllerURIBuilder",["XControllerURIBuilder"],function(a,b,c,d,e,f){e.exports=b("XControllerURIBuilder").create("\/stickers\/tooltip\/",{});},null);
__d("ChatTabView",["Arbiter","ArbiterMixin","AsyncDialog","AsyncRequest","AsyncSignal","AvailableListConstants","BanzaiLogger","BanzaiODS","ChatBehavior","ChatConfig","ChatContextualDialogController","ChatFileUploader.react","ChatInput.react","ChatOpenTab","ChatPhotoUploader.react","ChatPrivacyActionController","ChatQuietLinks","ChatShareLinkUploader","ChatStickerButton.react","ChatTabMenu.react","ChatTabMessagesView","ChatTabSheetController","ChatVisibility","MercuryConstants","ContentRollFlyout.react","CurrentUser","CSS","CurrentLocale","Dialog","Dock","DOM","DOMEvent","DOMQuery","DragDropTarget","EmoticonsList","EmoticonUtils","Event","Focus","Input","Keys","Locale","MercuryConfig","MercuryIDs","MercuryFileUploader","MercuryLogMessageType","MercuryParticipants","MercurySourceType","MercuryThreadMetadataRawRenderer","MercuryThreadMuter","MercuryTypingAnimation.react","MercuryTypingReceiver","NubController","Parent","PhotosUploadWaterfall","PresencePrivacy","PresenceStatus","React","Run","SelectionPosition","StickerActions","StickerConfig","StickerConstants","StickersFlyout.react","StickersFlyoutTriggerSelector.react","StickerState","StickerSearchNUX.react","StickerTriggerIndicator.react","Style","SubscriptionsHandler","ChatTabTemplates","TextAreaControl","Toggler","Tooltip","TypingDetectorController","URI","UserAgent_DEPRECATED","VideoCallCore","WaterfallIDGenerator","WebMessengerThreadPermalinks","XStickerReplyNUXControllerURIBuilder","copyProperties","cx","csx","fbt","getActiveElement","isEmpty","setIntervalAcrossTransitions","tx","OrionTrigger","MercuryMessages","MercuryServerRequests","MercuryThreadInformer","MercuryThreadMetadataRenderer","MercuryThreads"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,ab,bb,cb,db,eb,fb,gb,hb,ib,jb,kb,lb,mb,nb,ob,pb,qb,rb,sb,tb,ub,vb,wb,xb,yb,zb,ac,bc,cc,dc,ec,fc,gc,hc,ic,jc,kc,lc,mc,nc,oc,pc){"use strict";var qc=b('OrionTrigger').module,rc=b('MercuryMessages').get(),sc=b('MercuryServerRequests').get(),tc=b('MercuryThreadInformer').get(),uc=b('MercuryThreadMetadataRenderer').get(),vc=b('MercuryThreads').get(),wc=/^\s*$/,xc={},yc=null,zc,ad=10;function bd(wd,xd){var yd=ka.create('div');xd=xd&&xd.filter(function(be){return be!=za.user;});if(nc(xd))return ac.remove(wd);var zd=xd.length,ae=zd-ad;if(ae>1)xd=xd.slice(0,ad);za.getMulti(xd,function(be){for(var ce in be){var de=be[ce],ee=xb[':fb:mercury:chat:multichat-tooltip-item'].build();ka.setContent(ee.getNode('name'),de.name);var fe=za.getUserID(ce),ge=fe&&jb.get(fe)==l.ACTIVE;ga.conditionShow(ee.getNode('icon'),ge);ga.conditionClass(ee.getNode('name'),'tooltipItemWithIcon',ge);ka.appendContent(yd,ee.getRoot());}if(ae>1){var he=lc._("and {number of hidden chat participants} more.",[lc.param("number of hidden chat participants",ae)]);ka.appendContent(yd,ka.create('div',{},he));}ac.set(wd,yd,'above');});}var cd={},dd=null,ed=false;function fd(wd,xd,yd){if(yd){cd[wd]=xd;if(!dd)dd=oc(gd,600);}else{ga.removeClass(xd,'highlightTitle');delete cd[wd];}}function gd(){for(var wd in cd){var xd=cd[wd];if(xd.parentNode){ga.conditionClass(xd,'highlightTitle',ed);}else delete cd[wd];}ed=!ed;if(!Object.keys(cd).length){clearInterval(dd);dd=null;}}function hd(wd){var xd=sc.tokenizeThreadID(wd);switch(xd.type){case 'user':return xb[':fb:mercury:chat:user-tab'].build();}return xb[':fb:mercury:chat:multichat-tab'].build();}function id(wd){var xd=wd._getInputValue(),yd=wd._fileUploader.getAttachments();if(od(wd))kd(wd,xd,yd,function(zd){var ae=wd._fileUploader.getImageFiles();if(ae.length>0){zd.image_ids=ae;zd.has_attachment=true;}var be=wd._fileUploader.getVideoFiles();if(be.length>0){zd.video_ids=be;zd.has_attachment=true;}var ce=wd._fileUploader.getAudioFiles();if(ce.length>0){zd.audio_ids=ce;zd.has_attachment=true;}var de=wd._fileUploader.getFiles();if(de.length>0){zd.file_ids=de;zd.has_attachment=true;}rc.sendMessage(zd);wd._fileUploader.removeAttachments();wd._shareLinkUploader.clear();if(!p.get('chat_react_input'))wd._getNode('input').value='';wd._typingDetector&&wd._typingDetector.resetState();wd._messagesView&&wd._messagesView.scrollToBottom();});}function jd(wd,xd){if(xd===0)return;rd(wd,hb.POST_PUBLISHED,{count:xd});wd._waterfallID=fc.generate();}function kd(wd,xd,yd,zd){vc.getThreadMeta(wd._threadID,function(ae){var be=rc.constructUserGeneratedMessageObject(xd,ab.CHAT_WEB,wd._threadID);if(yd.length>0){be.has_attachment=true;be.raw_attachments=yd;}var ce=wd._shareLinkUploader.getAttachData();if(ce){be.has_attachment=true;be.content_attachment=ce;}if(vc.isNewEmptyLocalThread(wd._threadID)){var de=wd._sheetController.getAddFriendsParticipants();if(de===null||de.length===0)return;de=de.filter(function(fe){return fe!=za.user;});if(de.length===0){be.thread_id=vc.getThreadIDForUser(fa.getID());}else if(de.length===1){be.thread_id=vc.getThreadIDForParticipant(de[0]);}else vc.addParticipantsToThreadLocally(wd._threadID,de);}if(vc.isEmptyLocalThread(wd._threadID)){var ee=sc.tokenizeThreadID(wd._threadID);be.message_id=ee.value;be.specific_to_list=ae.participants;}if(typeof be!='undefined')be.signatureID=wd._signatureID;be.ui_push_phase=da.UIPushPhase;zd(be);if(wd._threadID!==be.thread_id&&!wd._photoUploader.isUploading()){sd.inform('closed-tab',wd._threadID);t.openThread(be.thread_id,'ChatTabView');}});}function ld(wd){wd._blocked=true;wd._sheetController.openUploadWarningTabSheet();}function md(wd){return (wd._fileUploader.isUploading()||wd._photoUploader.isUploading());}function nd(wd){return wd._fileUploader.isUploading();}function od(wd){var xd=wd._getInputValue();if(!wc.test(xd))return true;if(wd._fileUploader.getAttachments().length>0||wd._fileUploader.getImageFiles().length>0||wd._fileUploader.getVideoFiles().length>0)return true;if(wd._shareLinkUploader.getAttachData())return true;return false;}function pd(wd){if(wd._blocked){if(nd(wd))return;wd._blocked=false;id(wd);wd._sheetController.closeUploadWarningTabSheet();}}function qd(wd){wd._nubController.flyoutContentChanged();wd._attachmentsDiv.scrollTop=wd._attachmentsDiv.scrollHeight;}function rd(wd,xd,yd){hb.sendSignal(ic({qn:wd._waterfallID,step:xd,uploader:hb.APP_CHAT},yd||{}));}function sd(wd,xd,yd){if(xd)sc.ensureThreadIsFetched(xd);this._threadID=wd;this._signatureID=yd;this._eventListeners=[];this._isDragDropActive=false;this._tabTemplate=hd(wd);this._tabElem=this._tabTemplate.getRoot();this._titlebar=this._getNode('nubFlyoutTitlebar');this._iconsContainerNode=this._getNode('iconsContainer');this._inputContainerNode=this._getNode('inputContainer');this._waterfallID=fc.generate();this._subscriptionsHandler=new wb();this._initializeAutoSendPhotoUploader();this._stickersFlyoutShown=false;var zd=ma.scry(this._tabElem,"._1ia");if(zd&&zd.length>0){this._dropTarget=new na(zd[0]);this._dropTarget.setOnFilesDropCallback(this._filesDropped.bind(this));this._dropTarget.setOnURLDropCallback(this._linkDropped.bind(this));this._dropTarget.enable();}this._attachmentsDiv=this._getNode('attachmentShelf');this._sheetController=new ba(this._threadID,this._getNode('sheet'),this._tabElem);if(p.get('chat_react_option_menu')){this._initializeReactMenu(this._tabTemplate.getNode('attachmentShelf'));}else{this._fileUploader=new xa(this._tabTemplate.getNode('attachmentShelf'),this._tabTemplate.getNode('attachButtonForm'),this._tabTemplate.getNode('fileInput'),this._tabTemplate.getNode('attachID'));this._initializeUploader(this._fileUploader);}this._sheetController.onClickNewMessagesSheet(function(){this._messagesView&&this._messagesView.scrollToBottom();this.focus();sd.inform('read',this._threadID);}.bind(this));this._sheetController.onClickThreadIsMutedSheet(function(){vc.updateThreadMuteSetting(this._threadID,0);this.focus();}.bind(this));this._nubController=new fb().init(this._tabElem);this._sheetController.onResize(this._nubController.flyoutContentChanged.bind(this._nubController));this._sheetController.onTokensChanged(function(je,ke){vc.getThreadMeta(this._threadID,function(le){this._updateControls(le,ke.token_count);}.bind(this));}.bind(this));this._contextualDialogController=new q(this._threadID,this._getNode('videoCallLink'));if(yc===null)yc=!p.get('seen_autosend_photo_nux');this._messagesView=null;var ae=this._getNode('titlebarText'),be=function(je){ae.setAttribute('href',je);ae.removeAttribute('rel');ga.removeClass(ae,'noLink');};if(p.get('chat_react_option_menu')){gc.getThreadURI(wd,function(je){return be(je);});}else{var ce=this._getNode('conversationLink');ga.hide(ce);uc.renderWebMessengerLink(wd,ce,function(){ga.show(ce);be(ce.href);});}if(!vc.getCanonicalUserInThread(this._threadID))this._titlebarTooltipAnchor=this._getNode('titlebarText');var de=this._getCanonicalUserID();if(this._getCanonicalUserID()){za.get(za.getIDForUser(de),function(je){if(je.href)be(je.href);});}else if(p.get('chat_react_option_menu')&&this._reactChatTabMenu.props.fullURL){be(this._reactChatTabMenu.props.fullURL);}else if(ce&&ce.href)be(ce.href);this._nubController.subscribe('resize',function(){this._resizeInputContainer();}.bind(this));this._setNameConversationLink();this._listen('closeButton','click',this._closeClicked);this._listen('titlebarCloseButton','click',this._closeClicked);this._listen('titlebarCloseButton','keyup',this._closeEnter);this._listen('titlebarCloseButton','mousedown',this._closePreClicked);this._listen('dockButton','click',this._nubClicked);this._listen('dockButton','keydown',this._dockKeyDown);this._listen('nubFlyoutTitlebar','click',this._titleClicked);this._listen('chatConv','click',this._chatConvClicked);this._listen('inputContainer','click',this._inputContainerClicked);this._listen('addFriendLink','click',this._addFriendLinkClicked,true);this._listen('addToThreadLink','click',this._addFriendLinkClicked,true);this._listen('nameConversationLink','click',this._nameConversationLinkClicked,true);this._listen('clearWindowLink','click',this._clearHistory,true);this._listen('unsubscribeLink','click',this._unsubscribeLinkClicked,true);this._listen('videoCallLink','click',this._callClicked,true);this._listen('reportSpamLink','click',this._reportSpamClicked,true);this._listen('createGroupLink','click',this._createGroupClicked,true);this._listen('enableDesktopNotif','click',this._enableDesktopNotif,true);this._listen('muteThreadLink','click',cb.showMuteChangeDialog.bind(null,this._threadID),true);this._listen('unmuteThreadLink','click',function(){vc.updateThreadMuteSetting(this._threadID,0);zb.hide();}.bind(this),true);this._listen('sheet','keydown',function(event){if(!event.getModifiers().any&&event.keyCode===ta.TAB){this._focusInput();event.kill();}}.bind(this));this._stickersFlyoutToggler=this._getNode('emoticons');this._initializeInput();if(ob.WebStickerTrigger){this._triggeredWord=null;this._stickerTrigger=null;this._stickerTriggerNode=null;if(ob.TriggerInterface==='one_tap'){this._stickerTrigger=kb.renderComponent(kb.createElement(rb,{context:this._stickersFlyoutToggler,onStickerSelect:this._stickerSelected.bind(this),onTriggerChanged:this._onTriggerChanged.bind(this)}),this._getNode('stickersTriggerFlyoutContainer'));this._stickerTriggerNode=this._getNode('stickersTriggerFlyoutContainer');}else if(ob.TriggerInterface==='hyperlink'){this._stickerTrigger=kb.renderComponent(kb.createElement(ub,{onTriggerChanged:this._onTriggerChanged.bind(this)}),this._getNode('emoticonIndicator'));this._stickerTriggerNode=this._getNode('emoticonIndicator');}}if(sb.shouldShowStickerSearchNUXIndicator()){this._addStickerSearchNUXIndicator();this._listen('emoticons','click',function(){if(sb.shouldShowStickerSearchNUXIndicator()){nb.selectPack(pb.SEARCH_PACK_ID);sb.clearShowStickerSearchNUXIndicator();}g.inform('stickerSearchNUXIndicator/hide');},true);g.subscribeOnce('stickerSearchNUXIndicator/hide',function(){this._clearStickerSearchNUXIndicator();this._clearStickerSearchNUXTooltip();}.bind(this));sd.subscribe('lower-activated',function(je,ke){if(ke===this._threadID&&sb.shouldShowStickerSearchNUXIndicator()){this._clearStickerSearchNUXTooltip();this._addStickerSearchNUXIndicator();}}.bind(this));}if(p.get('chat_react_sticker_button')){this._stickerButton=kb.renderComponent(kb.createElement(y,{onFlyoutShown:this._onFlyoutShown.bind(this),onFlyoutHidden:this._onFlyoutHidden.bind(this),onStickerSelect:this._stickerSelected.bind(this),onEmoticonSelect:this._emoticonSelected.bind(this)}),this._getNode('stickerButtonContainer'));n.bumpEntityKey('chat.web','sticker_button.mounting_attempted');}else{var ee=this._getNode('stickers');if(ee)this._stickersFlyout=kb.renderComponent(kb.createElement(qb,{onStickerSelect:function(je){this._stickerSelected(je);}.bind(this),onShown:this._onFlyoutShown.bind(this),onHidden:this._onFlyoutHidden.bind(this),onEmoticonSelect:this._emoticonSelected.bind(this),onEscKeyDown:this._hideStickersFlyoutIfShown.bind(this)}),ee);this._eventListeners.push(sb.addListener(sb.PACK_SELECTED,function(je){if(this._stickersFlyout&&this._stickersFlyout.isMounted())this._stickersFlyout.setProps({packID:je});}.bind(this)));}if(qc){this._orionTriggerContainer=this._getNode('orionTriggerContainer');this._orionTrigger=kb.renderComponent(kb.createElement(qc,{onTrigger:this._orionTriggered.bind(this)}),this._orionTriggerContainer);}var fe=this._getNode('contentRoll');if(fe)kb.renderComponent(kb.createElement(ea,{onSelection:function(je){this._shareLinkUploader&&this._shareLinkUploader.loadShare(je.url,{content_roll_entry:je});this.focus();}.bind(this),userID:fa.getID()}),fe);this._privacyLink=this._getNode('privacyLink');if(this._privacyLink){this._privacyActionController=new v(de,this._updatePrivacyLink.bind(this));this._eventListeners.push(qa.listen(this._privacyLink,'click',this._privacyActionController.togglePrivacy.bind(this._privacyActionController)));}vc.getThreadMeta(this._threadID,function(je){this._setUpMutingSettings(je);}.bind(this));var ge=this._getNode('muteGroupLink');if(ge){var he=vc.getCanonicalGroupInThread(this._threadID);if(he)ge.setAttribute('ajaxify',cc(ge.getAttribute('ajaxify')).addQueryData({id:he}));}w.removeEmptyHrefs(this._tabElem);xc[wd]=this;this.updateAvailableStatus();this.updateTab();this._setCloseTooltip(false);var ie={threadID:wd,userID:de,signatureID:this._signatureID};new k('/ajax/chat/opentab_tracking.php',ie).send();lb.onBeforeUnload(function(){if(this._hasUnfinishedPost())return "You haven't sent your message yet. Do you want to leave without sending?";if(rc.getNumberLocalMessages(this._threadID))return "Your message is still being sent. Are you sure you want to leave?";return null;}.bind(this),false);lb.onUnload(function(){td(this);}.bind(this));}function td(wd){if(wd._photoUploader.isUploading())rd(wd,hb.CANCEL_DURING_UPLOAD);}function ud(){for(var wd in xc){xc[wd].updateAvailableStatus();xc[wd].updateMultichatTooltip();}}g.subscribe(['buddylist/availability-changed'],ud);ib.subscribe(['privacy-changed','privacy-availability-changed'],ud);o.subscribe(o.ON_CHANGED,function(){for(var wd in xc)vc.getThreadMeta(wd,function(xd){xc[wd]._updateUnreadCount(xd);});});eb.addRetroactiveListener('state-changed',function(wd){for(var xd in wd){var yd=wd[xd]&&wd[xd].length,zd=xc[xd];zd&&zd.showTypingIndicator(yd);}});tc.subscribe('threads-updated',function(wd,xd){for(var yd in xc){var zd=xc[yd];xd[yd]&&zd.updateTab();if(zd._newThreadIDFromPhotoUpload&&!zd._photoUploader.isUploading()&&xd[zd._newThreadIDFromPhotoUpload]){sd.inform('closed-tab',zd._threadID);t.openThread(zd._newThreadIDFromPhotoUpload,'ChatTabView');zd._newThreadIDFromPhotoUpload=null;}}});tc.subscribe('threads-deleted',function(wd,xd){for(var yd in xc)xd[yd]&&sd.inform('thread-deleted',yd);});ic(sd,h,{get:function(wd){return xc[wd];}});ic(sd.prototype,{getThreadID:function(){return this._threadID;},showAddFriend:function(){setTimeout((function(){this._sheetController.openAddFriendsSheet();}).bind(this),0);},showNameConversation:function(wd){setTimeout((function(){this._sheetController.openNameConversationSheet(wd);}).bind(this),0);},hideAutomaticNameConversation:function(){setTimeout((function(){this._sheetController.closeAutomaticNameConversationSheet();}).bind(this),0);},isVisible:function(){return ga.shown(this._tabElem);},setVisibleState:function(wd,xd){var yd=ga.shown(this._tabElem),zd=ga.hasClass(this._tabElem,'opened');ga.conditionShow(this._tabElem,wd);ga.conditionClass(this._tabElem,'opened',xd);if(!(yd&&zd)&&wd&&xd){if(!this._messagesView)this._messagesView=new aa(this._threadID,this._sheetController,this._getNode('chatConv'),this._getNode('conversation'),this._getNode('loadingIndicator'),this._getNode('lastMessageIndicator'),this._getNode('typingIndicator'),this);this._nubController.flyoutContentChanged();this._messagesView.scrollToBottom();}if(yd&&zd&&!(wd&&xd))this._contextualDialogController.tabNotActive();},focus:function(){if(ga.hasClass(this._tabElem,'opened')){this._focusInput();}else this._getNode('dockButton').focus();},isFocused:function(){var wd=mc();return gb.byClass(wd,"_50mz")===this._tabElem;},hasEmptyInput:function(){var wd;if(p.get('chat_react_input')){wd=this._chatInput.getValue();}else wd=this._getNode('input').value;return wc.test(wd);},getInputElem:function(){if(p.get('chat_react_input')){return this._chatInput.getDOMNode();}else return this._getNode('input');},setStickersFlyoutPackID:function(wd){if(this._stickerButton){this._setPackIDReact(wd);}else this._setPackIDLegacy(wd);},_linkDropped:function(wd){this._shareLinkUploader.loadShare(wd);},_filesDropped:function(wd){if(this._fileUploader)this._fileUploader.addDroppedFiles(wd);},showStickerSearchNUXTooltip:function(){if(zc)return;zc=true;this._clearStickerSearchNUXIndicator();this._stickerSearchNUXTooltip=kb.renderComponent(kb.createElement(tb,{showIndicatorFunc:this._addStickerSearchNUXIndicator.bind(this)}),this._getNode('tooltipNUXContainer'));},_setPackIDLegacy:function(wd){var xd=this._stickersFlyout;if(!this._stickersFlyoutToggler||!xd||!xd.isMounted())return;nb.selectPack(wd);this._toggleStickersFlyoutShownLegacy(true);},_setPackIDReact:function(wd){if(!this._stickerButton.isMounted())return;nb.selectPack(wd);this._toggleStickersFlyoutShownReact(true);},_toggleStickersFlyoutShownReact:function(wd){this._stickerButton.showFlyout();this._stickersFlyoutShown=wd;},_toggleStickersFlyoutShownLegacy:function(wd){if(wd){zb.show(this._stickersFlyoutToggler);}else zb.hide(this._stickersFlyoutToggler);this._stickersFlyoutShown=wd;},_hideStickersFlyoutIfShown:function(){if(this._stickersFlyoutToggler&&this._stickersFlyout&&this._stickersFlyoutShown)this._toggleStickersFlyoutShownLegacy(false);},showStickerReplyNUX:function(){if(zc)return;var wd=this._getNode('stickerButtonContainer')||this._getNode('emoticons');new j(new hc().getURI()).setRelativeTo(wd).setData({thread_id:this._threadID}).setHandler(function(xd){sb.clearShowStickerReplyNUX();}).send();},insertBefore:function(wd){ka.insertBefore(wd._tabElem,this._tabElem);},appendTo:function(wd){ka.appendContent(wd,this._tabElem);},nextTabIs:function(wd){var xd=wd&&wd._tabElem;return this._tabElem.nextSibling==xd;},getScrollTop:function(){return ka.find(this._tabElem,'.fbNubFlyoutBody.scrollable').scrollTop;},setScrollTop:function(wd){ka.find(this._tabElem,'.fbNubFlyoutBody.scrollable').scrollTop=wd;},destroy:function(){ka.remove(this._tabElem);this._selectionPosition&&this._selectionPosition.disable();while(this._eventListeners.length)this._eventListeners.pop().remove();if(this._dropTarget)this._dropTarget.disable();this._messagesView&&this._messagesView.destroy();this._sheetController&&this._sheetController.destroy();if(p.get('chat_react_option_menu')){kb.unmountComponentAtNode(this._getNode('menuContainer'));}else this._fileUploader&&this._fileUploader.destroy();kb.unmountComponentAtNode(this._getNode('photoUploaderContainer'));if(p.get('chat_react_sticker_button')){kb.unmountComponentAtNode(this._getNode('stickerButtonContainer'));}else kb.unmountComponentAtNode(this._getNode('stickers'));if(this._stickerTriggerNode){kb.unmountComponentAtNode(this._stickerTriggerNode);clearTimeout(this._triggerTimeoutID);}this._subscriptionsHandler&&this._subscriptionsHandler.release();this._contextualDialogController&&this._contextualDialogController.destroy();this._privacyActionController&&this._privacyActionController.destroy();delete xc[this._threadID];ja.unregisterNubController(this._nubController);if(p.get('chat_react_input')){kb.unmountComponentAtNode(this._getNode('inputContainer'));}else sa.reset(this._getNode('input'));},updateAvailableStatus:function(){vc.getThreadMeta(this._threadID,function(wd){var xd=l.OFFLINE,yd=this._getCanonicalUserID();if(yd){xd=jb.get(yd);}else{var zd=wd.participants.map(function(be){return za.getUserID(be);});xd=jb.getGroup(zd);}if(!ca.isOnline())xd=l.OFFLINE;if(yd)this._updateCallLink(xd);ga.conditionClass(this._tabElem,"_5238",xd===l.ACTIVE);ga.conditionClass(this._tabElem,"_42nw",xd===l.IDLE);ga.conditionClass(this._tabElem,"_5239",xd===l.MOBILE);var ae=this._getNode('presenceIndicator');switch(xd){case l.ACTIVE:ae.setAttribute('alt',"Online");break;case l.MOBILE:ae.setAttribute('alt',"Mobile");break;default:ae.removeAttribute('alt');break;}}.bind(this));},updateTab:function(){this._setNameConversationLink();vc.getThreadMeta(this._threadID,function(wd){uc.renderAndSeparatedParticipantList(this._threadID,[this._getNode('name'),this._getNode('titlebarText')],{names_renderer:bb.renderShortNames,check_length:true});this._updateControls(wd);this._updateMutingSettings(wd);this._updateUnreadCount(wd);this.updateMultichatTooltip();this._updateArchiveWarning(wd);this._updateNewThread(wd);this._updateNameConversationSheet(wd);this._updateReadOnlySheet(wd);}.bind(this));},_setNameConversationLink:function(){var wd=this._getNode('nameConversationLink');if(wd)vc.isEmptyLocalThread(this._threadID)?ga.hide(wd):ga.show(wd);},_updateNameConversationSheet:function(wd){if(vc.canReply(wd.thread_id)&&!wd.name&&!wd.is_canonical&&!wd.name_conversation_sheet_dismissed&&!wd.has_email_participant&&!wd.read_only&&!vc.isEmptyLocalThread(wd.thread_id)){this.showNameConversation(true);}else this.hideAutomaticNameConversation();},_updateReadOnlySheet:function(wd){var xd=vc.canReply(wd.thread_id),yd=vc.isEmptyLocalThread(wd.thread_id);if(!xd&&!yd)this._sheetController.openReadOnlySheet();},updateSignatureID:function(wd){this._signatureID=wd;},_showPhotoNUXIfNecessary:function(){if(yc){yc=false;new j('/ajax/chat/photo_nux.php').setRelativeTo(this._getNode('photoUploaderContainer')).setData({threadID:this._threadID}).send();return true;}},_setUpMutingSettings:function(wd){var xd=cb.isThreadMuted(wd);if(xd)this._sheetController.openThreadIsMutedTabSheet();this._updateActionMenu(xd);},_updateMutingSettings:function(wd){var xd=cb.isThreadMuted(wd),yd;if(p.get('chat_react_option_menu')){yd=this._reactChatTabMenu.props.isMuted;}else yd=ga.shown(this._getNode('unmuteThreadLink').parentNode);if(xd&&!yd){this._sheetController.openThreadIsMutedTabSheet();}else if(!xd&&yd)this._sheetController.closeThreadIsMutedTabSheet();this._updateActionMenu(xd);},_updateActionMenu:function(wd){if(p.get('chat_react_option_menu')){this._reactChatTabMenu.setProps({isMuted:wd});}else{ga.conditionShow(this._getNode('muteThreadLink').parentNode,!wd);ga.conditionShow(this._getNode('unmuteThreadLink').parentNode,wd);}},_updateArchiveWarning:function(wd){var xd=false;za.get(za.user,function(yd){xd=yd.employee;if(xd)za.getMulti(wd.participants,this._showArchiveWarningIfAllParticipantsAreEmployees.bind(this));}.bind(this));},_updateControls:function(wd,xd){var yd=false;if(wd&&wd.thread_id){var zd=sc.tokenizeThreadID(wd.thread_id);if(zd.type==='user'){var ae=zd.value;yd=!sc.isUser(ae);}}var be=vc.canReply(wd.thread_id)&&(!nc(wd.participants)||xd);ga.conditionShow(this._inputContainerNode,be);ga.conditionShow(this._iconsContainerNode,be);if(!p.get('chat_react_option_menu')){ga.conditionShow(this._getNode('dropdown'),be);}else{this._reactChatTabMenu.setProps({show:be});if(yd)this._reactChatTabMenu.setProps({showAddFriend:null});}ga.conditionShow(this._getNode('addToThreadLink'),be&&!yd);this._resizeInputContainer();this._updateOrionTrigger(be);},_updateOrionTrigger:function(wd){if(this._orionTrigger&&wd){var xd=this.getParticipantIDForOrionNUX();ga.conditionShow(this._orionTriggerContainer,xd);if(xd){za.get(xd,function(yd){yd.userId=za.getUserID(xd);this._orionTrigger.setProps({receiver:yd,disabled:!yd.orion_eligible});if(yd.orion_eligible&&this.isOrionNUXEligible())this.showOrionNUXTooltip();}.bind(this));}else this._orionTrigger.setProps({receiver:{}});}},getParticipantIDForOrionNUX:function(){var wd=this._sheetController.getAddFriendsTabSheet(),xd=wd.getParticipants(),yd=this._getCanonicalUserID(),zd=null;if(yd){zd=za.getIDForUser(yd);}else if(xd&&xd.length===1)zd=xd[0];return zd;},showOrionNUXTooltip:function(){if(this._orionTrigger&&va.ShowOrionNUXTooltip)this._orionTrigger.setShouldShowNUXTooltip();},isOrionNUXEligible:function(){var wd=this.getParticipantIDForOrionNUX();return wd&&this.isVisible()&&ga.hasClass(this._tabElem,'opened');},_resizeInputContainer:function(){var wd=this._tabElem.clientWidth,xd=2,yd=wd-(this._inputContainerNode.clientWidth+xd),zd=ua.isRTL()?'left':'right';vb.set(this._iconsContainerNode,zd,yd+'px');if(!p.get('chat_react_input'))yb.getInstance(this._getNode('input')).update();},_updateNewThread:function(wd){if(vc.isNewEmptyLocalThread(wd.thread_id))this.showAddFriend();},_showArchiveWarningIfAllParticipantsAreEmployees:function(wd){var xd=true;for(var yd in wd)xd=xd&&wd[yd].employee;var zd=this._getNode('titanArchiveWarning');if(zd){if(this._titlebarTooltipAnchor)ga.conditionClass(this._titlebarTooltipAnchor,'narrowTitleBar',xd);ga.conditionShow(zd,xd);}},updateMultichatTooltip:function(){vc.getThreadMeta(this._threadID,function(wd){if(!wd.is_canonical)bd(this._titlebarTooltipAnchor,wd.participants);}.bind(this));},_getNode:function(wd){return this._tabTemplate.getNode(wd);},_getCanonicalUserID:function(){return vc.getCanonicalUserInThread(this._threadID);},_listen:function(wd,event,xd,yd){var zd=this._getNode(wd);if(zd){this._eventListeners.push(qa.listen(zd,event,xd.bind(this)));}else if(!yd)throw new Error('Could not find node "'+wd+'"');},_closePreClicked:function(wd){this._closeMouseDown=true;},_closeClicked:function(wd){td(this);sd.inform('closed-tab',this._threadID);wd.kill();},_closeEnter:function(wd){if(wd.keyCode===ta.RETURN)this._closeClicked(wd);},_nubClicked:function(wd){if(!this._isDragDropActive){wd.kill();return sd.inform('nub-activated',this._threadID);}},_dockKeyDown:function(event){if(event.keyCode===ta.RETURN||event.keyCode===ta.SPACE){sd.inform('nub-activated',this._threadID);event.kill();}else this._handleHotkeyPressed(event);},_handleHotkeyPressed:function(event){if(event.keyCode===ta.ESC){this._handleEscape();if(p.get('chat_react_input'))event=new la(event);event.kill();}else if(event.keyCode===ta.TAB)this._handleTabPressed(event);},_handleTabPressed:function(event){if(!event.ctrlKey){var wd=sd.inform('tab-pressed',{id:this._threadID,shiftPressed:event.shiftKey});if(p.get('chat_react_input'))event=new la(event);!wd&&event.kill();return true;}},_handleEscape:function(){if(this._stickersFlyoutShown){this._stickerButton?this._toggleStickersFlyoutShownReact(false):this._toggleStickersFlyoutShownLegacy(false);return;}td(this);if(this.hasEmptyInput()){sd.inform('esc-pressed',this._threadID);}else{var wd="Are you sure you want to close this chat window?",xd="You haven't sent your message.",yd=new ia().setTitle(wd).setBody(xd).setButtons([ia.CLOSE,ia.CANCEL]).setHandler(sd.inform.bind(sd,'esc-pressed',this._threadID,null)).setModal(true).show(),zd=yd.getButtonElement('yes');zd&&ra.set(zd);}},_titleClicked:function(event){var wd=event.getTarget();if(!gb.byClass(wd,'titlebarText')&&!gb.byClass(wd,'uiSelector')&&!gb.byClass(wd,'addToThread')&&!gb.byClass(wd,'optionMenu')&&!this._isDragDropActive){sd.inform('lower-activated',this._threadID);event.kill();}},_callClicked:function(wd){var xd=this._getCanonicalUserID();if(ec.availableForCall(xd)){var yd='chat_tab_icon';if(wd.target&&ga.hasClass(wd.target,'video_call_tour'))yd='chat_tab_icon_tour';sd.inform('video-call-clicked',{threadID:this._threadID,userID:xd,clickSource:yd});}return false;},_addFriendLinkClicked:function(){this.showAddFriend();},_nameConversationLinkClicked:function(){this.showNameConversation();},_showParticipantsClicked:function(){sc.getServerThreadID(this._threadID,function(wd){i.send(new j(cc('/ajax/browser/dialog/multichat_members/').addQueryData({id:wd})));});},_clearHistory:function(){var wd=vc.getThreadMetaNow(this._threadID);if(wd){var xd=this._getCanonicalUserID();sc.clearChat(this._threadID,xd,wd.timestamp);}},_unsubscribeLinkClicked:function(){var wd=[];wd.push({name:'unsubscribe',label:"Leave Conversation",handler:this._unsubscribeToThread.bind(this)});wd.push(ia.CANCEL);new ia().setTitle("Leave Conversation?").setBody("You will stop receiving messages from this conversation and people will see that you left.").setButtons(wd).show();},_getUserParticipants:function(wd){var xd=[];wd.forEach(function(yd){var zd=za.getUserID(yd);zd&&xd.push(zd);});return xd;},_createGroupClicked:function(){vc.getThreadMeta(this._threadID,function(wd){if(!wd.is_canonical){var xd=cc('/ajax/groups/create_get.php').addQueryData({ref:'web_messenger_dock',parent_id:'0'}),yd=this._getUserParticipants(wd.participants);xd.addQueryData({members:yd});if(wd.name)xd.addQueryData({name:wd.name});i.send(new j(xd));}}.bind(this));},_enableDesktopNotif:function(){Notification.requestPermission();},_reportSpamClicked:function(){var wd=this._getCanonicalUserID(),xd=cc('/ajax/chat/report.php').addQueryData({id:wd}).addQueryData({src:'top_report_link'});i.send(new j(xd));},_inputPasted:function(event){if(dc.chrome()){var wd=event.clipboardData||event.originalEvent.clipboardData;if(!wd||!wd.items||wd.items.length<1)return;var xd=wd.items[0].type;if(xd!=='image/png')return;if(wd.items[0].getAsFile){var yd=wd.items[0].getAsFile();this._photoUploader.uploadFile(yd);}}},_focusInput:function(){if(p.get('chat_react_input')){this._chatInput.focus();}else this._getNode('input').focus();},_focusTab:function(){ga.addClass(this._tabElem,'focusedTab');this.tryMarkAsRead();this._contextualDialogController.tabFocused();if(!zc&&this._showPhotoNUXIfNecessary())g.subscribe(['ChatNUX/show','ChatNUX/hide'],function(event){zc=event==='ChatNUX/show';});this._closeMouseDown=false;this._setCloseTooltip(true);sd.inform('focus-tab',this._threadID);},_blurTab:function(){ga.removeClass(this._tabElem,'focusedTab');!this._closeMouseDown&&this._setCloseTooltip(false);},_setCloseTooltip:function(wd){var xd=this._getNode('titlebarCloseButton'),yd=wd?"Press Esc to close":"Close tab";ac.set(xd,yd,'above');},_inputKeyDown:function(event){this.tryMarkAsRead();if(event.keyCode===ta.RETURN&&!event.shiftKey){if(nd(this)){ld(this);event.kill&&event.kill();return;}id(this);if(ob.WebStickerTrigger)this._activateStickerTriggerAfterparty();event.kill&&event.kill();return;}if(event.keyCode===ta.DOWN&&event.shiftKey&&this.hasEmptyInput()){sd.inform('lower-activated',this._threadID);event.kill&&event.kill();return;}this._handleHotkeyPressed(event);},_activateStickerTriggerAfterparty:function(){this._persistTrigger=true;clearTimeout(this._triggerTimeoutID);this._triggerTimeoutID=setTimeout(this._deactivateStickerTriggerAfterparty.bind(this),5000);},_deactivateStickerTriggerAfterparty:function(){clearTimeout(this._triggerTimeoutID);this._persistTrigger=false;this._userUsedTrigger=false;this._triggeredWord=null;this._setStickerTrigger(null);},_setStickerTrigger:function(wd){if(this._stickerTrigger&&this._stickerTrigger.isMounted())this._stickerTrigger.setProps({input:wd});},getTriggeredWord:function(){return this._triggeredWord;},isTriggerValid:function(){return !this._userUsedTrigger;},_inputChanged:function(wd){if(this._persistTrigger)this._deactivateStickerTriggerAfterparty();if(this.isTriggerValid())this._setStickerTrigger(wd);},_initializeInput:function(){if(!p.get('chat_react_input')){var wd=this._inputContainerNode.clientHeight;yb.getInstance(this._getNode('input')).subscribe('resize',function(){var xd=this._inputContainerNode.clientHeight;if(xd!=wd)this._nubController.flyoutContentChanged();wd=xd;}.bind(this));this._listen('input','focus',this._focusTab);this._listen('input','blur',this._blurTab);this._listen('input','paste',this._inputPasted);if(dc.firefox()&&ha.get()=='ko_KR'){this._listen('input','keyup',this._inputKeyDown);}else this._listen('input','keydown',this._inputKeyDown);this._initializeThingsWithInputFn(this._tabTemplate.getNode('input'));}else this._chatInput=kb.renderComponent(kb.createElement(s,{getTriggeredWordFn:this.getTriggeredWord.bind(this),initializeThingsWithInputFn:this._initializeThingsWithInputFn.bind(this),inputChanged:this._inputChanged.bind(this),inputKeyDown:this._inputKeyDown.bind(this),isTriggerValid:this.isTriggerValid.bind(this),onBlur:this._blurTab.bind(this),onEscape:this._handleEscape.bind(this),onFocus:this._focusTab.bind(this),onTab:this._handleTabPressed.bind(this),openFlyoutFn:this._toggleStickersFlyoutShownLegacy.bind(this,true),resizeFn:this._nubController.flyoutContentChanged.bind(this._nubController),uploadPhotoFn:this._photoUploader.uploadFile}),this._getNode('chatInputContainer'));},_initializeThingsWithInputFn:function(wd,xd){this._shareLinkUploader=new x(this._tabTemplate.getNode('attachmentShelf'),wd,this.focus.bind(this),xd);this._initializeUploader(this._shareLinkUploader);vc.getThreadMeta(this._threadID,function(yd){sc.getServerThreadID(this._threadID,function(zd){this._typingDetector=new bc(this._getCanonicalUserID(),wd,'mercury-chat',null,zd,xd);}.bind(this));}.bind(this));},_getInputValue:function(){if(p.get('chat_react_input')){return this._chatInput.getValue()||'';}else return this._tabTemplate.getNode('input').value||'';},_hasUnfinishedPost:function(){return od(this)||md(this);},tryMarkAsRead:function(){if(!this._messagesView||this._messagesView.isScrolledToBottom()){sd.inform('read',this._threadID);return true;}return false;},_chatConvClicked:function(wd){this.tryMarkAsRead();if(gb.byTag(wd.getTarget(),'a')||ka.getSelection())return;this.focus();},_inputContainerClicked:function(wd){this.tryMarkAsRead();this.focus();},showTypingIndicator:function(wd){if(p.get('chat_closed_tab_typing_indicator_animated')){var xd=ka.find(this._tabElem,"._54m9");if(wd){this._animatedTypingIndicator=kb.renderComponent(kb.createElement(db,null),xd);this._updateAnimatedIndicatorColor();ga.addClass(this._tabElem,"_54m8");ga.show(xd);}else{ga.removeClass(this._tabElem,"_54m8");ga.hide(xd);kb.unmountComponentAtNode(xd);this._animatedTypingIndicator=null;}}else ga.conditionClass(this._tabElem,'typing',wd);},_updateAnimatedIndicatorColor:function(){if(this._animatedTypingIndicator){var wd=ga.hasClass(this._tabElem,'highlightTab')?'light':'dark';this._animatedTypingIndicator.setProps({color:wd});}},_updateUnreadCount:function(wd){var xd=wd.unread_count;if(typeof xd!='undefined'){var yd=!!xd&&(!o.showsTabUnreadUI||o.showsTabUnreadUI()),zd=this._getNode('numMessages');ga.conditionShow(zd,yd);ga.conditionClass(this._tabElem,'highlightTab',yd);this._updateAnimatedIndicatorColor();fd(this._threadID,this._tabElem,yd);ka.setContent(zd,xd);}},_updateCallLink:function(wd){var xd=this._getNode('videoCallLink'),yd=this._getCanonicalUserID();if(yd===fa.getID()){this._hideVideoCallouts();ga.hide(xd);return;}if(ca.isOnline()){var zd='fbid:'+yd;za.get(zd,function(ae){if(ec.availableForCall(yd)){ac.set(xd,pc._("Start a video call with {firstname}",{firstname:ae.short_name}));}else{ac.set(xd,pc._("{firstname} is currently unavailable for video calling",{firstname:ae.short_name}));this._hideVideoCallouts();}}.bind(this));}else{ac.set(xd,"You must be online to make a call.");this._hideVideoCallouts();}},_hideVideoCallouts:function(){this._contextualDialogController.hideVideoCallouts();},_updatePrivacyLink:function(wd){var xd;if(wd==v.OFFLINE){xd="Go online";if(p.get('chat_react_option_menu')){this._reactChatTabMenu.setProps({privacyText:xd});}else ka.setContent(this._privacyLink,xd);return;}var yd=this._getCanonicalUserID();if(!yd)return;var zd='fbid:'+yd;za.get(zd,function(ae){if(wd==v.BLOCKED){xd=pc._("Turn On Chat for {name}",{name:ae.short_name});}else xd=pc._("Turn Off Chat for {name}",{name:ae.short_name});if(p.get('chat_react_option_menu')){this._reactChatTabMenu.setProps({privacyText:xd});}else ka.setContent(this._privacyLink,xd);}.bind(this));},_unsubscribeToThread:function(){if(!vc.isEmptyLocalThread(this._threadID)){var wd=rc.constructLogMessageObject(ab.CHAT_WEB,this._threadID,ya.UNSUBSCRIBE,{removed_participants:[za.user]});rc.sendMessage(wd);}sd.inform('unsubscribed',this._threadID);return true;},_initializeUploader:function(wd){this._subscriptionsHandler.addSubscriptions(wd.subscribe(['all-uploads-completed','upload-canceled'],function(){pd(this);}.bind(this)),wd.subscribe('dom-updated',function(){qd(this);}.bind(this)),wd.subscribe('submit',function(){this._focusInput();}.bind(this)));},_initializeReactMenu:function(wd){var xd=this._getNode('menuContainer'),yd=wa.isMultichat(this._threadID),zd=vc.isNewEmptyLocalThread(this._threadID),ae=this._sheetController.openAddFriendsSheet.bind(this._sheetController);if(xd)this._reactChatTabMenu=kb.renderComponent(kb.createElement(z,{onFileUploaderMounted:this.setFileUploader.bind(this),updatePrivacyLinkFunc:this._updatePrivacyLink.bind(this),nameConversationFunc:this._nameConversationLinkClicked.bind(this),showParticipantsFunc:this._showParticipantsClicked.bind(this),leaveConversationFunc:this._unsubscribeLinkClicked.bind(this),clearHistoryFunc:this._clearHistory.bind(this),reportSpamFunc:this._reportSpamClicked.bind(this),createGroupFunc:this._createGroupClicked.bind(this),isMultichat:yd,isEmptyChat:zd,showAddFriend:ae,threadID:this._threadID,attachmentsShelf:wd,onUploadFinished:pd.bind(this,this),onUpdateAttachmentsShelf:qd.bind(this,this),onSubmit:this._focusInput.bind(this),enableDesktopNotif:function(){this._enableDesktopNotif();}.bind(this)}),xd);},_initializeReactFileUploader:function(wd){this._fileUploader=kb.renderComponent(kb.createElement(r,{onFileUploaderMount:this.setFileUploader.bind(this),attachmentsShelf:wd,onUploadFinished:pd.bind(this,this),onUpdateAttachmentsShelf:qd.bind(this,this),onSubmit:this._focusInput.bind(this)}),this._getNode('fileUploaderContainer'));},setFileUploader:function(wd){this._fileUploader=wd;},_initializeAutoSendPhotoUploader:function(){this._photoUploader=kb.renderComponent(kb.createElement(u,{onSubmit:this._handlePUSubmit.bind(this),onAllUploadsComplete:this._handlePUAllUploadsCompleted.bind(this),onLastUploadFail:this._handlePULastUploadFailed.bind(this),onLastUploadCancel:this._handlePULastUploadCanceled.bind(this)}),this._getNode('photoUploaderContainer'));},_handlePUSubmit:function(wd,xd){rd(this,hb.UPLOAD_START,xd);kd(this,'',[],function(yd){if(this._threadID!==yd.thread_id){this._newThreadIDFromPhotoUpload=yd.thread_id;if(this._messagesView)this._messagesView.setNewThreadID(yd.thread_id);}yd.content_attachment=null;rc.updateNewMessage(yd,xd.upload_id,xd);rc.sendMessage(yd);}.bind(this));this._focusInput();},_handlePULastUploadFailed:function(wd,xd){rd(this,hb.CLIENT_ERROR,xd);vd(xd);var yd="Photo Upload Failed",zd="Please try again. Make sure you are uploading a valid photo.";new ia().setTitle(yd).setBody(zd).setButtons(ia.OK).show();},_handlePULastUploadCanceled:function(wd,xd){rd(this,hb.CANCEL_DURING_UPLOAD,xd);vd(xd);},_handlePUAllUploadsCompleted:function(wd,xd){rd(this,hb.ALL_UPLOADS_DONE,xd);var yd=rc.updateMessageAfterUpload(xd.upload_id,xd);rc.clearUploadedMessage(xd.upload_id);rc.sendMessage(yd);var zd=xd.image_ids.length||xd.attachments.length;jd(this,zd);},_stickerSelected:function(wd){kd(this,'',[],function(xd){xd.has_attachment=true;xd.sticker_id=wd;rc.sendMessage(xd);this.focus();}.bind(this));this._messagesView&&this._messagesView.scrollToBottom();},_emoticonSelected:function(wd){var xd=oa.symbols[wd];if(!xd)return;if(p.get('chat_react_input')){this._chatInput.insertEmoticon(xd);return;}this._selectionPosition=this._selectionPosition||new mb(this._getNode('input'));var yd=yb.getInstance(this._getNode('input')),zd=yd.getValue(),ae=pa.insertEmoticon(xd,zd,this._selectionPosition.getPos());yd.setValue(ae.result);this._selectionPosition.setPos(ae.start,ae.end);},_clearStickerSearchNUXIndicator:function(){ga.removeClass(this._getNode('emoticonIndicator'),'nux');},_orionTriggered:function(){kd(this,'',[],function(wd){this.focus();}.bind(this));this._messagesView&&this._messagesView.scrollToBottom();},_addStickerSearchNUXIndicator:function(){ga.addClass(this._getNode('emoticonIndicator'),'nux');zc=false;},_clearStickerSearchNUXTooltip:function(){this._stickerSearchNUXTooltip&&this._stickerSearchNUXTooltip.hideNUX();},_onFlyoutShown:function(wd){if(p.get('chat_react_sticker_button')){var xd=this._stickersFlyout.props.packID;if(xd!==pb.SEARCH_PACK_ID)this.focus();}if(ob.WebStickerTrigger&&this._triggeredWord&&!this._userUsedTrigger){m.log('StickersLoggerConfig',{event:'sticker_trigger_activated',triggeredword:this._triggeredWord,triggerused:true});this._userUsedTrigger=true;this._stickersFlyout.setProps({packID:pb.SEARCH_PACK_ID,trigger:this._triggeredWord},wd);this._setStickerTrigger(null);}else wd();this._stickersFlyoutShown=true;},_onFlyoutHidden:function(){this._stickersFlyoutShown=false;this.focus();if(ob.WebStickerTrigger)this._chatInput.setProps({triggeredWord:null});},_onTriggerChanged:function(wd){this._triggeredWord=wd;this._chatInput.setProps({triggeredWord:wd});}});function vd(wd){var xd=rc.updateMessageAfterUpload(wd.upload_id,wd);rc.clearUploadedMessage(wd.upload_id);rc.deleteMessages(xd.thread_id,[xd.message_id]);rc.deleteLocalMessage(xd.thread_id);}e.exports=sd;},null);
__d("ChatNewMessageHandler",["ArbiterMixin","ChatActivity","ChatMentionsNotifications","ChatTabModel","ChatTabView","JSLogger","MercuryAssert","MercuryBrowserAlerts","UserActivity","MercuryConfig","copyProperties"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){var r=l.create('chat_new_message'),s={_raiseNewMessageTab:function(t,u){var v=j.getTab(t),w=false;if(v){w=v.raised;}else w=true;s.inform('chat/new-message-from-server',{thread_id:t});u.to_new_tab=!v;u.to_raised_tab=!!w;},_notify:function(t,u,v){if(p.DesktopNotificationsGK)i.notifyIfMessageToMe(u);var w=k.get(t);v.view_is_visible=w&&w.isVisible();v.view_is_focused=w&&w.isFocused();if(!v.view_is_visible)r.log('message_to_hidden');v.is_active=h.isActive();n.messageReceived(u);},newMessage:function(t,u,v){m.isThreadID(t);var w={thread_id:t,message_id:u.message_id};this._raiseNewMessageTab(t,w);this._notify(t,u,w);r.log('message',w);}};q(s,g);n.subscribe('before-alert',function(t,event){var u=event.threadID,v=k.get(u),w=j.getTab(u);if(w&&w.raised&&v&&v.isVisible()&&v.isFocused()&&o.isActive()){v.tryMarkAsRead();event.cancelAlert();}});e.exports=s;},null);
__d("ChatTabLRUManager",["ChatTabView","ChatTabModel","MercuryThreads"],function(a,b,c,d,e,f,g,h){var i=b('MercuryThreads').get(),j={getLRUVisibleTab:function(k){if(k.hasRoomForRaisedTab())return undefined;var l=Object.keys(k.getTabsToShow()||{}),m=1*60,n=null,o=Infinity;for(var p=0;p<l.length;p++){var q=l[p],r=i.getThreadMetaNow(q);if(h.isTabPromoted(q))continue;if(!g.get(q).hasEmptyInput()||!r)continue;var s=(h.getServerTime()-r.timestamp)/1000;if(!r.timestamp||(r.timestamp&&r.timestamp<o&&s>m)){n=r.thread_id;o=r.timestamp;}}return n;}};e.exports=j;},null);
__d("ChatTabPolicy",["ChatBehavior","JSLogger","MercuryActionTypeConstants","MercuryLogMessageType","MercuryAssert","MercuryParticipants","MercuryParticipantTypes","MercurySourceType","MercuryThreadMode","MercuryThreadMuter","MessagingTag","PresencePrivacy","ShortProfiles","MercuryUnseenState"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){var t=b('MercuryUnseenState').get(),u=h.create('tab_policy');function v(w,x){t.markThreadSeen(w,x);}e.exports={messageIsAllowed:function(w,x,y){var z=w.thread_id,aa=x.message_id;k.isThreadID(z);k.isParticipantID(x.author);var ba;if(p.isThreadMuted(w)){ba={thread_id:z,message_id:aa,mute_settings:w.mute_settings};u.log('message_thread_muted',ba);return;}if(w.mode==o.OBJECT_ORIGINATED){ba={thread_id:z,message_id:aa,mode:w.mode};u.log('message_object_originated',ba);return;}if(x.source==n.EMAIL||x.source==n.TITAN_EMAIL_REPLY){ba={thread_id:z,message_id:aa,source:x.source};u.log('message_source_not_allowed',ba);return;}var ca=l.getUserID(x.author);if(!ca){u.log('message_bad_author',{thread_id:z,message_id:aa,user:ca});return;}if(x.action_type!=i.USER_GENERATED_MESSAGE&&!this._messageIsNewlyCreatedGroup(x,w)){ba={thread_id:z,message_id:aa,type:x.action_type};u.log('message_non_user_generated',ba);return;}if(w.is_canonical_user&&!g.notifiesUserMessages()){u.log('message_jabber',{thread_id:z,message_id:aa});v(z,true);return;}if(w.is_canonical&&!w.canonical_fbid){u.log('message_canonical_contact',{thread_id:z,message_id:aa});return;}if(w.folder!=q.INBOX){u.log('message_folder',{thread_id:z,message_id:aa,folder:w.folder});return;}var da=l.getUserID(l.user);s.getMulti([ca,da],function(ea){if(!r.allows(ca)){u.log('message_privacy',{thread_id:z,message_id:aa,user:ca});return;}var fa=ea[ca].employee&&ea[da].employee;if(!fa&&ea[ca].type!==m.FRIEND){u.log('message_non_friend',{thread_id:z,message_id:aa,user:ca});return;}y();});},_messageIsNewlyCreatedGroup:function(w,x){return w.action_type===i.LOG_MESSAGE&&w.log_message_type===j.THREAD_NAME&&x.message_count===1;}};},null);
__d("ChatTabViewSelector",["Event","Arbiter","CSS","DataStore","DOM","MenuDeprecated","NubController","ChatTabTemplates","Toggler","copyProperties","MercuryThreadInformer","MercuryThreads","MercuryThreadMetadataRenderer"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){var q=b('MercuryThreadInformer').get(),r=b('MercuryThreads').get(),s=b('MercuryThreadMetadataRenderer').get();function t(u){var v=n[':fb:chat:tab:selector'].build(),w=v.getRoot(),x=v.getNode('menu'),y=k.find(x,'.uiMenuInner'),z={},aa=new m().init(w);i.hide(w);k.insertBefore(u,w);function ba(ea){var fa=0;for(var ga in z){var ha=z[ga],ia=r.getThreadMetaNow(ga),ja=ha.getNode('unreadCount'),ka=(ia&&ia.unread_count)||0;fa+=ka;if(ka>9)ka='+';i.conditionClass(ja,'invisible_elem',!ka);k.setContent(ja,ka);}var la=v.getNode('numMessages');i.conditionShow(la,fa);k.setContent(la,fa);}this.setTabData=function(ea){z={};if(ea.length<1){i.hide(w);return;}i.show(w);k.empty(y);ea.forEach(function(fa){var ga=n[':fb:chat:tab:selector:item'].build();z[fa.id]=ga;var ha=ga.getNode('content');s.renderAndSeparatedParticipantList(fa.id,ha);k.prependContent(y,ga.getRoot());j.set(ga.getRoot(),'threadID',fa.id);var ia=ga.getNode('closeButton');g.listen(ia,'click',function(event){t.inform('selector/close-tab',fa.id);event.kill();});});aa.flyoutContentChanged();k.setContent(v.getNode('numTabs'),ea.length);ba();};function ca(event,ea){if(ea.menu!=x)return;var fa=j.get(ea.item,'threadID');t.inform('selected',fa);o.hide(w);}function da(event,ea){l.register(x);}l.subscribe('select',ca.bind(this));o.listen('show',w,function(){h.inform('layer_shown',{type:'ChatTabSelector'});da();});o.listen('hide',w,function(){h.inform('layer_hidden',{type:'ChatTabSelector'});});q.subscribe('threads-updated',ba);}p(t,new h());e.exports=t;},null);
__d("ChatTabController",["Arbiter","ChatActivity","ChatConfig","ChatNewMessageHandler","ChatTabLRUManager","ChatTabMessagesView","ChatTabModel","ChatTabPolicy","ChatTabView","ChatTabViewSelector","JSLogger","MercuryConfig","MercuryParticipants","StickerState","Style","UserAgent_DEPRECATED","VideoCallCore","ChatTabPresence","ChatTypeaheadBehavior","MercuryThreadInformer","MercuryThreads","MercuryUnseenState"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w){b('ChatTabPresence');b('ChatTypeaheadBehavior');var x=b('MercuryThreadInformer').get(),y=b('MercuryThreads').get(),z=b('MercuryUnseenState').get(),aa=i.get('tab_auto_close_timeout')||7200000,ba=q.create('tab_controller');function ca(qa){y.changeThreadReadStatus(qa,true);da(qa);}function da(qa){z.markThreadSeen(qa);}function ea(qa,ra,sa){var ta=m.get().tabs;qa+=ra?1:-1;while(qa>=0&&qa<ta.length){var ua=ta[qa],va=o.get(ua.id);if(va&&va.isVisible()&&(!sa||ua.raised)){va.focus();return true;}qa+=ra?1:-1;}return false;}function fa(qa,ra){var sa=ra&&ra.getRightmostHiddenTab();if(sa===qa)return null;return sa;}function ga(){return Math.floor(Math.random()*2147483648).toString(16);}function ha(qa,ra,sa,ta){m.raiseTab(qa,true,sa);var ua=ra&&ra.getLeftmostVisibleTab(),va=ra&&ra.getTabsToShow();if(va&&!va[qa]&&ua){m.promoteThreadInPlaceOfThread(qa,ua,fa(qa,ra),true);}else m.setPromotedTab(qa);g.inform('chat/open-tab',qa);var wa=o.get(qa);wa&&wa.focus();}function ia(qa,ra,sa){var ta=sa.forceDrop();if(!m.getTab(qa))m.raiseTab(qa,false);if(ta)return;var ua=ra&&k.getLRUVisibleTab(ra),va=ra&&ra.getTabsToShow();if(va&&!va[qa]&&ua)m.promoteThreadInPlaceOfThread(qa,ua,fa(qa,ra));}function ja(qa,ra){var sa=m.indexOf(qa);m.closeTab(qa,ra);return sa;}function ka(qa,ra){j.subscribe('chat/new-message-from-server',function(ab,bb){ia(bb.thread_id,qa,ra);});p.subscribe('selected',function(ab,bb){ha(bb,qa);});g.subscribe('chat/tabs-order-changed',function(ab,bb){m.changeShowingTabs(bb);});g.subscribe('page_transition',function(ab,bb){m.closeFragileTabs();});g.subscribe('chat/close-all-tabs',function(){m.closeAllTabs();});g.subscribe('chat-visibility/go-offline',function(){m.closeAllTabs();});o.subscribe('read',function(event,ab){ca(ab);});h.subscribe('idle',function(ab,bb){if(bb>aa){var cb=m.get().tabs;cb.forEach(function(db){var eb=db.id;y.getThreadMeta(eb,function(fb){if(!fb.unread_count){ba.log('autoclose_idle_seen',{thread_id:eb,idleness:bb});m.closeTab(eb,'autoclose_idle_seen');}});});}});o.subscribe('nub-activated',function(ab,bb){ha(bb,qa);});o.subscribe('lower-activated',function(ab,bb){m.lowerTab(bb);var cb=o.get(bb);cb&&cb.focus();});o.subscribe('focus-tab',function(ab,bb){var cb=m.getTab(bb);if(cb&&cb.raised)ha(bb,qa,cb.signatureID,true);});function sa(ab,bb){w.showOutgoingCallDialog(bb.userID,bb.clickSource);m.lowerTab(bb.threadID);}o.subscribe('video-call-clicked',sa);l.subscribe('video-call-clicked',sa);l.subscribe('interaction-with-tab',function(ab,bb){var cb=m.getTab(bb);cb&&cb.raised&&da(bb);});o.subscribe('closed-tab',function(ab,bb){ba.log('close_view',{thread_id:bb});ja(bb,'close_view');return false;});o.subscribe('thread-deleted',function(ab,bb){ba.log('close_thread_deleted',{thread_id:bb});ja(bb,'close_thread_deleted');return false;});o.subscribe('unsubscribed',function(ab,bb){ba.log('close_view_unsubscribed',{thread_id:bb});ja(bb,'close_view_unsubscribed');return false;});o.subscribe('esc-pressed',function(ab,bb){ba.log('close_esc',{thread_id:bb});var cb=ja(bb,'close_esc');setTimeout(function(){ea(cb-1,true,true)||ea(cb,false,true);},0);});p.subscribe('selector/close-tab',function(ab,bb){ba.log('close_chat_from_selector',{thread_id:bb});ja(bb,'close_chat_from_selector');});x.subscribe('messages-received',function(ab,bb){for(var cb in bb){var db=bb[cb];for(var eb=0;eb<db.length;eb++){var fb=db[eb];if(fb.author!=s.user){if(!fb.is_unread){ba.log('message_already_read',{action_id:fb.action_id,thread_id:fb.thread_id});continue;}y.getThreadMeta(cb,function(gb){n.messageIsAllowed(gb,fb,function(){j.newMessage(cb,fb,qa);});});}}}});x.subscribe('thread-read-changed',function(ab,bb){for(var cb in bb)if(!bb[cb].mark_as_read){ba.log('autoclose_marked_unread',{thread_id:cb});m.closeTab(cb,'autoclose_marked_unread');}});o.subscribe('tab-pressed',function(ab,bb){return !ea(m.indexOf(bb.id),bb.shiftPressed);});g.subscribe(q.DUMP_EVENT,function(ab,bb){bb.chat_controller={auto_close_timeout:aa};});this.openTab=function(ab,bb){ha(ab,bb,ga());};var ta,ua,va=[],wa=[],xa=[],ya;if(t.shouldShowStickerSearchNUXTooltip()){ta=qa.getRightmostRaisedTab();if(ta){ya=o.get(ta);ya.showStickerSearchNUXTooltip();}else g.subscribeOnce('chat/open-tab',function(ab,bb){ya=o.get(bb);ya.showStickerSearchNUXTooltip();});}else if(r.ShowOrionNUXTooltip){va=qa.getRaisedVisibleTabs();for(var za=0;za<va.length;za++){ua=o.get(va[za]);if(ua.isOrionNUXEligible())wa.push(ua);}if(wa.length){xa=wa.map(function(ab){return ab.getParticipantIDForOrionNUX();});s.getMulti(xa,function(ab){for(var bb in ab)if(ab[bb].orion_eligible){ya=wa.filter(function(cb){return cb._getCanonicalUserID()===s.getUserID(ab[bb].id);})[0];break;}if(ya)ya.showOrionNUXTooltip();});}}}if(v.firefox()){var la=function(){return u.get(document.body,'overflowX')+' '+u.get(document.body,'overflowY');},ma=la(),na=function(){var qa=la();if(qa!==ma){ma=qa;g.inform('overflow-applied-to-body');}};if('MutationObserver' in window){var oa=new MutationObserver(na),pa={attributes:true,attributeFilter:['class','style']};oa.observe(document.documentElement,pa);}else document.documentElement.addEventListener('DOMAttrModified',function(event){if(event.getTarget()===document.documentElement&&(event.attrName==='class'||event.attrName==='style'))na();},false);}e.exports=ka;},null);
__d("ChatTabViewCoordinator",["Arbiter","BanzaiODS","Bootloader","ChatTabModel","ChatTabView","ChatTabViewSelector","CSS","JSLogger","Style","Rect","VideoCallSupport","copyProperties"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){var s=n.create('chat_tab_coordinator'),t,u;function v(w,x){var y=new l(w),z={},aa={},ba=false;function ca(){var oa=j.get(),pa={};oa.tabs.forEach(function(ra){pa[ra.id]=1;});s.log('process_tab_changed',{model_tabs:Object.keys(pa),view_tabs:Object.keys(z)});for(var qa in z)if(!pa[qa]){s.log('remove_tab',{tab_id:qa});z[qa].destroy();delete(z[qa]);}da(oa);ma(oa);if(oa.tabNeedsFocus&&!oa.tabNeedsFocus.isFocused())oa.tabNeedsFocus.focus();}function da(oa){var pa=null;oa.tabs.forEach(function(qa){var ra=qa.id,sa=false;if(!z[ra]){s.log('add_tab',{tab_id:ra});z[ra]=new k(ra,qa.server_id,qa.signatureID);sa=true;}else z[ra].updateSignatureID(qa.signatureID);if(z[ra].isFocused())oa.tabNeedsFocus=z[ra];if(sa||!z[ra].nextTabIs(pa)){var ta=z[ra].getScrollTop();if(pa){z[ra].insertBefore(pa);}else z[ra].appendTo(w);if(ta)z[ra].setScrollTop(ta);}pa=z[ra];});}function ea(){var oa=x.getShowingTabsOrder();if(!oa||!oa.length)return;var pa=z[oa[0].id]._tabElem,qa=z[oa[oa.length-1].id]._tabElem,ra=parseInt(o.get(qa,'margin-left'),10)||0,sa=p.getElementBounds(qa).l-2*ra;sa=sa>0?sa:0;t&&t.setBoundingBox(new p(0,p.getElementBounds(pa).r,0,sa));}function fa(oa,pa){var qa=false;pa.forEach(function(ta){if(ta.raised){if(aa[ta.id]){qa=true;delete aa[ta.id];}}else if(!aa[ta.id]){qa=true;aa[ta.id]=true;}});if(qa)return true;if(!t)return true;var ra=ga()||[];if(ra.length!==oa.length)return true;for(var sa=0;sa<oa.length;sa++)if(ra[sa]!==oa[sa].id)return true;return false;}function ga(){var oa=t&&t.getOrder();oa&&oa.reverse();return oa;}function ha(){var oa=ga();if(oa){h.bumpEntityKey('chat.web','tab.drag_order_changed');g.inform('chat/tabs-order-changed',oa);}}function ia(oa,pa,qa){if(z[qa]._scrollTop!=null)z[qa].setScrollTop(z[qa]._scrollTop);}function ja(oa,pa){u=pa;z[pa]._isDragDropActive=true;z[pa]._scrollTop=z[pa].getScrollTop();o.set(z[pa]._tabElem,'z-index',1);ea();h.bumpEntityKey('chat.web','tab.drag_started');}function ka(oa){o.set(z[oa]._tabElem,'z-index','');if(z[oa]._scrollTop!=null)z[oa].setScrollTop(z[oa]._scrollTop);z[oa]._scrollTop=null;u=null;setTimeout(function(){z[oa]._isDragDropActive=false;},0);}function la(oa){i.loadModules(["SortableGroup"],function(pa){var qa=x.getShowingTabsOrder(),ra=fa(qa,oa);if(qa.length<=1){t&&t.removeAllSortables();return;}if(ra){if(t){t.removeAllSortables();}else t=new pa().setBeforeGrabCallback(ja).setDragOverCallback(ia).setDropCallback(ka).setOrderChangeHandler(ha).setUseScroller(false).setDragOverHorizontally();for(var sa=0;sa<qa.length;sa++){var ta=qa[sa];t.addSortable(ta.id,z[ta.id]._tabElem,aa[ta.id]?null:z[ta.id]._titlebar);}}});}function ma(oa){var pa=x.getTabsToShow(oa),qa=[],ra=false;oa.tabs.forEach(function(sa){if(!pa[sa.id]){z[sa.id].setVisibleState(false,sa.raised);qa.push(sa);}});oa.tabs.forEach(function(sa){if(pa[sa.id]){z[sa.id].setVisibleState(true,sa.raised);ra|=sa.raised;}});y.setTabData(qa);na(ra);la(oa.tabs);}function na(oa){if(!oa&&ba){g.inform('layer_hidden',{type:'ChatTab'});ba=false;}else if(oa&&!ba){g.inform('layer_shown',{type:'ChatTab'});ba=true;}}if(q.isVideoCallSupported())m.addClass(w,'videoCallEnabled');x.subscribe('tabs-changed',ca);ca();}r(v.prototype,{forceDrop:function(){if(t&&u){t.forceDrop(u);u=null;return true;}return false;}});e.exports=v;},null);
__d("ChatApp",["CSS","JSLogger"],function(a,b,c,d,e,f,g,h){var i={init:function(j,k,l){if(this._isInitialized){h.create('chat_app').error('repeated_init');return;}this._rootElem=j;d(['TabsViewport','ChatTabController','ChatTabViewCoordinator','MercuryServerRequests','MercuryChannelHandler','MercuryStateCheck'],function(m,n,o,p,q,r){q=q.get();q.turnOn();p.get().handleUpdate(l);this.tabsViewport=new m(k);this.tabViewCoordinator=new o(k,this.tabsViewport);this.tabController=new n(this.tabsViewport,this.tabViewCoordinator);this._isInitialized=this._isLoaded=true;}.bind(this));},isInitialized:function(){return !!this._isInitialized;},isHidden:function(){return !this._isInitialized||this._isHidden;},hide:function(){if(this.isHidden())return;g.hide(this._rootElem);this._isHidden=true;},unhide:function(){if(this._isInitialized){if(this._isHidden){g.show(this._rootElem);this.tabsViewport.checkWidth();d(['Dock'],function(j){j.resizeAllFlyouts();});this._isHidden=false;}}else if(!this._isLoaded){d(['UIPagelet'],function(j){j.loadFromEndpoint('ChatTabsPagelet','ChatTabsPagelet');j.loadFromEndpoint('BuddylistPagelet','BuddylistPagelet');});this._isLoaded=true;}}};e.exports=i;},null);